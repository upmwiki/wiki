---
prev:
    text: § 15. Определение опорного плана транспортной задачи
    link: ../15/
next:
    text: § 17. Задачи транспортного типа
    link: ../17/
---

**Тема 2. Транспортная задача**

# § 16. Метод потенциалов решения транспортной задачи

Транспортную задачу в исходной её постановке неудобно решать симплекс-методом, поэтому перейдём к двойственным переменным $u_i$ и $v_j$, $i = \overline{1,m}$, $j = \overline{1,n}$, которые будем называть **потенциалами**. Тогда двойственная задача примет вид

$$
\sum_{i=1}^m a_i u_i + \sum_{j=1}^n b_j v_j \to \max
$$

при ограничениях

$$
u_i + v_j \le c_{ij} ~ ~ ~ ~ \forall i,j.
$$

Справедлива следующая теорема.

::: info Теорема
Если план транспортной задачи $X^* = (x^*_{ij})_{m \times n}$ оптимален, то ему соответствует система из $m + n$ потенциалов, удовлетворяющих условиям

$$
u_i + v_j = c_{ij} ~ \style{font-family:Times}{\text{для}}\!\!\! ~ x^*_{ij} > 0 ~ ~ ~ ~ ~ ~ \style{font-family:Times}{\text{и}} ~ ~ ~ ~ ~ u_i + v_j \le c_{ij} ~ \style{font-family:Times}{\text{для}}\!\!\! ~ x^*_{ij} = 0.
$$
:::

По-другому условие теоремы можно записать так: пусть существует матрица $\Delta_{ij} = u_i + v_j - c_{ij}$, $i = \overline{1,m}$, $j = \overline{1,n}$. Тогда для оптимальности плана $X^*$ необходимо и достаточно, чтобы в матрице $\Delta_{ij}$ не было положительных элементов. Если же в матрице найдётся хоть один положительный элемент, то план является неоптимальным, и его следует улучшить, переведя соответствующие переменные в базисные (придав ей положитльное значение).

> Здесь и далее будем называть элементы матрицы клетками.

Если соответствующая перевозка существует, будем называть клетку **занятой** (в противном случае **свободной**).

В результате метод потенциалов сводится к следующему: для всех занятых $m + n - 1$ клеток составляем уравнение

$$
u_i + v_j = c_{ij}.
$$

Таких уравнений $m + n$, поэтому один из потенциалов определяем произвольно (обычно кладут $u_1 = 0$). Решаем данную систему, определяем потенциалы.

Далее для всех свободных клеток вычисляем разности $\Delta_{ij} = u_i + v_j - c_{ij}$. Если среди них нет положительных значений, то найденный опорный план оптимален. В противном случае выбираем клетку с наибольшим $\Delta_{ij}$. Эту клетку следует загрузить, т. е. сделать занятой. Начиная из данной клетки, строим по занятым клеткам цикл.

::: info Определение
**Циклом** называется последовательность клеток, в которой две и только две соседние клетки расположены в одном столбце или одной строке, причём последняя клетка находится в той же строке или столбце, что и первая.

*(Можно доказать, что цикл всегда единственен.)*
:::

Помечаем начальную клетку цикла плюсом, а остальные — поочерёдно минусами и плюсами.

Предполагается, что в клетках с плюсами перевозка будет увеличена, а в клетках с минусами — уменьшена на одно и то же число. В качестве этого числа берётся минимальная перевозка из клеток с минусами. Данная клетка будет переведена в свободные.

::: info Замечание
Если клеток с минимальной перевозкой несколько, то одна из них переводится в свободные, а остальные остаются занятыми со значимыми нулями.
:::

Далее переходим к следующему шагу алгоритма.

Таким образом, оптимальное решение будет получено за конечное число шагов.

Примеры циклов:

[image]

## Пример

...