---
prev:
    text: § 8. Свойства ЗЛП и её оптимального решения
    link: ../08/
next:
    text: § 10. Особые случаи решения симплекс-методом
    link: ../10/
---

# § 9. Симплексный метод решения ЗЛП

В предыдущих параграфах было показано, что оптимальное решение ЗЛП достигается в одной или нескольких угловых точках многогранника решений, которым соответствуют допустимые базисные решения системы линейных уравнений. Таким образом, требуется разработать алгоритм перебора этих решений, при котором оптимальное решение достигалось за минимальное число шагов.

Предполагается, что за один шаг алгоритма совершается переход от текущей вершины к соседней, при котором целевая функция улучшает (или не ухудшает) своё значение.

В рамках этой схемы необходимо определить следующие действия:

1. способ определения какого-либо первоначального допустимого базисного решения;
2. правила перехода к лучшему (не худшему) решению;
3. критерий проверки оптимальности найденного решения.

Рассмотрим возможные варианты выполнения этих условий. Пусть ЗЛП задана в канонической форме:

$$
\begin{cases}
f = CX \to \max \\
AX \le B, & B \ge 0 \\
X \ge 0
\end{cases}
$$

Пункт 1 может быть выполнен следующим образом: необходимо найти в каждом уравнении СЛАУ некоторую переменную, которая входит в это и только в это уравнение, с положительным коэффициентом. Тогда указанные переменные принимаются за базисные, а соответствующие базисные решения — за начальные допустимые базисные решения.

Целевая функция с помощью подстановки базисных выражается через свободные переменные и принимает начальные значения.

Далее, согласно пункту 3, мы должны определить, является ли это решение оптимальным или нет. Чтобы это понять, надо проверить знаки коэффициентов целевой функции. Очевидно, что если все коэффициенты при свободных переменных отрицательны, то целевую функцию улучшить нельзя, и оптимальное решение найдено. В противном случае переходим к пункту 2.

Находим наибольший положительный коэффициент целевой функции и переводим данную переменную в базисные. Этим достигается максимальный рост целевой функции на каждом шаге, а значит, минимизируется число шагов.

Следующим действием необходимо выбрать, какую из базисных переменных перевести в свободную. Это оценивается из системы неравенств, следующих из знакоопределённости $X$ ($X \ge 0$). В результате осуществляется переход к новому допустимому базисному решению, при котором базисные переменные и целевая функция выражаются через новый набор свободных.

::: info Пример
*Задание.* Решить задачу

$$
\begin{cases}
f = 2x_1 + 3x_2 \to \max \\
x_1 + 3x_2 \le 18 \\
2x_1 + x_2 \le 16 \\
x_2 \le 5 \\
x_1 \le 7 \\
x_1 \ge 0, ~ x_2 \ge 0
\end{cases}
$$

> Эта задача может быть решена геометрически <small><i>(сделать самостоятельно)</i></small>.

*Решение.* Данная задача задана в стандартной форме, перейдём к канонической. Введём дополнительные переменные. Получим:

$$
\begin{cases}
f = 2x_1 + 3x_2 \to \max \\
x_1 + 3x_2 + x_3 = 18 \\
2x_1 + x_2 + x_4 = 16 \\
x_2 + x_5 = 5 \\
x_1 + x_6 = 7 \\
x_j \ge 0, ~ ~ j = \overline{1,6}
\end{cases}
$$

**Замечание.** В случае когда производится переход от стандартной формы к канонической, базисные переменные определяются сразу — это дополнительные переменные.

$$
\begin{cases}
f = 2x_1 + 3x_2 \to \max \\
x_3 = 18 - x_1 - 3x_2 \\
x_4 = 16 - 2x_1 - x_2 \\
x_5 = 5 - x_2 & (∗∗) \\
x_6 = 7 - x_1 \\
x_j \ge 0
\end{cases}
$$

Таким образом, начальное допустимое базисное решение получено:

$$
\bar{x}^{(0)} = (0, 0, 18, 16, 5, 7), ~ ~ ~ ~ f^{(0)} = 0.
$$

**Шаг 1.** Переводим $x_2$ в базисные, $x_1 = 0$, тогда

$$
\begin{cases}
18 - 3x_2 \ge 0 \\
16 - x_2 \ge 0 \\
5 - x_2 \ge 0 \\
7 \ge 0
\end{cases} \implies
\begin{cases}
x_2 \le 6 \\
x_2 \le 16 \\
x_2 \le 5
\end{cases}
$$

Выберем, что $x_2 = \min\set{6; 16; 5} = 5$. *(Данные значения внутри $\min$ называются "оценочными отношениями".)*

Это достигается на $(∗∗)$, следовательно, $x_5$ — свободная. Из $(∗∗)$ также выражаем $x_2$:

$$
x_2 = 5 - x_5
$$

и подставляем во все остальные уравнения:

$$
\begin{array}{l}
x_3 = 18 - x_1 - 3 \cdot (5 - x_5) = 3 - x_1 + 3x_5 & (∗∗∗) \\
x_4 = 16 - 2x_1 - (5 - x_5) = 11 - 2x_1 + x_5 \\
x_6 = 7 - x_1 \\
f = 2x_1 + 3 \cdot (5 - x_5) = 15 + 2x_1 - 3x_5
\end{array}
$$

Тогда

$$
\bar{x}^{(1)} = (0, 5, 3, 11, 0, 7), ~ ~ ~ ~ f^{(1)} = 15.
$$

В целевой функции $f = 15 + 2x_1 - 3x_5$ есть положительные коэффициенты, следовательно, есть более оптимальное решение.

**Шаг 2.** Переведём $x_1$ в базисные.

$$
\begin{cases}
5 \ge 0 \\
3 - x_1 \ge 0 \\
11 - 2x_1 \ge 0 \\
7 - x_1 \ge 0
\end{cases} \implies
\begin{cases}
x_1 \le 3 \\
x_1 \le {11 \over 2} \\
x_1 \le 7
\end{cases}
$$

Отсюда получим $x_1 = \min\set{3; {11 \over 2}; 7} = 3$. Это получили из $(∗∗∗)$, следовательно, $x_3$ переводим в свбодные.

$$
\begin{array}{l}
x_1 = 3 - x_3 + 3x_5 \\
x_2 = 5 - x_5 \\
x_4 = 11 - 2 \cdot (3 - x_3 + 3x_5) + x_5 = 5 + 2x_3 - 5x_5 & (∗∗∗∗) \\
x_6 = 7 - (3 - x_3 + 3x_5) = 4 + x_3 - 3x_5 \\
f = 15 + 2 \cdot (3 - x_3 + 3x_5) - 3x_5 = 21 - 2x_3 + 3x_5
\end{array}
$$

Таким образом, после второго шага получаем

$$
\bar{x}^{(2)} = (3, 5, 0, 5, 0, 4), ~ ~ ~ ~ f^{(2)} = 21.
$$

В целевой функции есть положительный коэффициент (при $x_5$), следовательно, решение не оптимальное.

**Шаг 3.** Переведём $x_5$ в базис.

$$
\begin{cases}
3 + 3x_5 \ge 0 \\
5 - x_5 \ge 0 \\
5 - 5x_5 \ge 0 \\
4 - 3x_5 \ge 0
\end{cases} \implies
\begin{cases}
x_5 \le 5 \\
x_5 \le 1 \\
x_5 \le {4 \over 3}
\end{cases}
$$

Отсюда следует $x_5 = \min\set{5; 1; {4 \over 3}} = 1$. Это соответствует $(∗∗∗∗)$, значит, $x_4$ переходит в свободные.

$$
\begin{array}{l}
x_5 = 1 - {1 \over 5} x_4 + {2 \over 5} x_3 \\
x_1 = 3 - x_3 + 3 \cdot (1 - {1 \over 5} x_4 + {2 \over 5} x_3) = 6 + {1 \over 5} x_3 - {3 \over 5} x_4 \\
x_2 = 5 - (1 - {1 \over 5} x_4 + {2 \over 5} x_3) = 4 - {2 \over 5} x_3 + {1 \over 5} x_4 \\
x_6 = 4 + x_3 - 3 \cdot (1 - {1 \over 5} x_4 + {2 \over 5} x_3) = 1 - {1 \over 5} x_3 + {3 \over 5} x_4 \\
f = 21 - 2x_3 + 3 \cdot (1 - {1 \over 5} x_4 + {2 \over 5} x_3) = 24 - {4 \over 5} x_3 - {3 \over 5} x_4
\end{array}
$$

Получаем, что

$$
\bar{x}^{(3)} = (6, 4, 0, 0, 1, 1), ~ ~ ~ ~ f^{(3)} = 24.
$$

Оптимальное решение найдено, так как все коэффициенты целевой функции отрицательны.

**Ответ:** $f_\max = f(6, 4) = 24$.
:::