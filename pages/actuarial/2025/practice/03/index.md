---
prev:
    text: 2. Структура страховой премии и основные подходы к её расчёту в страховании, отличном от страхования жизни
    link: ../02/
next: false
---

# 3. Моделирование числа убытков и величины ущерба в страховании не-жизни

<p class="subtext">Практическое занятие</p>

## Задача 1

Портфель состоит из 3-ёх независимых однотипных договоров страхования неких крупных объектов, учитывающих:

* гибель всего объекта, возможную с вероятностью 0.05, при которой выплаты составляют 2 млн у. е.;
* разрушение главного агрегата объекта с вероятностью 0.1, при которой выплаты составляют 1 млн у. е.

Требуется найти:

* точное распределение суммарного ущерба по портфелю, используя метод свёрток;
* размер рисковой премии, собираемой по такому портфелю и обеспечиваемую собранной суммой вероятность неразорения страховой компании;
* суммарную рисковую надбавку, необходимую чтобы достичь вероятность неразорения 0.95.

::: details Решение
1. Есть три независимых однотипных договора $X_1$, $X_2$, $X_3$. Требуется найти распределение $X_1 + X_2 + X_3$.

   Запишем для данных случайных величин закон распределения, используя данные из условия.

   $$
   \mathbb{P}(X_i = 1) = 0,1;
   ~~~~
   \mathbb{P}(X_i = 2) = 0,05;
   $$

   $$
   \mathbb{P}(X_i = 0) = 1 - 0,1 - 0,5 = 0,85.
   $$

   Тогда закон распределения для случайных величин $X_1$, $X_2$, $X_3$ имеет вид:

   | $X_i$ | $0$ | $1$ | $2$ |
   |-|-|-|-|
   | $p_i$ | $0,85$ | $0,1$ | $0,05$ |

   Рассмотрим случайную величину $Y = X_1 + X_2$. Её возможные значения — это всевозможные значения суммы $X_1 + X_2$:

   | $Y$ | $X_1 + X_2$ |
   |-|-|
   | $0$ | $0 + 0$ |
   | $1$ | $0 + 1$ или $1 + 0$ |
   | $2$ | $0 + 2$ или $2 + 0$ или $1 + 1$ |
   | $3$ | $1 + 2$ или $2 + 1$ |
   | $4$ | $2 + 2$ |
   
   Составим для неё закон распределения.

   $$
   \mathbb{P}(Y = 0)
   = \mathbb{P}(X_1 = 0) \cdot \mathbb{P}(X_2 = 0)
   = 0,85 \cdot 0,85 = 0,7225;
   $$

   $$
   \mathbb{P}(Y = 1)
   = \mathbb{P}(X_1 = 0) \cdot \mathbb{P}(X_2 = 1) + \mathbb{P}(X_1 = 1) \cdot \mathbb{P}(X_2 = 0) =
   $$

   $$
   = 0,85 \cdot 0,1 + 0,1 \cdot 0,85 = 0,17;
   $$

   $$
   ~ \mathbb{P}(Y = 2)
   = \mathbb{P}(X_1 = 0) \cdot \mathbb{P}(X_2 = 2) + \mathbb{P}(X_1 = 2) \cdot \mathbb{P}(X_2 = 0) + ~
   $$

   $$
   ~ + \mathbb{P}(X_1 = 1) \cdot \mathbb{P}(X_2 = 2)
   = 0,05 \cdot 0,85 + 0,85 \cdot 0,05 + 0,1 \cdot 0,1
   = 0,095; ~
   $$

   $$
   \mathbb{P}(Y = 3)
   = \mathbb{P}(X_1 = 1) \cdot \mathbb{P}(X_2 = 2) + \mathbb{P}(X_1 = 2) \cdot \mathbb{P}(X_2 = 1) =
   $$

   $$
   = 0,1 \cdot 0,05 + 0,05 \cdot 0,1 = 0,01;
   $$

   $$
   \mathbb{P}(Y = 4)
   = \mathbb{P}(X_1 = 2) \cdot \mathbb{P}(X_2 = 2)
   = 0,05 \cdot 0,05 = 0,0025.
   $$

   Тогда закон распределения для $Y$ имеет вид:

   | $Y$ | $0$ | $1$ | $2$ | $3$ | $4$ |
   |-|-|-|-|-|-|
   | $p_i$ | $0,7225$ | $0,17$ | $0,095$ | $0,01$ | $0,0025$ |

   > *Можно проверить корректность полученных значений вероятностей: в сумме они должны давать $1$.*

   Рассмотрим случайную величину $Z = X_1 + X_2 + X_3 = Y + X_3$. Её возможные значения — это всевозможные значения суммы $Y + X_3$:

   | $Z$ | $Y + X_3$ |
   |-|-|
   | $0$ | $0 + 0$ |
   | $1$ | $0 + 1$ или $1 + 0$ |
   | $2$ | $0 + 2$ или $2 + 0$ или $1 + 1$ |
   | $3$ | $3 + 0$ или $2 + 1$ или $1 + 2$ |
   | $4$ | $4 + 0$ или $3 + 1$ или $2 + 2$ |
   | $5$ | $4 + 1$ или $3 + 2$ |
   | $6$ | $4 + 2$ |

   Составим для неё закон распределения:

   $$
   \mathbb{P}(Z = 0)
   = \mathbb{P}(Y = 0) \cdot \mathbb{P}(X_3 = 0)
   = 0,7225 \cdot 0,85
   = 0,614125;
   $$

   $$
   \mathbb{P}(Z = 1)
   = \mathbb{P}(Y = 0) \cdot \mathbb{P}(X_3 = 1) + \mathbb{P}(Y = 1) \cdot \mathbb{P}(X_3 = 0) =
   $$

   $$
   = 0,7225 \cdot 0,1 + 0,17 \cdot 0,85
   = 0,21675;
   $$

   $$
   ~ \mathbb{P}(Z = 2)
   = \mathbb{P}(Y = 0) \cdot \mathbb{P}(X_3 = 2) + \mathbb{P}(Y = 2) \cdot \mathbb{P}(X_3 = 0) + ~
   $$

   $$
   ~ + \mathbb{P}(Y = 1) \cdot \mathbb{P}(X_3 = 1)
   = 0,7225 \cdot 0,05 + 0,095 \cdot 0,85 + 0,17 \cdot 0,1 = ~
   $$

   $$
   = 0,133875;
   $$

   $$
   ~ \mathbb{P}(Z = 3)
   = \mathbb{P}(Y = 3) \cdot \mathbb{P}(X_3 = 0) + \mathbb{P}(Y = 2) \cdot \mathbb{P}(X_3 = 1) + ~
   $$
   
   $$
   ~ + \mathbb{P}(Y = 1) \cdot \mathbb{P}(X_3 = 2)
   = 0,01 \cdot 0,85 + 0,095 \cdot 0,1 + ~
   $$

   $$
   ~ + 0,17 \cdot 0,05
   = 0,0265; ~
   $$

   $$
   ~ \mathbb{P}(Z = 4)
   = \mathbb{P}(Y = 4) \cdot \mathbb{P}(X_3 = 0) + \mathbb{P}(Y = 3) \cdot \mathbb{P}(X_3 = 1) + ~
   $$

   $$
   ~ + \mathbb{P}(Y = 2) \cdot \mathbb{P}(X_3 = 2)
   = 0,0025 \cdot 0,85 + 0,01 \cdot 0,1 + ~
   $$

   $$
   ~ + 0,095 \cdot 0,05
   = 0,007885;
   $$

   $$
   \mathbb{P}(Z = 5)
   = \mathbb{P}(Y = 4) \cdot \mathbb{P}(X_3 = 1) + \mathbb{P}(Y = 3) \cdot \mathbb{P}(X_3 = 2) =
   $$

   $$
   = 0,0025 \cdot 0,1 + 0,01 \cdot 0,05
   = 0,00075;
   $$

   $$
   \mathbb{P}(Z = 6)
   = \mathbb{P}(Y = 4) \cdot \mathbb{P}(X_3 = 2)
   = 0,0025 \cdot 0,05 = 0,000125.
   $$

   Тогда закон распределения для $Z$ имеет вид:

   | $Z$ | $0$ | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ |
   |-|-|-|-|-|-|-|-|
   | $p_i$ | $0,614125$ | $0,21675$ | $0,133875$ | $0,0265$ | $0,007885$ | $0,00075$ | $0,000125$ |

   Это и есть искомое распределение.

2. Рисковая премия равна

   $$
   \text{СРП} = \text{РП}
   = \sum_{i=1}^3 x_i p_i
   = 0 \cdot 0,85 + 1 \cdot 0,1 + 2 \cdot 0,05
   = 0,6 ~ \text{млн}
   $$

   Вычислим вероятность неразорения — она равна сумме вероятностей закона распределения $Z$, которая вычисляется до тех пор, пока не перейдёт порог, равный СРП.

   $$
   \varepsilon
   = 0,614125.
   $$

3. Вычислим накипительные вероятности для $Z$ — каждая из них равна сумме вероятности для текущего значения случайной величины и накопительной вероятности для предыдущего значения:

   | $Z$ | $0$ | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ |
   |-|-|-|-|-|-|-|-|
   | $p_i$ | $0,614125$ | $0,21675$ | $0,133875$ | $0,0265$ | $0,007885$ | $0,00075$ | $0,000125$ |
   | $p_\text{накоп}$ | $0,614125$ | $0,830875$ | $0,96475$ | $0,99125$ | $...$ | $...$ | $...$ |

   Тогда сумма суммарной рисковой премии (СРП) и суммарной рисковой надбавки (СРН) равна первому значению случайной величины, для которого $p_\text{накоп} >= 0,95$.

   $$
   \text{СРП} + \text{СРН} = 2 ~ \text{млн}.
   $$

   Поскольку ранее мы получили, что $\text{СРП} = 0,6$, то

   $$
   \text{СРН} = 2 - 0,6 = 1,4 ~ \text{млн}.
   $$

   Относительную рисковую надбавку $\Theta$ найдём как отношение средней рисковой надбавки на среднюю рисковую премию:

   $$
   \Theta
   = {\text{СРН} \over \text{СРП}} = {1,4 \over 0,6} = 2,333 = 233,3\%.
   $$
:::

## Задача 2

Портфель состоит из 3-ёх независимых договоров страхования неких крупных объектов, учитывающих:

* гибель всего объекта;
* разрушение главного агрегата объекта.

Вероятности этих событий равны:

* $x_1$ = 1 млн у. е., $p_1 = 0.2$; $x_2$ = 2 млн у. е., $p_2 = 0.1$;
* $y_1$ = 0.5 млн у. е., $p_1 = 0.1$; $y_2$ = 2 млн у. е., $p_2 = 0.1$;
* $z_1$ = 0.5 млн у. е., $p_1 = 0.1$; $z_2$ = 1.5 млн у. е., $p_2 = 0.2$.

Требуется найти:
* точное распределение суммарного ущерба по портфелю, используя метод свёрток;
* размер рисковой премии, собираемой по такому портфелю и обеспечиваемую собранной суммой вероятность неразорения страховой компании;
* суммарную рисковую надбавку, необходимую чтобы достичь вероятность неразорения 0.98;
* сколько денежных средств необходимо иметь страховой компании в собственных активах, чтобы при заданной в пункте 3 надёжности относительная рисковая надбавка превышала 15%.

## Задача 3

Портфель состоит из 3-ёх независимых однотипных договоров страхования неких крупных объектов, учитывающих:

* гибель всего объекта, возможную с вероятностью 0.05, при которой выплаты составляют 2 млн у. е.;
* разрушение главного агрегата с вероятностью 0.1, при которой выплаты составляют 1 млн у. е.

Требуется найти точное распределение суммарного ущерба по портфелю, используя метод производящих функций.

::: details Решение
Есть три независимых однотипных договора $X_1$, $X_2$, $X_3$. Требуется найти распределение $X_1 + X_2 + X_3$.

Запишем для данных случайных величин закон распределения, используя данные из условия.

$$
\mathbb{P}(X_i = 1) = 0,1;
~~~~
\mathbb{P}(X_i = 2) = 0,05;
$$

$$
\mathbb{P}(X_i = 0) = 1 - 0,1 - 0,5 = 0,85.
$$

Тогда закон распределения для случайных величин $X_1$, $X_2$, $X_3$ имеет вид:

| $X_i$ | $0$ | $1$ | $2$ |
|-|-|-|-|
| $p_i$ | $0,85$ | $0,1$ | $0,05$ |

Для каждой из случайных величин вычислим производящую функцию моментов. Поскольку данные случайные величины имеют одинаковые законы распределения, то их производящие функции моментов будут равны:

$$
\varphi_{X_1} = \varphi_{X_2} = \varphi_{X_3}
= \sum_{i=0}^n z^i p_i
= 0,85 \cdot z^0 + 0,1 \cdot z^1 + 0,05 \cdot z^2.
$$

> Верхний индекс у $z$ является соответствующим значением случайной величины.

Поскольку случайные величины независимые, то производящая функция моментов их суммы будет равна произведению их производящих функций моментов:

$$
\varphi_{X_1 + X_2 + X_3}
= \varphi_{X_1} \cdot \varphi_{X_2} \cdot \varphi_{X_3}
= \left( 0,85 \cdot z^0 + 0,1 \cdot z^1 + 0,05 \cdot z^2 \right)^3 =
$$

$$
~ = 0,614125 \cdot z^0 + 0,21675 \cdot z^1 + 0,133875 \cdot z^2 + ~
$$

$$
~ + 0,0265 \cdot z^3 + 0,007875 \cdot z^4 + 0,00075 \cdot z^5 + 0,000125 \cdot z^6. ~
$$

По полученной функции можем восстановить закон распределения случайной величины $Z = X_1 + X_2 + X_3$:

| $Z$ | $0$ | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ |
|-|-|-|-|-|-|-|-|
| $p_i$ | $0,614125$ | $0,21675$ | $0,133875$ | $0,0265$ | $0,007885$ | $0,00075$ | $0,000125$ |

> *Можно убедиться, что полученный закон распределения совпадает с полученным в задании 1.*
:::

## Задача 4

Портфель состоит из 3-ёх независимых договоров страхования неких крупных объектов, учитывающих:

* гибель всего объекта;
* разрушение главного агрегата объекта.

Вероятности этих событий равны:

* $x_1$ = 1 млн у. е., $p_1 = 0.2$; $x_2$ = 2 млн у. е., $p_2 = 0.1$;
* $y_1$ = 0.5 млн у. е., $p_1 = 0.1$; $y_2$ = 2 млн у. е., $p_2 = 0.1$;
* $z_1$ = 0.5 млн у. е., $p_1 = 0.1$; $z_2$ = 1.5 млн у. е., $p_2 = 0.2$.

Требуется найти точное распределение суммарного ущерба по портфелю, используя метод производящих функций.

## Задача 5

Портфель состоит из <!--3-ёх -->независимых однотипных договоров страхования неких крупных объектов, учитывающих:

* гибель всего объекта, возможную с вероятностью 0.05, при которой выплаты составляют 2 млн у. е.;
* разрушение главного агрегата объекта с вероятностью 0.1, при которой выплаты составляют 1 млн у. е.

Сколько требуется собрать договоров, чтобы при надёжности $1 - \varepsilon = 0.95$ относительная рисковая надбавка не превышала 20%.

## Задача 6

Портфель состоит из 29 382 договоров страхования. Известно, что:

* для 29 196 договоров страхового случая не произошло;
* для 184 договоров произошёл 1 страховой случай;
* для 2 договоров произошло 2 страховых случая.

Необходимо смоделировать распределение числа страховых случаев в одном договоре с помощью распределения Пуассона и проверить его соответствие с помощью критерия согласия Пирсона на уровне значимости 0,05.

:::: details Код на Python
::: code-group
```python [Python]
from scipy.stats import poisson, chi2, chisquare
import numpy as np

n_total = 29382
lyambda = 0.006398

m_i_emperical = np.array([29196, 184, 2])
k_i_emperical = np.array([0, 1, 2])

p_i_theoretical = poisson.pmf(k_i_emperical, lyambda)

print(f"Теоретические вероятности: {list(p_i_theoretical)}", end = 2 * '\n')

m_i_theoretical = np.round(p_i_theoretical * n_total)
print(f"Теоретические частоты: {list(m_i_theoretical)}", end = 2 * '\n')

xi2 = sum((m_i_emperical - m_i_theoretical)**2 / m_i_theoretical)
print(f"Значение статистики хи-квадрат: {xi2}", end = 2 * '\n')

pval = 1 - chi2.cdf(df = 1, x = xi2)
print(f"Значение p-value: {pval}", end = 2 * '\n')
```

``` :no-line-numbers [Вывод]
Теоретические вероятности: [np.float64(0.993622423622009), np.float64(0.006357196266333616), np.float64(2.0336670856001223e-05)]

Теоретические частоты: [np.float64(29195.0), np.float64(187.0), np.float64(1.0)]

Значение статистики хи-квадрат: 1.0481625946864757

Значение p-value: 0.3059306375947972
```
:::
::::

::: details Решение
Случайная величина $X$ имеет распределение Пуассона, если

$$
\mathbb{P}(X = k) = {e^{-\lambda} \cdot \lambda^k \over k!},
~~ k = 0, 1, ...
$$

В данном случае $k$ — это число страховых случаев.

Имеем следующие исходные данные:

| $\boldsymbol{m}$ | $\boldsymbol{k}$ |
|-|-|
| 29 196 | 0 |
| 184 | 1 |
| 2 | 2 |

Всего договоров $n = 29~196 + 184 + 2 = 29~382$.

Оценим параметр распределения $\lambda$:

$$
\bar{\lambda} = {1 \over n} \sum_{i=1}^3 k_i m_i = {29~196 \cdot 0 + 184 \cdot 1 + 2 \cdot 2 \over 29~382}
= {188 \over 29~382} = 0,006398.
$$

Оценим частоты событий. Для этого сначала вычислим вероятности:

$$
\mathbb{P}(X = 0) = {e^{-\lambda} \cdot \lambda^0 \over 0!} = e^{-\lambda} = e^{-0,006398} = 0,99362;
$$

$$
\mathbb{P}(X = 1) = {e^{-\lambda} \cdot \lambda^1 \over 1!} = \lambda e^{-\lambda} = 0,006398 \cdot e^{-0,006398} = 0,006358;
$$

$$
\mathbb{P}(X = 2) = {e^{-\lambda} \cdot \lambda^2 \over 2!} = {\lambda^2 e^{-\lambda} \over 2} = 0,00002034.
$$

Тогда теоретические частоты $\tilde{m}_i$ равны:

$$
\tilde{m}_1 = \mathbb{P}(X = 0) \cdot n = 0,99362 \cdot 29~382 \approx 29195;
$$

$$
\tilde{m}_2 = \mathbb{P}(X = 1) \cdot n = 0,006358 \cdot 29~382 \approx 187;
$$

$$
\tilde{m}_3 = \mathbb{P}(X = 2) \cdot n = 0,00002034 \cdot 29~382 \approx 1.
$$

Тогда получим:

| $\boldsymbol{\tilde{m}}$ | $\boldsymbol{m}$ | $\boldsymbol{k}$ |
|-|-|-|
| 29 195 | 29 196 | 0 |
| 187 | 184 | 1 |
| 1 | 2 | 2 |

Проверим критерий согласия $\chi^2$:

$$
\chi^2
= \sum_{i=1}^3 { (m_i - \tilde{m}_i)^2 \over \tilde{m}_i } =
$$

$$
= { (29~196 - 29~195)^2 \over 29~195 } + { (184 - 187)^2 \over 187 } + { (2 - 1)^2 \over 1 } = 1,0482.
$$

Вычислим количество степеней свободы: оно равно $L - 1 - m$, где

* $m$ — количество параметров (в данном случае $m = 1$, поскольку есть всего один параметр $\lambda$),
* $L$ — количество интервалов (но у нас дискретная случайная величина, поэтому это просто количество строчек).

В данном случае будет $L - 1 - m = 3 - 1 - 1 = 1$, то есть количество степеней свободы равно 1.

Далее рассчитываем p-значение. В данном случае оно будет равно $0,306$.

В данной задаче уровень значимости $0,05$. Поскольку $0,306 > 0,05$, то нулевая гипотеза о пуассоновском распределении на уровне значимости 0,05 не отвергается.
:::

## Задача 7

Известно, что:

* число страховых случаев $K$ имеет распределение Пуассона со средним $\Lambda$;
* $\Lambda$ имеет гамма-распределение со средним 1 и дисперсией 2.

Определить вероятность того, что $K = 1$.

## Задача 8

Портфель состоит из $n = 2~512$ договоров по страхованию автокаско. Распределение количества страховых случаев представлено в таблице.

| Кол-во страховых случаев | Кол-во договоров |
|-|-|
| 0 | 1 624 |
| 1 | 490 |
| 2 | 208 |
| 3 | 98 |
| 4 | 48 |
| 5 | 23 |
| 6 | 10 |
| 7 | 5 |
| 8 | 3 |
| 9 | 2 |
| 10 | 1 |

Необходимо проверить, подходит ли смешанное пуассоновское гамма-распределение для моделирования числа страховых случаев.

## Задача 9

Портфель состоит из $n = 111~500$ договоров. Распределение количества страховых случаев представлено в таблице.

| Кол-во страховых случаев | Кол-во договоров |
|-|-|
| 0 | 105 925 |
| 1 | 4 940 |
| 2 | 554 |
| 3 | 73 |
| 4 | 7 |
| 5 | 1 |

Необходимо проверить, подходит ли распределение Лемера для моделирования числа страховых случаев.