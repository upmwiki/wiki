---
prev:
   text: 1. Множества и отношения
   link: ../01/
next:
   text: 3. Метрические пространства
   link: ../03/
---

**Раздел 2**

# Теория меры и интегрирование

## Введение

Одним из наиболее фундаментальных понятий геометрии является понятие *мера* $\mu(E)$ твёрдого тела $E$ в одном или нескольких измерениях. В одном, двух и трёх измерениях мы называем эту меру длиной, площадью или объёмом $E$ соответственно.

В классическом подходе к геометрии меру тела вычисляли путём разбиения этого тела на конечное число компонент, а затем собирали эти компоненты в более простое тело с той же мерой.

С появлением аналитической геометрии евклидова геометрия была переосмыслена как изучение декартовых произведений $\mathbb{R}^n$ вещественной прямой $\mathbb{R}$. При использовании этой аналитической основы, а не классической геометрической, уже не было интуитивно очевидным, *как определить меру $\mu(E)$ общего подмножества $E$ из $\mathbb{R}^n$.*

Физическая интуиция определения меры тела $E$ как суммы мер составляющих его «атомов» сразу наталкивается на проблему: твёрдое тело состоит из бесконечного (континуального) числа точек, каждая из которых имеет меру, равную нулю; а произведение $\infty \cdot 0$ не определено.

Парадокс Банаха-Тарского про разбиение шара окончательно выбивает почву из под ног. Мы приходим к выводу, что определить *меру для всякого множества невозможно*, существуют множества $E$, для которых мера $\mu(E)$ принципиально не определима.

Стандартное решение проблемы заключается в том, чтобы *оказаться от цели измерения произвольного подмножества* $E$ из $\mathbb{R}^n$, и вместо этого довольствоваться только измерением подкласса «непатологических» подмножеств, которые называются **измеримыми**.

Было бы естественно потребовать, чтобы выполнялись хотя бы условия:

1. $\mu(\varnothing) = 0$;
2. *неотрицательность:* $\forall E ~ ~ \mu(E) \ge 0$;
3. *счётная аддитивность:* если $E_1, E_2, ...$ -- попарно непересекающиеся множества, то
   $$
   \mu \left( \bigcup_{i=1}^\infty E_i \right) = \sum_{i=1}^\infty \mu(E_i);
   $$
4. *инвариантность* относительно сдвигов и поворотов.

Но оказывается, что определить такую меру для всех подмножеств, например, прямой или плоскости, *невозможно*. При помощи аксиомы выбора можно построить *неизмеримые* множества.

::: info Пример (множество Витали)
Рассмотрим отрезок $[0; 1]$ с отношением эквивалентности

$$
x \sim y ~ \style{font-family:Times}{\text{означает, что}} \!\!\!\!\!\!\!\!\!\!\!\!\!\!\! (x-y) \in \mathbb{Q} ~ \style{font-family:Times}{\text{рациональное число}}\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!.
$$

Тогда отрезок разбивается на континуальное количество классов.

*Возьмём* (в соответствии с аксиомой выбора) в каждом классе *по одному представителю* и *объединим полученные элементы в множество* $V$.

Действительно, рассмотрим все сдвиги $V_q$ множества $V$ на рациональные числа $q$ из интервала $(-1; 1)$, тогда

* все $V_q$ имеют одинаковую меру (обозначим её через $a$);
* $V_q$ попарно не пересекаются;
* объединение $V_q$ полностью накрывает отрезок $[0; 1]$;
* объединение $V_q$ полностью содержится в отрезке $[-1; 2]$.

$$
m([0; 1]) = 1 \le \sum_{i=1}^\infty a = a \cdot \sum_{i=1}^\infty 1 \le 3 = m([-1; 2]),
$$

а этого быть не может ни при каком $a \ge 0$.
:::

## Алгебры множество

::: info Определение
Система подмножеств $\mathcal{F} \subset 2^\Omega$ некоторого множества $\Omega$ называется **алгеброй множеств**, если она

1. содержит $\varnothing$, $\Omega$

и

2. замкнута относительно взятия дополнения, объединения и пересечения:

   $$
   A \in \mathcal{F} \implies A^C \overset{\text{def}}{=} \Omega \backslash A \in \mathcal{F}
   $$

   $$
   A, B \in \mathcal{F} \implies A \cup B \in \mathcal{F}, ~ A \cap B \in \mathcal{F}
   $$
:::

**Пример.** Множество всех интервалов прямой *не образует* алгебры.

::: info Определение
**Сигма-алгебра** $\mathcal{F}$ -- это коллекция подмножеств некоторого множества $\Omega$, которая удовлетворяет условиям:

1. $\Omega \in \mathcal{F}$
2. $A \in \mathcal{F} \implies A^C \overset{\text{def}}{=} A \in \mathcal{F}$
3. $A_i \in \mathcal{F}, ~ i = 1,2,... \implies \cup_i A_i \in \mathcal{F}$

Эти три условия обеспечивают замкнутость $\sigma$-алгебры по отношению к другим операциям, например:

4. $\varnothing \in \mathcal{F}$
5. $A, B \in \mathcal{F} \implies A \backslash B, A \triangle B \in \mathcal{F}$
6. $A_i \in \mathcal{F}, ~ i = 1,2,... \implies \cap_i A_i \in \mathcal{F}$
:::

**Примеры:**

* Наименьшая $\sigma$-алгебра в $\Omega$ состоит из пустого множества $\varnothing$ и всего $\Omega$, наибольшая -- класс $2^\Omega$ всех подмножеств в $\Omega$.
* Класс всяких конечных объединений промежутков вида $(a, b)$, $[a, b]$, $[a, b)$, $(a, b]$ в фиксированном отрезке есть алгебра, но не $\sigma$-алгебра.
* Класс всех конечных подмножеств $\Omega$ и их дополнений есть алгебра, но не $\sigma$-алгебра для бесконечного $\Omega$.
* Класс всех не более чем счётных подмножеств $\Omega$ и их дополнений есть $\sigma$-алгебра.

::: info Определение
Для всякого класса $F$ подмножеств $X$ существует **наименьшая $\boldsymbol{\sigma}$-алгебра, содержащая $F$.** Она обозначается символом $\sigma(F)$ и задаётся формулой

<p>
</p>

Эта $\sigma$-алгебра называется **порождённой классом $\boldsymbol{F}$.**
:::

**Важный пример.** Наименьшая $\sigma$-алгебра $\mathcal{B}$ подмножеств, содержащая все открытые множества (а значит и все замкнутые), называется **$\boldsymbol{\sigma}$-алгеброй Бореля,** а её множества называются **множествами Бореля** или **измеримыми множествами**.

Например, на прямой $\mathcal{B} = \sigma \left(\set{ (a,b), ~ ~ a < b }\right)$.

## Измеримое пространство

**Измеримым пространством** называется пара $(X, \mathcal{F})$, где
* $X$ -- множество,
* $\mathcal{F}$ -- некоторая $\sigma$-алгебра его подмножеств.

## Пространство с мерой

::: info Определение
**Пространством с мерой** называется тройка $(X, \mathcal{F}, \mu)$, где
* $X$ -- множество,
* $\mathcal{F}$ -- некоторая $\sigma$-алгебра его подмножеств,
* $\mu: F \to [0, +\infty]$ -- **счётно-аддитивная мера**, то есть функция, удовлетворяющая условиям:
  1. $\mu(\varnothing) = 0$;
  2. *неотрицательность:* $\forall E \in \mathcal{F}: ~ ~ \mu(E) \ge 0$;
  3. *$\sigma$-аддитивность:* если $\set{E_n}_{n=1}^\infty \subset \mathcal{F}$ -- попарно непересекающиеся множества из $\mathcal{F}$, то
     $$
     \mu \left( \bigcup_{i=1}^\infty E_i \right) = \sum_{i=1}^\infty \mu(E_i).
     $$
:::

Мера называется **конечной**, если $\mu(X) < +\infty$ и **$\boldsymbol{\sigma}$-конечной**, если $X$ представимо в виде объединения счётного объединения $\cup A_i$, где $\mu(A_i) < +\infty ~ ~ \forall i$.

* **Пример.** $X = \set{1, 2, ..., n}$, $\sigma(X) = 2^X$, $\mu(A) = \sum\limits_{i \in A} p_i$. Это стандартная ситуация в теории вероятностей. Например, биномиальный закон:

  $$
  p_i = C_n^i p^i (1 - p)^{n-i}, ~ ~ ~ ~ 0 < p \le 1.
  $$

  При этом в теории вероятностей мера всего пространства равна 1: $\mu(X) = 1$.

* **Пример.** $X \in \mathbb{R}$,
  
  $$
  \mu(A) = \int_A f(x) ~ \text{d}x,
  $$

  где $f(x)$ — неотрицательная функция плотности, интеграл от которой по всей прямой равен $1$.

  В этой ситуации уже не любые подмножества $\mathbb{R}$ могут рассматриваться как случайные события и иметь меру (то есть вероятность).

## Мера Жордана

::: info Определение
**Мера Жордана** прямоугольного параллелепипеда

$$
\Delta = \prod_{i=1}^n [a_i; b_i],
$$

где символ произведения обозначает декартово произведение, определяется как произведение длин его сторон:

$$
\mu(\Delta) \overset{\text{def}}{=} \prod_{i=1}^n (b_i - a_i).
$$
:::

Для ограниченного множества $E \in \mathbb{R}^n$ определяются:

* внешняя мера Жордана:

  $$
  \mu_{\text{ext}}(E) = \inf \sum_{k=1}^N \mu(\Delta_k), ~ ~ ~ ~ \bigcup_k \Delta_k \supset E;
  $$

* внутренняя мера Жордана:

  $$
  \mu_{\text{int}}(E) = \sup \sum_{k=1}^n \mu(\Delta_k), ~ ~ ~ ~ \bigcup_k \Delta_k \subset E,
  $$

где во втором случае параллелепипеды попарно не пересекаются.

::: info Определение
Множество называется **измеримым по Жордану**, если эти две меры совпадают.
:::

**Пример.** Множество $A$ рациональных точек отрезка $[0; 1]$ неизмеримо по Жордану. Почему?

*Ответ:* $\mu_\text{ext}(A) = 1$, $\mu_\text{int}(A) = 0$.

## Мера Лебега

Мера Лебега является продолжением меры Жордана *на более широкий класс множеств*.

Множества, представляющие собой **объединение конечного или счётного числа прямоугольных параллелепипедов с рёбрами, параллельными осям координат** $\Delta_i$ будем называть **элементарными**.

Для произвольного ограниченного множества $E \subset B$ можно найти много содержащих его в себе элементарных множеств $A = \cup_i \Delta_i$. Назовём такие системы **покрытиями**.

::: info Определение
Точная нижняя грань по всем покрытиям данного множества $E$ сумм объёмов параллелепипедов $\Delta_i$ называется его **внешней мерой:**

$$
\mu_\text{ext}(E) = \inf_{A \supset E} \left( \sum_{\Delta_i \in A} \mu(\Delta_i) \right).
$$
:::

::: info Определение
Будем говорить, что множество $E$ **измеримо по Лебегу**, если для любого $S \subset \mathbb{R}^n$

$$
\mu_\text{ext}(S) = \mu_\text{ext}(S \cap E) + \mu_\text{ext}(S \backslash E).
$$

По определению **мера Лебега для измеримого множества**

$$
\mu(E) = \mu_\text{ext}(E).
$$
:::

### Свойства меры Лебега

* **Теорема Лебега.** Измеримые по Лебегу множества *образуют $\sigma$-алгебру.*

* Множество $E$ измеримо по Лебегу $\iff$ его *дополнение до содержащего его измеримого* измеримо по Лебегу.

* Любое открытое или замкнутое множество в $\mathbb{R}^n$ и, следовательно, *любое борелевское измеримы по Легебу*. Но существуют и не борелевские измеримые множества.

* Множество $E$ измеримо по Легебу $\iff$ $\forall \varepsilon > 0$ существуют открытое множество $G$ и замкнутое множество $F$, такие, что $F \subset E \subset G$ и $\mu(G \backslash F) < \varepsilon$.

* Если множество $E$ имеет нулевую меру Лебега, то всякое его подмножество измеримо и тоже имеет нулевую меру Лебега.

* Мера Лебега не изменяется при параллельном переносе.

* Если множество $E$ измеримо, а $A$ — линейный оператор в $\mathbb{R}^n$, то $A(E)$ измеримо и имеет меру

  $$
  \mu(A(E)) = \left| \det{A} \right| \cdot \mu(E).
  $$

* **Теорема (непрерывность меры Лебега).** Пусть $E_1, E_2, E_3, ...$ — измеримые по Лебегу множества и

  $$
  E_1 \subset E_2 \subset E_3 \subset \cdots, ~ ~ ~ ~ E = \bigcup_i E_i.
  $$

  Тогда $E$ измеримо и

  $$
  \mu(E) = \lim_{i \to \infty} \mu(E_i).
  $$


::: info Пример
Множество $A$ рациональных точек отрезка $[0; 1]$ имеет меру Лебега, равную $0$. Соответственно, множество иррациональных точек этого отрезка имеет меру, равную $1$.

Более того, любое **счётное** множество точек (на прямой, плоскости, в пространстве...) имеет **меру Лебега $\boldsymbol{0}$**. Действительно, для любого $\varepsilon > 0$ его можно покрыть системой (отрезков, квадратов, ...) $\set{Q_n}$, где

$$
\mu(Q_n) \le {\varepsilon \over 2^n}.
$$

Суммируя, получаем, что мера такого множества не превосходит любого $\varepsilon > 0$, то есть она равна $0$.
:::

::: info Пример (множество Кантора)
Из единичного отрезка $C_0 = [0; 1]$ удалим среднюю треть, то есть интервал $(1/3; 2/3)$. Оставшееся множество обозначим через $C_1$. Множество $C_1$ состоит из двух отрезков; удалим теперь из каждого отрезка его среднюю часть, и оставшееся множество обозначим через $C_2$. И так далее. *Пересечение всех полученных множеств называется **канторовым множеством**.*

![](/media/images/funcanalysis_2_1.png)

*Другое определение:* **множество Кантора** — множество чисел от нуля до единицы, которые можно представить в троичной записи с помощью только нулей и двоек.

Имеет мощность *континуума*, но, очевидно, *нулевую* меру Лебега.
:::

## Терминология

Говорят, что некоторое условие выполняется **«почти всюду»** (сокращение **п. в.**) **относительно заданной меры**, если *множество*, для которого условие *не выполняется*, содержится в некотором множестве *меры 0*. Например:

$$
f = g ~ \style{font-family:Times}{\text{п.в.}}\!\!\!\!\!\!
$$

## Измеримые функции

::: info Определение
Отображение $f: X \to Y$ между измеримыми пространствами называется **измеримым**, если

$$
\forall A \in \mathcal{F}_2: f^{-1}(A) \in \mathcal{F}_1.
$$
:::

В случае *числовой* функции $f: X \to \mathbb{R}$ в качестве измеримых множеств на прямой $\mathbb{R}$ чаще всего выбирается *борелевская* $\sigma$-алгебра, и тогда функцию называют **измеримой по Борелю**.

::: info Теорема
Функция $f: X \to \mathbb{R}$ измерима по Борелю в том и только том случае, если при любом $a \in \mathbb{R}$ измеримо множество

$$
\set{ x: ~ f(x) < a }
$$
:::

*Непрерывная* вещественная функция *измерима* по Борелю ($\implies$ и просто измерима).

Многие разрывные функции тоже измеримы. Впрочем имеет место следующая теорема.

::: info Теорема Лузина
Функция $f: [a;b] \in \mathbb{R}$ измерима по Лебегу в том и только в том случае, если при любом $\varepsilon > 0$ существует непрерывная на отрезке $[a;b]$ функция, которая отличается от $f$ только на множестве меры, меньшей чем $\varepsilon$.
:::

**Пример.** Функция Дирихле

$$
\boldsymbol{1}_\mathbb{Q}(x) =
\begin{cases}
1, & x \in \mathbb{Q}, \\
0, & x \notin \mathbb{Q}
\end{cases}
$$

разрывна в каждой точке, но измерима по Лебегу (так как она отличается от тождественного нуля на множестве $\mathbb{Q}$ нулевой меры).

::: info Определение
Функции, значения которых отличаются на множестве *нулвой меры*, считаются **эквивалентными**. В пространствах измеримых функций в качестве элементов обычно подразумеваются *классы эквивалентных функций*. Конкретную функцию называют представителем своего класса.
:::

В частности, когда говорят о *поточечной* сходимости измеримых функций, имеется в виду сходимость *почти всюду*.

::: info Определение
Измеримую функцию $f$ называют **существенно ограниченной сверху**, если $\exists a: f(x) \le a$ п.в.

**Существенной верхней гранью** называется

$$
\text{ess sup} ~ f \overset{\text{def}}{=} \inf \set{ a: ~ f(x) \le a ~ \style{font-family:Times}{\text{п. в.}}\!\!\!\!\!\!\!\!\! }
$$

С **нижней** гранью аналогично.
:::

* Пусть $f: (X_1, \mathcal{F}_1) \to (X_2, \mathcal{F}_2)$, $g: (X_2, \mathcal{F}_2) \to (X_3, \mathcal{F}_3)$ — измеримые функции. Тогда их **композиция $\boldsymbol{g \circ f}$ измерима**.

* **Сумма** и **произведение** измеримых числовых функций **измеримы**. Так же, как и **частное**, только если нет деления на $0$.

* **Поточечный** предел,

  $$
  F(x) = \lim_{n \to \infty} f_n(x),
  $$

  **верхняя грань** и **нижняя грань**

  $$
  G(x) = \sup_n f_n(x), ~ ~ ~ ~ H(x) = \inf_n f_n(x),
  $$

  последовательности измеримых вещественных функций **измеримы**.

## Интеграл

Одно из основных применений меры — это введение понятия интегрирования на пространстве с мерой. Собственно, мера множества нередко определяется посредством вычисления интеграла.

* Пусть $(X, \mathcal{F}, \mu)$ — пространство с мерой. Числовая функция $f$ на $X$ называется **простой**, если

  $$
  f(x) =
  \begin{cases}
  f_i, & x \in B_i, ~ i = \overline{1,n}, \\
  0, & \style{font-family:Times}{\text{иначе}}\!\!\!\!\!,
  \end{cases}
  $$

  где $\set{B_i}_{i=1}^n$ — набор непересекающихся измеримых множеств из $\mathcal{F}$.

  ![](/media/images/funcanalysis_2_2.png)

* Простая функция называется **интегрируемой**, если

  $$
  \sum_{i=1}^n |f_i| \mu(B_i) < \infty.
  $$

  Для **простой** функции $f$ положим *по определению*

  $$
  \intop_X f(x) \mu(\text{d}x) = \sum_{i=1}^n f_i \mu(B_i).
  $$

* Функция $h(x)$ на пространстве с мерой $(X, \mathcal{F}, \mu)$ называется **интегрируемой**, если существует последовательность простых функций $\set{h_n(x)}$, сходящаяся почти всюду к $h$, такая, что

  $$
  \lim_{i,j \to \infty} \intop_X \left| h_i(x) - h_j(x) \right| ~ \mu(\text{d}x) = 0.
  $$

* Для такой функции полагают по определению

  $$
  \intop_X f(x) \mu(\text{d}x) \overset{\text{def}}{=} \lim_{i \to \infty} \intop_X h_i(x) ~ \mu(\text{d}x).
  $$

  Нетрудно показать, что для интегрируемой функции этот предел существует, конечен и не зависит от выбора $\set{h_n(x)}$.

::: info Определение
Если функция интегрируема, то для произвольного множества $A \in \mathcal{F}$ полагают по определению

$$
\intop_A f(x) ~ \mu(\text{d}x) \overset{\text{def}}{=} \intop_X f(x) \boldsymbol{1}_A(x) ~ \mu(\text{d}x),
$$

где $\boldsymbol{1}_A(x)$ — *характеристическая функция* множества $A$:

$$
\boldsymbol{1}_A(x) =
\begin{cases}
1, & x \in A, \\
0, & \style{font-family:Times}{\text{иначе}}\!\!\!\!\!.
\end{cases}
$$
:::

Это определение интеграла годится для любого пространства с любой мерой.

Рассмотрим немного подробнее случай, когда мера $\mu$ является мерой Лебега, в этом случае мера всякого отрезка по определению равна его длине.

## Определённый интеграл по отрезку

**Интеграл** от неотрицательной действительной функции $f$, определённой на отрезке $[a,b]$, можно интерпретировать как *площадь* под графиком $f$ между $a$ и $b$. Это *понятие площади* подходит для некоторых функций, в основном кусочно-непрерывных функций, включая элементарные функции, например, полиномы.

![](/media/images/funcanalysis_2_3.png)

Однако графики других функций, например, функции Дирихле, не очень хорошо соответствуют понятию площади. Графики, подобные последнему, поднимают вопрос: для какого класса функций *имеет смысл «площадь под кривой»*?

![](/media/images/funcanalysis_2_4.png)

## Определённый интеграл «по Риману»

::: info Определение
Пусть функция $f(x)$ определена на отрезке $[a,b]$. Пусть *существует* предел

$$
\lim_{\max \Delta x_i \to 0} \sum f(\xi_i) \Delta x_i
$$

и этот предел *не зависит* от выбора разбиений отрезка $[a,b]$ и выбора точек $\xi_i$. Тогда этот предел называется **определённым интегралом от функции $\boldsymbol{f(x)}$ по отрезку $\boldsymbol{[a,b]}$** и обозначается

$$
\intop_a^b f(x) ~ \text{d}x.
$$
:::

Функция, для которой интеграл Римана в пределах от $a$ до $b$ существует (если предел равен бесконечности, то считается, что интеграл не существует), называется **интегрируемой по Риману на отрезке $\boldsymbol[a;b]$**.

::: info Теорема (Лебег)
Ограниченная функция на отрезке *интегрируема по Риману* $\iff$ она *почти всюду непрерывна*, то есть множество точек разрыва имеет меру ноль.
:::

**Пример.** *Функция Дирихле* $\boldsymbol{1}_\mathbb{Q}(x)$, принимающая значение $1$ на всех рациональых числах, и значение $0$ на всех иррациональных, не интегрируема по Риману ни на каком отрезке (множество точек разрыва — вся числовая ось).

$$
\boldsymbol{1}_\mathbb{Q}(x) =
\begin{cases}
1, & x \in \mathbb{Q}, \\
0, & x \notin \mathbb{Q}.
\end{cases}
$$

![](/media/images/funcanalysis_2_5.png)

**Пример.** Функция $f(x)$, принимающая значение $1/n$ в рациональных точках $x = m/n$ (несократимая дробь) и значение $0$ в иррациональных, интегрируема по Риману на любом отрезке.

![](/media/images/funcanalysis_2_6.png)

* Во многих ситуациях существует потребность вычислять интегралы и от функций, не удовлетворяющих условиям теоремы Лебега. Есть и другие чисто математические пожелания, например, перестановка интегрирования и перехода к пределу.
  
  То есть требуется как-то расширить опрделение интеграла.

* Существуют разные варианты такого расширения, например, интеграл Римана-Стилтьеса, но наиболее востребованным является так называемый интеграл Лебега. Для «хороших» функций его значение совпадает с интегралом Римана, но область определения включает более широкий класс функций (собственно — это и есть измеримые функции).

## Интеграл Лебега

Интеграл Лебега есть более общий, чем интеграл Римана, который он в значительной степени заменил в математическом анализе с первой половины 20-го века. Он охватывает функции с разрывами, возникающими во многих приложениях, которые являются патологическими с точки зрения интеграла Римана.

Интеграл Лебега также имеет в целом лучшие аналитические свойства. Например, при достаточно мягких условиях можно также поменять местами пределы и интегрирование Лебега, в то время как условия для этого с интегралом Римана существенно сложнее.

«Идейное» отличие интеграла Лебега от интеграла Римана в том, что разбиению подвергается не область определения, а область значений функции.

![](/media/images/funcanalysis_2_7.png)

В то время как интеграл Римана рассматривает площадь под кривой как состоящую из вертикальных прямоугольников, определение Лебега рассматривает горизонтальные плиты, которые не обязательно являются просто прямоугольниками, оно более гибкое. Поэтому определение Лебега позволяет вычислять интегралы для более широкого класса функций.

::: info Определение 1
Пусть $f$ — *простая* числовая функция, то есть

$$
f(x) = \sum_{i=1}^n f_i \cdot \boldsymbol{1}_{B_i},
$$

где $\set{B_i}_{i=1}^n$ — разбиение $X$ на измеримые множества. Тогда интеграл Лебега по определению:

$$
\intop_X f(x) ~ \mu(\text{d}x) \overset{\text{def}}{=} \sum_{i=1}^n f_i \cdot \mu(B_i).
$$

![](/media/images/funcanalysis_2_8.png)
:::

**Пример.** Функция Дирихле $\boldsymbol{1}_\mathbb{Q}(x)$. Интеграл по Риману не существует. Интеграл по Лебегу существует:

$$
\intop_{[0,1]} \boldsymbol{1}_\mathbb{Q}(x) ~ \text{d}x
=
$$

$$
= 0 \cdot \mu \left( \set{ 0 \le x \le 1 : \boldsymbol{1}_\mathbb{Q}(x) = 0 } \right)
+ 1 \cdot \mu \left( \set{ 0 \le x \le 1 : \boldsymbol{1}_\mathbb{Q}(x) = 1 } \right) =
$$

$$
= 0 \cdot \mu\left(\set{ 0 \le x \le 1 : x \notin \mathbb{Q} }\right)
+ 1 \cdot \mu\left(\set{ 0 \le x \le 1 : x \in \mathbb{Q} }\right) =
$$

$$
= 1 \cdot 0 = 0.
$$

::: info Определение 2
Пусть $f$ — *неотрицательная функция*. Рассмотрим все простые функции $\set{f_s}$, такие, что $f_s(x) \le f(x)$ для любого $x \in X$. Тогда по определению

$$
\intop_X f(x) ~ \mu(\text{d}x) \overset{\text{def}}{=}
\sup \left( \intop_X f_s(x) ~ \mu(\text{d}x) \right).
$$
:::

![](/media/images/funcanalysis_2_9.png)

Для некоторых функций может получиться бесконечность.

::: info Определение 3
Пусть $f$ — *произвольная измеримая функция*. Тогда её можно представить в виде разности двух неотрицательных измеримых:

$$
\begin{array}{c}
f = f_1 - f_2, ~ ~ ~ ~ f_1(x) = \max \set{f(x), 0}, \\
f_2(x) = \min \set{f(x), 0}.
\end{array}
$$

Тогда по определению

$$
\intop_X f(x) ~ \mu(\text{d}x) \overset{\text{def}}{=}
\intop_X f_1(x) ~ \mu(\text{d}x) -
\intop_X f_2(x) ~ \mu(\text{d}x),
$$

если хотя бы один из двух интегралов в правой части конечен.
:::

::: info Определение 4
Наконец, пусть $A$ — произвольное измеримое множество. Тогда по определению

$$
\intop_A f(x) ~ \mu(\text{d}x) \overset{\text{def}}{=}
\intop_X f(x) \boldsymbol{1}_A(x) ~ \mu(\text{d}x).
$$
:::

### Основные свойства интеграла Лебега

Говорят, что две функции **равны почти всюду** ($f=g$ п. в.), если $\set{x: f(x) \ne g(x)}$ является подмножеством множества меры ноль.

* Если $f$ и $g$ — такие функции, что $f=g$ п. в., то $f$ интегрируема по Лебегу тогда и только тогда, когда $g$ интегрируема по Лебегу, и интегралы от $f$ и $g$ одинаковы, если они существуют.

* *Линейность:* если $f$ и $g$ — функции, интегрируемые по Лебегу, а $a$ и $b$ — действительные числа, то $af + bg$ — интегрируемая по Лебегу функция и

  $$
  \int (af + bg) ~ \text{d}\mu = a \int f ~ \text{d}\mu + b \int g ~ \text{d}\mu.
  $$

* *Монотонность:* если $f \ge g$, то
  
  $$
  \int f ~ \text{d}\mu \le \int g ~ \text{d}\mu.
  $$

## Предельные переходы

Пусть интегрируемые функции $f_n$ сходятся почти всюду к функции $f$. Когда $f$ интегрируема и когда её интеграл равен пределу интегралов от $f_n$? Без дополнительных условий это неверно. Например, функции

$$
f_n = n \cdot \boldsymbol{1}_{(0,1/n]}
$$

на $[0,1]$ *поточечно сходятся к нулю* и *имеют интегралы 1* по мере Лебега. Чтобы исправить дело, нужны какие-то *дополнительные условия*.

![](/media/images/funcanalysis_2_10.png)

::: info Теорема о монотонной сходимости
Предположим, что $\set{f_k}$ — последовательность неотрицательных измеримых функций, такая что

$$
f_k(x) \le f_{k+1}(x) ~ ~ ~ ~ \forall x \in A.
$$

Тогда поточечный предел $f$ функции $f_k$ измерим по Лебегу и

$$
\lim_{k \to \infty} \intop_A f_k ~ \text{d}\mu = \intop_A f ~ \text{d}\mu.
$$
:::

::: info Лемма Фату
Если $\set{f_k}$ — последовательность неотрицательных измеримых функций, то

$$
\int \lim_{k \to \infty} \inf (f_k) ~ \text{d}\mu \le
\lim_{k \to \infty} \inf \left( \int f_k ~ \text{d}\mu \right).
$$

Значение любого из интегралов может быть бесконечным.
:::

::: info Теорема о мажорированной сходимости
Пусть $\set{f_k}$ — последовательность комплексных измеримых функций почти всюду сходится к функции $f$, и существует интегрируемая по Лебегу функция $g$ такая, что $|f_k| \le g$ для всех $k$.

Тогда $f$ интегрируема по Лебегу и

$$
\lim_{k \to \infty} \left( \int f_k ~ \text{d}\mu \right) = \int f ~ \text{d}\mu.
$$
:::