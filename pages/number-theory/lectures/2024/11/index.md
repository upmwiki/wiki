---
prev:
    text: § 10. Арифметические применения сравнений
    link: ../10/
next:
    text: § 12. Виды алгебраических операций
    link: ../12/
---

# § 11. Непрерывные (цепные) дроби

::: info ОПРЕДЕЛЕНИЕ
Пусть $q_0, q_1, ..., q_n \in \mathbb{Z}$. Тогда **непрерывной** (или **цепной**) **дробью** называется выражение вида

$$
q_0 + \cfrac{1}{q_1
   + \cfrac{1}{q_2
      + \cfrac{1}{\dots
         + \cfrac{\dots}{\cdots
            + \cfrac{1}{q_n}
         }
      }
   }
} = (*),
$$

где $q_0$ — целая часть, $q_1, ..., q_n$ — неполные частные.
:::

Такая цепная дробь обозначается так:

$$
(*) = [ q_0; q_1, ..., q_n ].
$$

Например, $[1; 2, 3, 4] = 1 + \cfrac{1}{2 + \cfrac{1}{3 + \cfrac{1}{4}}}$.

:::: info ТЕОРЕМА (СУЩЕСТВОВАНИЯ)
Всякое рациональное число, не равное нулю, может быть представлено в виде непрерывной дроби.

::: info Доказательство
При доказательстве этой теоремы используется алгоритм Евклида (если ${a \over b} > 0$):
$$ a = bq_0 + r_1, $$
$$ b = r_1q_1 + r_2, $$
$$ \vdots $$
$$ r_{n-1} = r_nq_n. $$

Можно доказать, что полученные $q_0, q_1, ..., q_n$ и есть целая часть и неполные частные искомой цепной дроби.
:::

::::

::: info ЗАМЕЧАНИЕ
Можно доказать, что все неполные частные, начиная с $q_1$ — натуральные числа.
:::

Если ${a \over b} < 0$, то записывают эту дробь в виде целой и дробной части.

Пусть целая часть равна $c$, $c \le -1$, а ${a \over b}'$ — дробная часть, $0 \le {a \over b}' < 1$. Дробную часть с помощью алгоритма Евклида представляем в виде цепной дроби, у которой целая часть $q_0 = 0$.

::: info ПРИМЕР
Рассмотрим непрерывные дроби $[2;1,5,2]$ и $[2;1,5,1,1]$. Найдём их значения.

*Решение.*

$$
[2; 1, 5, 2] = 2 + \cfrac{1}{1 +
   \cfrac{1}{5 +
      \cfrac{1}{2}
   }
} = \frac{37}{13};
$$

$$
[2; 1, 5, 1, 1] = 2 + \cfrac{1}{1 +
   \cfrac{1}{5 +
      \cfrac{1}{1 +
         \cfrac{1}{1}
      }
   }
} = {37 \over 13}.
$$
:::

::: info ТЕОРЕМА (ЕДИНСТВЕННОСТИ)
Представление данного рационального числа в виде цепной дроби, в которой последнее неполное частное $q_n \ne 1$, единственно.
:::

Пусть ${a \over b} = [q_0; q_1, ..., q_n]$. Тогда дроби ${P_0 \over Q_0} = [q_0]$, ${P_1 \over Q_1} = [q_0; q_1]$, ..., ${P_{n-1} \over Q_{n-1}} = [q_0; q_1, ..., q_{n-1}]$.

Эти дроби называются **подходящими** дробями данной цепной дроби (или числа ${a \over b}$).

Исходную цепную дробь можно рассматривать как $n$-ую подходящую дробь.

::: info ПРИМЕР
Для $[q_0; q_1, ..., q_n]$ вычислим нулевую, первую и вторую подходящие дроби.

*Решение.*

$$
{ P_0 \over Q_0 } = [q_0] = q_0;
$$

$$
{ P_1 \over Q_1 } = [q_0; q_1] = q_0 + {1 \over q_1} = { q_0q_1 + 1 \over q_1 };
$$

$$
{ P_2 \over Q_2 } = [q_0; q_1, q_2] = q_0 + { 1 \over q_1 + { 1 \over q_2 } } = q_0 + { 1 \over { q_1q_2 + 1 \over q_2 } } = 
$$
$$
= q_0 + { q_2 \over q_1q_2 + 1 } = { q_0q_1q_2 + q_0 + q_2 \over q_1q_2 + 1 }.
$$
:::

::: info ТЕОРЕМА (О ВЫЧИСЛЕНИИ ПОДХОДЯЩИХ ДРОБЕЙ)
Пусть $[a_0; a_1, ..., a_n]$ — цепная дробь. Тогда подходящие дроби можно найти с помощью рекуррентной формулы:

$$
{ P_0 \over Q_0 } = a_0; ~ ~ ~ { P_1 \over Q_1 } = { a_0a_1 + 1 \over a_1 }; ~ ~ ~ ...;
$$
$$
{ P_k \over Q_k } = { P_{k-1}a_k + P_{k-2} \over Q_{k-1}a_k + Q_{k-2} }, ~ ~ k \ge 2.
$$
:::

Теорема доказывается с помощью метода математической индукции.

::: info ПРИМЕР
Вычислим подходящие дроби для цепной дроби $[2; 1, 3, 2, 3, 1, 5]$.

*Решение.* Для этого составим таблицу.

| $k$ | 0 | 1 | 2 | 3 | 4 | 5 | 6 |
|-|-|-|-|-|-|-|-|
| $\alpha_k$ | 2 | 1 | 3 | 2 | 3 | 1 | 5 |
| $P_k$ | 2 | 3 | 11 | 25 | 86 | 111 | 641 |
| $Q_k$ | 1 | 1 | 4 | 9 | 31 | 40 | 231 |

Подходящие дроби ${P_k \over Q_k}$ вычисляются следующим образом:

$$
{ P_0 \over Q_0 } = a_0 = 2 \implies P_0 = 2, ~ ~ Q_0 = 1;
$$

$$
{ P_1 \over Q_1 } = { a_0a_1 + 1 \over a_1 } = { 2 \cdot 1 + 1 \over 1 } = 3 \implies P_1 = 3, ~ ~ Q_1 = 1;
$$

$$
{ P_2 \over Q_2 } = { P_1 a_2 + P_0 \over Q_1 a_2 + Q_0 } = {11 \over 34} \implies P_2 = 11, ~ ~ Q_2 = 4;
$$

$$
{ P_3 \over Q_3 } = { P_2 a_3 + P_1 \over Q_2 a_3 + Q_1 } = { 25 \over 9 } \implies P_3 = 25, ~ ~ Q_3 = 9;
$$

$$
{ P_4 \over Q_4 } = {86 \over 31}; ~ ~ ~ {P_5 \over Q_5} = {111 \over 40}; ~ ~ ~ {P_6 \over Q_6} = {641 \over 231}.
$$

Таким образом, $[2;1,3,2,3,1,5] = { 641 \over 231 }$.
:::

## Свойства подходящих дробей

1. Если дробь ${a \over b}$ представлена в виде цепной дроби, то дробь ${a \over b}$ лежит между дробью с номером $k-1$ и дробью с номером $k$, и ближе к $k$-ой дроби:
   $$
   { P_{k-1} \over Q_{k-1} } < {a \over b} < {P_k \over Q_k}.
   $$

2. Разность соседних подходящих дробей равна по модулю
   $$
   \left|{P_{k+1} \over Q_{k+1}} - {P_k \over Q_k}\right| = { 1 \over Q_k Q_{k+1} },
   $$
   независимо от того, какая из дробей больше.

   ::: info СЛЕДСТВИЯ
   1. Любая подходящая дробь не сократима.
   2. Если $k$ чётно, то ${a \over b} > {P_k \over Q_k}$, а если нечётно, то ${a \over b} < {P_k \over Q_k}$.
   :::

3. Из всех дробей со знаменателем не больше, чем $Q_k$, дробь ${P_k \over Q_k}$ даёт наилучшее приближение числа ${a \over b}$.

   *Это означает, что если $x > 0$ и $0 < y \le Q_k$, то модуль разности*
   $$
   \left| {a \over b} - {x \over y} \right| \ge \left| {a \over b} - {P_k \over Q_k} \right|.
   $$

## Применение подходящих дробей

### Приближённые значения рациональных чисел

::: info ЗАДАЧА
Найти подходящую дробь ${P_k \over Q_k}$ числа ${a \over b} = {2517 \over 773}$ такую, что ${P_k \over Q_k} \approx {2517 \over 773}$ с точностью до 0,001.

*Решение.* Запишем дробь ${2517 \over 773}$ в виде цепной дроби.

$$
{2517 \over 773} = [3; 3, 1, 9, 2, 2, 1, 2].
$$

Найдём подходящие дроби. Для этого составим таблицу:

| $k$ | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 |
|-|-|-|-|-|-|-|-|-|
| $a_k$ | 3 | 3 | 1 | 9 | 2 | 2 | 1 | 2 |
| $P_k$ | 3 | 10 | 13 | 127 | 267 | 661 | 928 | 2517 |
| $Q_k$ | 1 | 3 | 4 | 39 | 82 | 203 | 285 | 773 |

Поскольку

$$
\left| {P_k \over Q_k} - {P_{k+1} \over Q_{k+1}} \right| < { 1 \over Q_k Q_{k+1} }
$$
и дробь ${2517 \over 773}$ лежит между ${P_k \over Q_k}$ и ${P_{k+1} \over Q_{k+1}}$, то

$$
\left| {2517 \over 773} - {P_k \over Q_k} \right| < {1 \over Q_k Q_{k+1}}.
$$

Значит, достаточно найти такие $k$, что $Q_k \cdot Q_{k+1} > 1000$.

Заметим, что $Q_2 \cdot Q_3 < 1000$, а $Q_3 \cdot Q_4 > 1000$. Таким образом, в качестве нужной подходящей дроби можно взять ${P_3 \over Q_3} = {127 \over 39}$.

**Ответ:** ${127 \over 39}$.
:::

### Представление квадратных корней в виде цепной дроби

::: info ПРИМЕР
Представть в виде периодической цепной дроби число $\sqrt{37}$.

*Решение.*

$$
x = \sqrt{37} ~ ~ ~ (6 < x < 7) ~ ~ \implies x = 6 + {1 \over x_1} \implies
$$

$$
\implies x_1 = {1 \over x - 6} = { 1 \over \sqrt{37} - 6 } = \sqrt{37} + 6;
$$

$$
x_1 = \sqrt{37} + 6 ~ ~ ~ (12 < x < 13) ~ ~ \implies x_1 = 12 + {1 \over x_2} \implies
$$

$$
\implies x_2 = {1 \over x_1 - 12} = {1 \over \sqrt{37} - 6} = \sqrt{37} + 6.
$$

Аналогично для $x_3$, $x_4$ и т. д. Окончательно получится:

$$
x = 6 + { 1 \over 12 + { 1 \over 12 + { 1 \over 12 + { 1 \over \dots } } } }
$$

или, короче, $x = [6; (12)]$. Круглые скобки означают периодичность.

**Ответ:** $\sqrt{37} = [6; (12)]$.
:::