---
prev: false
next: false
---

**Лекция 1**

# Теория игры с природой

**Теория игр с природой** — это раздел теории игр, который изучает принятие решений в условиях неопределённости. В отличие от классической теории игр, где предполагается наличие нескольких игроков с различными интересами, в играх с природой один из участников является «природой». Этот участник действует случайным образом, не имея конкретных целей или стратегий.

Основные элементы игры с природой:
* **игрок:** лицо или организация, принимающее решение;
* **природа:** неконтролируемый фактор, действующий случайно;
* **стратегии игрока:** различные варианты действий, доступные игроку;
* **функция выигрыша/потерь:** зависимость результата от выбранной стратегии и состояния природы;
* **оптимальная стратегия:** стратегия, обеспечивающая наилучший результат при любых действиях природы.

Факторы принятия решений в игре с природой:
* получение *выгоды*;
* потенциальные *потери*.

----

::: details Применение теории игр с природой в жизни

* Экономика и финансы
* Политика и государственное управление
* Медицина и здравоохранение
* Военное дело и безопасность
* Экология
* Инженерия и строительство
* Транспорт и логистика
  * *Оптимизация маршрутов:* учёт погодных условий, пробок и других факторов, влияющих на транспортировку грузов;
  * *Управление запасами:* обеспечение необходимого уровня товаров в условиях непредсказуемого спроса.
:::

----

::: info Определение
Игра, в которой осознанно действует только один из игроков, называется **игрой с природой**.
:::

Природа может принимать одно из своих возможных состояний и не имеет целью получение выигрыша.

Игра с природой представляется в виде платёжной матрицы, элементы которой — выигрыши игрока $A$, но не являются проигрышами природы $\Pi$.

Имеем:

* игрок $A$, $S_A = \set{ p_1, p_2, ..., p_m }$, $F_A(P, \Pi_j)$;
* природа $\Pi$ с состояниями $S_\Pi = \set{ \style{font-family:Times}{\text{п}}_1, \style{font-family:Times}{\text{п}}_2, ..., \style{font-family:Times}{\text{п}}_n }$.

| $\boldsymbol{A ~ / ~ \Pi}$ | $\boldsymbol{\Pi_1}$ | $\boldsymbol{\Pi_2}$ | $\boldsymbol{\Pi_3}$ | $\boldsymbol{\cdots}$ | $\boldsymbol{\Pi_n}$ |
|-|-|-|-|-|-|
| $\boldsymbol{A_1}$ | $a_{11}$ | $a_{12}$ | $a_{13}$ | $\cdots$ | $a_{1n}$ |
| $\boldsymbol{A_2}$ | $a_{21}$ | $a_{22}$ | $a_{23}$ | $\cdots$ | $a_{2n}$ |
| $\boldsymbol{\vdots}$ | $\vdots$ | $\vdots$ | $\vdots$ | $\ddots$ | $\vdots$ |
| $\boldsymbol{A_m}$ | $a_{m1}$ | $a_{m2}$ | $a_{m3}$ | $\cdots$ | $a_{mn}$ |

Каждый элемент платёжной матрицы $a_{ij}$ — выигрыш игрока $A$ при стратегии $A_i$ в состоянии природы $\Pi_j$.

С одной стороны, задача выбора оптимальной стратегии для игрока $A$ упрощается. С другой, задача осложняется из-за дефицита информации о поведении природы.

## Существующие правила игры с природой

* Критерий Байеса
* Критерий Вальда
* Критерий Гурвица (пессимизма-оптимизма)
* Критерий Лапласа
* Критерий Сэвиджа (минимальный риск)
* Критерий Ходжеса-Лемана
* Критерий Байеса-Лапласа

Выбор критерия зависит от результирующих факторов принятия решений.

### Критерий Байеса

**Критерий Байеса** — это метод принятия решений в условиях, когда известны вероятности состояния природы. Зачастую эти вероятности получают с помощью экспертных оценок, анализа исторической информации, прогнозных моделей и проведения экспериментов.

::: info Основное описание критерия Лапласа
Суть критерия в том, что всем рассматриваемым стратегиям придают равные вероятности, после чего принимают ту из них, при которой ожидаемый выигрыш окажется наибольшим.
:::

$$
\max_i \bar{a}_i = \max_i \sum_{j=1}^n a_{ij} p_j,
$$

$p_1 = p_2 = \cdots = p_n = {1 \over n}$ $\implies \max\limits_i \bar{a}_i = {1 \over n} \sum\limits_{j=1}^n a_{ij}$.

Преимущества:

* превращает задачу о выборе решения в условиях неопределённости в задачу о выборе решения в условиях определённости;
* выбрать вариант, при котором максимизируется средний выигрыш или минимизируется средний риск.

Недостатки:

* крайне сложно достоверно определить вероятность того или иного события.

Критерий Байеса *используется, когда известны вероятности состояния природы.* Например:
* в задачах о принятии решений в условиях риска;
* в задачах о принятии решений в условиях неопределённости.

### Критерий Лапласа

**Критерий Лапласа** — это метод принятия решений в условиях неопределённости, основанный на предположении, что все возможные состояния природы имеют одинаковую вероятность возникновения. Этот принцип исходит из идеи равной вероятности, известной как *принцип недостаточного основания*. Он активно использовался до появления современных статистических методов и часто применялся в ситуациях, когда информация о вероятностях была ограничена или отсутствовала вовсе.

::: info Основное описание критерия Лапласа
Критерий Лапласа базируется на предположении, что каждая альтернатива имеет одинаковые шансы на реализацию. Таким образом, чтобы выбрать оптимальную стратегию, необходимо рассчитать среднее арифметическое выигрышей (или потерь) для каждой стратегии и выбрать ту, которая даст наибольший средний выигрыш (или наименьший средний убыток).
:::

Преимущества:

* *простота расчёта:* не требуется знание вероятностей состояния природы;
* *объективность:* одинаково учитывает все возможные состояния.

Недостатки:

* предположение об одинаковой вероятности состояний может быть нереалистичным в некоторых случаях;
* игнорируются реальные вероятности, что может привести к неоптимальным решениям.

Критерий Лапласа *подходит для ситуаций*, когда отсутствует информация о вероятностях наступления различных состояний природы, либо когда все состояния считаются равновозможными. Например:

* *научные эксперименты:* когда трудно оценить вероятности исходов;
* *бизнес-проекты:* когда нет надёжных данных о рынке;
* *экологическая политика:* когда сложно спрогнозировать погодные условия или воздействие природных факторов.

### Критерий Вальда

**Критерий Вальда** основывается на крайне осторожной, даже пессимистической позиции. Он предполагает, что в любой ситуации может произойти самое плохое событие, и нужно готовиться именно к нему. То есть игрок выбирает такую стратегию, которая минимизирует его потенциальные убытки в самом плохом случае.

::: info Формально это выглядит следующим образом
Пусть у нас есть матрица выигрышей (или потерь), где строки соответствуют различным стратегиям игрока, а столбцы — возможным состояниям природы. Мы ищем стратегию, которая обеспечит максимальное значение среди минимальных значений выигрышей (или минимальных убытков) для каждого возможного состояния природы.
:::

$$
\alpha = \max_i \min_j a_{ij},
$$

$$
\alpha = \max_\bar{x} \min_j \sum_{i=1}^m a_{ij} x_i.
$$

Преимущества:

* критерий позволяет минимизировать риски, обеспечивая гарантированный минимальный уровень выигрыша;
* подходит для ситуаций, где существует высокая степень неопределённости, и важно избегать катастрофического исхода.

Недостатки:

* может привести к излишне консервативному поведению, упуская потенциально большие выигрыши;
* не учитывает вероятность реализации тех или иных состояний природы, что может сделать стратегию неоптимальной в долгосрочной перспективе.

*Критерий Вальда подходит* для случаев, когда важна защита от самого плохого варианта развития событий, например:

* *в экономике:* инвестиционные стратегии с высокой степенью риска;
* *в политике:* подготовка к природным катастрофам или военным конфликтам;
* *в медицине:* лечение пациентов с неизвестным диагнозом, когда нужно избежать летального исхода.

### Критерий Сэвиджа

**Критерий Сэвиджа,** также известный как **критерий минимакса сожалений**, является ещё одним важным инструментом для принятия решений в условиях неопределённости. В отличие от критерия Вальда, который фокусируется на минимизации возможных потерь, критерий Сэвиджа направлен на минимизацию **регрета** — разницы между результатом, который был получен, и лучшим возможным результатом в заданных условиях.

::: info Основная идея
Основная идея критерия Сэвиджа заключается в том, чтобы выбрать такую стратегию, которая минимизирует максимальную величину сожаления (разницу между фактическим результатом и наилучшим возможным результатом) во всех возможных сценариях.
:::

$$
S = \min_i \max_j r_{ij},
$$

$$
S = \min_\bar{x} \max_j \sum_{i=1}^m r_{ij} x_i.
$$

Преимущества:

* учитывает возможность упущенной выгоды, что полезно в ситуациях, где важен не только минимальный ущерб, но и потенциал лучшего исхода;
* позволяет избежать сильного сожаления в будущем, принимая во внимание альтернативные возможности.

Недостатки:

* как и критерий Вальда, не учитывает вероятностную природу событий, что может приводить к избыточной осторожности;
* фокусировка на сожалении может иногда мешать выбору более выгодных стратегий в долгосрочной перспективе.

*Когда использовать:* критерий Сэвиджа хорошо работает в ситуациях, где важно минимизировать последствия неправильного выбора, например:

* инвестиционная деятельность, где надо учитывать потенциальные потери от неверного распределения активов;
* политические решения, где критично избежать крупных ошибок и провалов;
* медицинские исследования, где важна уверенность в правильности выбранного метода лечения.

### Критерий Гурвица

**Критерий Гурвица** — это компромиссный подход к принятию решений в условиях неопределённости, который сочетает в себе элементы как пессимистичного подхода (как в критерии Вальда), так и оптимистичного (как в критерии Лапласа). Его особенность заключается в том, что он учитывает как самые благоприятные, так и самые неблагоприятные исходы, позволяя варьировать степень осторожности или оптимизма.

Критерий Гурвица основан на идее, что игрок выбирает стратегию, ориентируясь одновременно на лучший и худший возможные исходы. Он вводит параметр $\alpha$ (коэффициент оптимизма), который определяет, насколько сильно игрок склоняется к пессимизму или оптимизму. Чем ближе $\alpha$ к нулю, тем больше игрок ориентирован на худший сценарий (пессимизм); чем ближе к единице, тем сильнее он надеется на лучший исход (оптимизм).

Преимущества:

* *гибкость:* позволяет учесть как оптимистичные, так и пессимистичные ожидания;
* *универсальность:* подходит для широкого спектра задач благодаря параметру.

Недостатки:

* *субъективность:* выбор коэффициента зависит от личных предпочтений игрока;
* *отсутствие учёта вероятностей:* как и другие критерии, Гурвиц не учитывает вероятности наступления различных состояний.

Критерий Гурвица полезен в ситуациях, когда нужно сбалансировать осторожность и оптимизм, например:

* *инвестиции:* когда хочется минимизировать риски, но при этом сохранить шанс на высокий доход;
* *бизнес-планирование:* когда важно учитывать как позитивные, так и негативные сценарии развития бизнеса;
* *экологические проекты:* когда необходимо принять меры предосторожности, но оставаться открытыми к положительным результатам.

### Критерий Байеса-Лапласа

**Критерий Байеса-Лапласа** — это расширение классического критерия Лапласа, которое учитывает известные или предполагаемые ероятности различных состояний природы. Вместо того чтобы считать все состояния равновероятными, здесь принимаются во внимание вероятности наступления каждого состояния. Этот критерий основывается на байесовском подходе, который позволяет учитывать дополнительную информацию о мире.

::: info Основная идея критерия Байеса-Лапласа
Основной идеей критерия Байеса-Лапласа является использование вероятностей состояний природы для расчёта ожидаемого выигрыша или ущерба. Это позволяет более реалистично оценивать ситуацию, учитывая различия в вероятности возникновения различных событий.
:::

Преимущества:

* учёт реальных вероятностей позволяет делать более точные прогнозы;
* подходит для ситуаций, где имеется доступ к данным о вероятностях.

Недостатки:

* требуется точное знание вероятностей, что не всегда возможно;
* может давать искажённые результаты, если вероятности оценены неправильно.

*Когда использовать:* критерий Байеса-Лапласа целесообразно применять, когда:

* имеются надёжные данные о вероятностях состояний природы;
* необходимо учитывать неодинаковые вероятности различных исходов;
* важно минимизировать ошибки, вызванные недооценкой редких, но значимых событий.

### Критерий Ходжеса-Лемана

**Критерий Ходжеса-Лемана** — это комбинированный подход к принятию решений в условиях неопределённости, который объединяет элементы критерия Вальда (максимин) и байесовского подхода. Он рассматривает два аспекта: минимизацию максимального риска (как в критерии Вальда) и ожидание выигрыша, исходя из известных вероятностей (как в байесовской модели).

Преимущества:

* компромисс между острожностью и оптимизмом;
* возможность адаптации к конкретной ситуации путём настройки параметра.

Недостатки:

* сложнее в расчёте по сравнению с другими методами;
* требуются данные о вероятностях состояний природы.

*Когда использовать:* критерий Ходжеса-Лемана подходит для ситуаций, когда есть частичная информация о вероятностях, но также важно учитывать риск. Например:

* *инвестиции:* сочетание консервативного подхода с учётом вероятностей рыночной динамики;
* *производственное планирование:* адаптация производственных процессов к изменяющимся условиям рынка.