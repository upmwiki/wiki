---
prev: false
next: false
---

# Линейное программирование

## Постановка задачи линейного программирования

Требуется найти экстремум линейной функции при линейных ограничениях типа равенств и неравенств.

Функция

$$
f(x_1, ..., x_n) = c_1 x_1 + c_2 x_2 + \cdots + c_n x_n \to \text{extr}
$$

называется *целевой функцией*.

$$
\begin{cases}
a_{11} x_1 + a_{12} x_2 + a_{13} x_3 + \cdots + a_{1n} x_n \ge b_1, \\
a_{21} x_1 + a_{22} x_2 + a_{23} x_3 + \cdots + a_{2n} x_n \ge b_2, \\
\cdots \\
a_{m1} x_1 + a_{m2} x_2 + a_{m3} x_3 + \cdots + a_{mn} x_n \ge b_m.
\end{cases}
$$

В матричной форме:

$$
\begin{matrix}
(\bar{c}, \bar{x}) \to \text{extr}, \\
A\bar{x} \ge \bar{b},
\end{matrix}
$$

где
* $\bar{c} = \begin{pmatrix} c_1 & c_2 & \cdots & c_n \end{pmatrix}^T$ — вектор стоимости,
* $\bar{b} = \begin{pmatrix} b_1 & b_2 & \cdots & b_n \end{pmatrix}^T$ — вектор ограничений,
* $\bar{x} = \begin{pmatrix} x_1 & x_2 & \cdots & x_n \end{pmatrix}$,
& $A = (a_{ij})_{m \times n}$ — матрица условий.

## Пример задачи линейного программирования. Графический метод решения

::: info ЗАДАЧА
Фабрика производит два вида лака — для внутренних и наружных работ. Для производства лаков используют материалы $A$ и $B$. Максимально возможные суточные запасы этих материалов — 6 и 8 т соответственно. При производстве 1 т лака для внутренних работ расходуется 1 т продукта $A$ и 2 т продукта $B$, а при производстве 1 т лака для внешних работ расходуется 2 т продукта $A$ и 1 т продукта $B$. Суточный спрос на лак для наружных работ не превышает 2 тонн. Доход от реализации (в у. е.) 1 т лака для внутренних работ равен 3, для внешних — 2. Какое количество лака каждого вида должна производить фирма, чтобы доход от реализации продукции был максимальным?
:::

Для данной задачи система имеет вид

$$
\begin{cases}
3x_1 + 2x_2 \to \max \\
x_1 + 2x_2 \le 6 \\
2x_1 + x_2 \le 8 \\
x_2 \le 2 \\
x_1 \ge 0, ~ ~ x_2 \ge 0
\end{cases}
$$

<!-- 211 -->

## Симплкс-метод решения задач линейного программирования

<!-- 212 -->
### Формы записи задачи линейного программирования

* Нормальная форма:

$$
\begin{cases}
f(x_1, ..., x_n) = \sum_{k=1}^N c_k x_k \to \text{extr}, \\
\sum_{k=1}^N a_{ik} x_k \ge b_i, ~ ~ ~ i = \overline{1, N}, \\
x_k \ge 0, ~ ~ ~ k = \overline{1, N}.
\end{cases}
$$

* Стандартная форма:

$$
\begin{cases}
f(x_1, ..., x_n) = \sum_{i=1}^N c_k x_k \to \text{extr}, \\
\sum_{k=1}^N a_{ik} x_k = b_i, ~ ~ ~ i = \overline{1, L}, \\
x_k \ge 0, ~ ~ ~ k = \overline{1, N}.
\end{cases}
$$

Переход от неравенств к равенствам осуществляется введением дополнительной неотрицательной переменной:

$$
\sum_{i=1}^n a_{ik} x_k \le b_i \longrightarrow \sum_{i=1}^n a_{ik} x_k + y = b_i;
$$

$$
\sum_{i=1}^n a_{ik} x_k \ge b_i \longrightarrow \sum_{i=1}^n a_{ik} x_k - y = b_i.
$$

Равенство эквивалентно двум неравенствам:

$$
\sum_{i=1}^n a_{ik} = b_i \longrightarrow 
\left( \sum_{i=1}^n a_{ik} x_{k} \ge b_i \right)
\cap
\left( \sum_{i=1}^n a_{ik} x_{k} \ge b_i \right).
$$

<!-- 213 -->
### Стандартная форма

$$
\begin{cases}
f(x_1, ..., x_n) = \sum_{k=1}^N c_k x_k \to \text{extr}, \\
\sum_{k=1}^N a_{ik} x_k = b_i, ~ ~ i = \overline{1, L}, \\
x_k \ge 0, ~ ~ ~ k = \overline{1, N}.
\end{cases}
$$

В матричной форме:

$$
\begin{cases}
(\bar{c}, \bar{x}) \to \text{extr}, \\
A\bar{x} = \bar{b}, \\
\bar{x} \ge \bar{0}.
\end{cases}
$$

Число $L$ уравнений этой системы равно рангу её матрицы $A$ и всегда меньше $N$, в противном случае система имеет единственное решение.

*Замечание.* Задачу линейного программирования можно решить геометрически в том случае, если $N - L = 2$. В таком случае можно выразить все неизвестные через 2 произвольные, которым можно придать интерпретацию на плоскости.

<!-- 214 -->
### Выпуклые множества

::: info ОПРЕДЕЛЕНИЕ 1
**Выпуклой комбинацией** векторов $x_k$, $k = \overline{1, m}$, называют линейную комбинацию

$$
\sum_{i=1}^m \lambda_i x_i = \lambda_1 x_1 + \cdots + \lambda_m x_m
$$

этих векторов, коэффициенты $\lambda_i$ которой удовлетворяют условиям

$$
\lambda_k \ge 0, ~ ~ k = \overline{1, m}, ~ ~ \sum_{i=1}^m \lambda_k = 1.
$$
:::

::: info ОПРЕДЕЛЕНИЕ 2
Множество $A$ называется **выпуклым**, если для любых двух точек $a_1$ и $a_2$ из $A$ и любого числа $0 < t < 1$ элемент $ta_1 + (1-t) a_2$ также принадлежит множеству $A$.
:::

<!-- 215 -->
### Характер решения задач линейного программирования

Многомерные линейные функции являются гиперплоскостями, поэтому ограничения в виде таковых формируют выпуклый многогранник.

Так как линии уровня линейной целевой функции являются гиперплоскостями, то оптимальное решение достигается в одной из крайних (угловых) точек.

::: info ОПРЕДЕЛЕНИЕ 3
Точка $d$ выпуклого множества называется **крайней (угловой)**, если не существует несовпадающих точек $a_1$ и $a_2$ из этого множества и чисел $0 < t < 1$ таких, что $d = ta_1 + (1-t) a_2$. У многогранников крайние точки — вершины.
:::

<!-- 216 -->
### Допустимое базисное решение

$$
A\bar{x} = \bar{b}, ~ ~ ~ \text{Rg} ~ A = L < N,
$$

$$
\bar{x} = (x_1, x_2, ..., x_N),
\bar{b} = (b_1, b_2, ..., b_L).
$$

Первые $L$ столбцов матрицы $A$ можно считать базисными, остальные — свободными.

$$
\begin{matrix}
\bar{a}_k = (a_{1k}, ..., a_{Lk})^T, ~ ~ ~ k = \overline{1, N}, \\
A_b = (\bar{a}_1, ..., \bar{a}_L), ~ ~ ~ A_s = (\bar{a}_{L+1}, ..., \bar{a}_N).
\end{matrix}
$$

$$
A_b \bar{x}_b + A_s \bar{x}_s = \bar{b} \implies
$$

$$
\implies \bar{x}_b = A_b^{-1} (\bar{b} - A_s \bar{x}_s) \implies
$$

$$
\implies \bar{x} = \begin{pmatrix}
A_b^{-1} (\bar{b} - A_s \bar{x}_s) \\
\bar{x}_s
\end{pmatrix}
$$

При $\bar{x}_s = 0$ решение называется *базисным*. Если при этом вектор $\bar{x}$ неотрицателен, то *допустимым базисным решением*.

<!-- 217 -->

### Пример построения базисных решений

* Множество допустимых решений:

$$
x_1 + x_2 \le 5, ~ ~ ~ 1.5x_1 + x_2 \le 6, ~ ~ ~ x_1, x_2 \ge 0
$$

* Приводим к стандартной форме:

$$
\begin{array}{l}
x_1 + x_2 + s_1 = 5, \\
x_1, x_2 \ge 0
\end{array} ~ ~ ~
\begin{array}{l}
1.5x_1 + x_2 + s_2 = 6, \\
s_1, s_2 \ge 0
\end{array}
$$

$$
A = (a_1, a_2, a_3, a_4) = \begin{pmatrix}
1 & 1 & 1 & 0 \\
1.5 & 1 & 0 & 1
\end{pmatrix} ~ ~ ~
\bar{b} = \begin{pmatrix} 5 \\ 6 \end{pmatrix}
$$

<!-- 218 -->

### Основные теоремы

::: info ТЕОРЕМА 1
Если множество допустимых решений задачи линейного программирования в стандартной форме не является пустым, то это множество содержит допустимое базисное решение.
:::

:::: info ТЕОРЕМА 2
Множество допустимых решений является выпуклым.

::: info Доказательство
Пусть $\bar{x}_1$ и $\bar{x}_2$ — допустимые решения, т. е. $A\bar{x}_1 = \bar{b}$ и $A\bar{x}_2 = \bar{b}$. Для $0 < \lambda < 1$ имеем

$$
\bar{y} = \lambda \bar{x}_1 + (1 - \lambda) \bar{x}_2 \implies \bar{y} \ge \bar{0}.
$$

$$
\begin{matrix}
A\bar{y} = \lambda A \bar{x}_1 + (1 - \lambda) A \bar{x}_2 = \lambda \bar{b} + (1 - \lambda) \bar{b} = \bar{b} \implies \\
\implies \bar{y} \in \mathbb{Q}.
\end{matrix}
$$
:::

::::

::: info ТЕОРЕМА 3
Допустимые базисные решения задачи линейного программирования в стандартной форме являются крайними точками множества её допустимых решений и наоборот.
:::

<!-- 219 -->
### Сущность симплекс-метода

*Замечание.* Число крайних точек не превышает

$$
C_N^L = { N! \over L! (N - L)! }.
$$

::: info ТЕОРЕМА
Если в некоторой точке множества допустимых решений задачи линейного программирования её целевая функция достигает максимума, то она будет принимать максимальное значение хотя бы в одной крайней точке множества. Если целевая функция достигает максимума в нескольких крайних точках множества допустимых решений, то она достигает максимума и в любой их выпуклой комбинации.
:::

<!-- 221-223 -->
### Оптимальная симплекс-таблица

<!-- 221 -->
| Переменная | $\boldsymbol{x_1}$ | $\boldsymbol{x_2}$ | $\boldsymbol{s_1}$ | $\boldsymbol{s_2}$ | $\boldsymbol{s_3}$ | Значение |
|-|-|-|-|-|-|-|
| $\boldsymbol{z}$ | $-5$ | $-4$ | $0$ | $0$ | $0$ | $0$ |
| $\boldsymbol{s_1}$ | $1$ | $2$ | $1$ | $0$ | $0$ | $20$ (${s_1 \over x_1} = {20 \over 1}$) |
| $\boldsymbol{s_2}$ | $3$ | $1$ | $0$ | $1$ | $0$ | $30$ (${s_2 \over x_1} = {30 \over 3}$) |
| $\boldsymbol{s_3}$ | $0$ | $1$ | $0$ | $0$ | $1$ | $9$ |

$s_1$, $s_2$, $s_3$ — базисные переменные; $x_1$, $x_2$ — небазисные переменные.

В базис вводится переменная, которая имеет наибольшее по модулю значение в целевой функции ($x_1$). Эта переменная называется включаемой, а соответствующий ей столбец — ведущим. Из базиса выводится переменная, которой соответствует наимнеьшее значение при делении "значения" на элемент ведущего столбца ($s_2$).

<!-- 222 -->
| Переменная | $\boldsymbol{x_1}$ | $\boldsymbol{x_2}$ | $\boldsymbol{s_1}$ | $\boldsymbol{s_2}$ | $\boldsymbol{s_3}$ | Значение |
|-|-|-|-|-|-|-|
| $\boldsymbol{z}$ | $0$ | $-{7 \over 3}$ | $0$ | ${5 \over 3}$ | $0$ | $50$ |
| $\boldsymbol{x_2}$ | $0$ | ${5 \over 3}$ | $1$ | $-{1 \over 3}$ | $0$ | $10$ (${s_2 \over x_2} = {30 \over 5}$) |
| $\boldsymbol{x_1}$ | $1$ | ${1 \over 3}$ | $0$ | ${1 \over 3}$ | $0$ | $10$ (${x_1 \over x_2} = {30 \over 1}$) |
| $\boldsymbol{s_3}$ | $0$ | $1$ | $0$ | $0$ | $1$ | $9$ |

$s_1$, $x_1$, $s_3$ — базисные переменные.

В базис вводится переменная, которая имеет наибольшее по модулю значение в целевой функции ($x_2$). Эта переменная называется включаемой, а соовтетствующий ей столбец — ведущим. Из базиса выводится переменная, которой соответствует наименьшее значение при делении "значения" на элемент ведущего столбца ($s_1$).

<!-- 223 -->
| Переменная | $\boldsymbol{x_1}$ | $\boldsymbol{x_2}$ | $\boldsymbol{s_1}$ | $\boldsymbol{s_2}$ | $\boldsymbol{s_3}$ | Значение |
|-|-|-|-|-|-|-|
| $\boldsymbol{z}$ | $0$ | $0$ | ${7 \over 5}$ | ${6 \over 5}$ | $0$ | $64$ |
| $\boldsymbol{x_2}$ | $0$ | $1$ | ${3 \over 5}$ | $-{1 \over 5}$ | $0$ | $6$ |
| $\boldsymbol{x_1}$ | $1$ | $0$ | $-{1 \over 5}$ | ${2 \over 5}$ | $0$ | $8$ |
| $\boldsymbol{s_3}$ | $0$ | $1$ | $-{3 \over 5}$ | ${1 \over 5}$ | $1$ | $3$ |

$s_1$, $x_1$, $s_3$ — базисные переменные.

Требование оптимальности — все коэффициенты в целевой функции положительны.

<!-- 224-225 -->

## Алгоритм решения задачи линейного программирования симплекс-методом

* После математической формулировки задачи линейного программирования осуществляется её приведение к стандартному виду путём записи $z$-уравнения в форме максимизации целевой функции и ограничений в форме неравенств с неотрицательными правыми частями путём введения остаточных и (или) избыточных переменных.
  
  * При наличии только ограничения типа "меньше или равно" в качестве базисных переменных рассматриваются введённые дополнительные переменные.
  
  * При наличии ограничений типа "равно" и (или) "больше или равно" в них, для получения начального решения дополнительно вводятся искусственные переменные *(подробнее об искусственных переменных и особенностях итерационного процесса при их использовании см. ниже)*, рассматриваемые в качестве базисных.

* Формируется начальная симплекс-таблица в стандартной форме, характеризующая начальное допустимое базисное решение.

* Полученная симплекс-таблица проверяется на условие оптимальности, которое утверждает, что если все небазисные переменные в $z$-уравнении имеют неотрицательные коэффициенты, то данная симплекс-таблица представляет собой оптимальное решение.

  * При выполнении условия оптимальности процесс поиска решения исходной задачи завершается.

  * При невыполнении условия оптимальности из неотрицательных коэффициентов при небазисных переменных выбирается наибольший по модулю, положение которого определяет получение ведущего столбца (вводимую в базис переменную) и осуществляется переход к следующему пункту настоящего алгоритма.

* Для определения сиключаемой из базиса переменной проверяется условие допустимости, требующее чтобы исключаемая из базиса переменная первой обращалась в ноль при увеличении включаемой в базис переменной от нуля до значения, соответствующего смежной экстремальной точке. Для проверки условия допустимости в ведущем столбце отыскиваются положительные коэффициенты.

  * Если таковые отсутствуют, то это указывает на неограниченность области допустимых значений переменных вдоль оси включаемой в базис переменной, что, как правило, требует прекращение поиска оптимального решения и изменения исходной формулировки задачи *(подробнее этот вопрос обсуждается ниже)*.

  * При наличии положительных коэффициентов в ведущем столбце находится частное от деления правых частей ограничений на соответствующие им коэффициенты. Минимальное из полученных частных определяет ведущую строку, что обеспечивает возможность перехода к следующему пункту алгоритма.

* Рассчитываются значения коэффициентов новой симплекс-таблицы для очередной итерации.

  * В ячейки новой таблицы, соответствующие ведущей строке, записываются частные от деления коэффициентов ведущей строки на ведущий элемент.

  * В ячейки таблицы, соответствующие ведущему столбцу, записываются нули (за исключением ячейки ведущего элемента, в которую уже занесена единица).

  * Оставшиеся ячейки заполняются значениями, определяемыми по схеме: значение коэффициента в ячейке новой симплекс-таблицы равно значению коэффициента в соответствующей ячейке старой таблицы минус произведение коэффициентов старой таблицы, находящихся на пересечениях ведущих столбца и строки со строкой и столбцом, определяемых положением рассчитываемого элемента, делённое на старый ведущий элемент.

* После заполнения новой симплекс-таблицы осуществляется переход к определению оптимальности настоящего алгоритма.