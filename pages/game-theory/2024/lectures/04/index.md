---
prev:
   text: 3. Существование равновесия в чистых стратегиях. Смешанное расширение игры
   link: ../03
next:
   text: 5. Задача линейного программирования
   link: ../05
---

**Лекция 4**

# Смешанное расширение игры (продолжение)

Мы остановились на том, что начали вводить понтие *смешанной стратегии*, которая применяется во всех случаях, когда у матрицы нет седловой точки. То есть, например, в случае

$$
H = \begin{bmatrix}
7 & 3 \\
2 & 5
\end{bmatrix}
$$

матрица седловой точки не имеет, то есть нет ни одной такой стратегии, которой было бы выгодно придерживаться каждому конкретному игроку.

Тогда в данном случае нужно использовать смешанную стратегию. Если мы посмотрим на эту матрицу: если мы, например, первый игрок и играем первую стратегию, то нам хорошо, если второй игрок играл бы тоже первую стратегию, но он так делать не будет, ему выгоднее выбрать вторую. В то же время если я, как первый игрок, узнаю, что он играет вторую, то я сменю свою стратегию на вторую, и тогда мой выгрыш будет $5$, то есть мне в одностороннем порядке выгодно отклониться. Когда я буду играть вторую стратегию, и второй игрок об этом узнает, то он свою стратегию сменит на первую в одностороннем порядке, и он тогда получить больший выигрыш, чем был до этого. То есть нет такой точки, такой пары стратегий, в которой оба игрока играли бы эту стратегию, и каждому из них невыгодно было бы по одиночке отклониться от неё.

То есть в данном случае мы должны ввести пару стратегий

$$
\begin{matrix}
\bar{x} = [\xi_1, \xi_2], ~ ~ ~ ~ \xi_1 + \xi_2 = 1, \\
\bar{y} = [\eta_1, \eta_2], ~ ~ ~ ~ \eta_1 + \eta_2 = 1,
\end{matrix}
$$

где $x$ — некий вектор, каждое число $\xi_i$ которого отражает вероятность того, что игрок 1 выбирает стратегию $i$. То есть, например, $\xi_1$ — это вероятность того, что первый игрок выбирает стратегию 1. Аналогично для $y$ — вектора, каждое число $\eta_j$ которого отражает вероятность того, что игрок 2 выбирает стратегию $j$.

Из этого следует, что если игрок 1 играет смешанную стратегию $\bar{x} = [\xi_1, \xi_2]$ (т. е. он с вероятностью $\xi_1$ применяет чистую стратегию 1, с вероятностью $\xi_2$ применяет чистую стратегию 2), то, соответственно, тогда мы можем определить чистую стратегию.

Чистая стратегия тогда может быть записана как $\bar{x} = [1, 0]$ — это значит, что первый игрок всегда, с вероятностью $1$ выбирает первую стратегию. Тут никакого распределения нет.

> Говорят, что определённые стратегии входят в спектр стратегий, если вероятность их играть больше нуля, но к этому мы придём позже. Если спектр состоит из одной стратегии, то, значит, это чистая стратегия.

Рассмотрим на примере.

::: info ПРИМЕР
Пусть смешанная стратегия первого игрока $\bar{x} = \left[ {1 \over 3}, {2 \over 3} \right]$, а второго — $\bar{y} = \left[ {1 \over 2}, {1 \over 2} \right]$.

*Т. е. первый игрок с вероятностью ${1 \over 3}$ играет первую стратегию, с вероятностью ${2 \over 3}$ — вторую; второй игрок с вероятностью ${1 \over 2}$ играет как первую, так и вторую стратегию.*

Игра, если что, антагонистическая.

Как тогда посчитать, что за выигрыш? Как выглядит функция выигрыша в данном случае? То есть с матрицей понятно: она описывает, что получается, если мы конкретную стратегию выбираем. А в случае смешанной стратегии тогда что будет?

Поскольку игра антагонистическая, то посчитаем, чему равен средний выигрыш первого игрока.

* То есть $7$ выпадет с вероятностью такой, что если первый игрок выберет первую стратегию и второй игрок выберет первую стратегию. То есть $7$ выпадает в случае, когда два события произошли: первый игрок выбирает первую стратегию с вероятностью ${1 \over 3}$, а второй игрок выбирает первую стратегию с вероятностью ${1 \over 2}$.

  $$
  7 \cdot {1 \over 3} \cdot {1 \over 2}
  $$

* Тройку мы тоже можем получить, когда два события наступят, то есть первый игрок всё ещё выбирает первую стратегию (с вероятностью ${1 \over 3}$), а второй игрок выбирает вторую (с вероятностью ${1 \over 2}$).

  $$
  3 \cdot {1 \over 3} \cdot {1 \over 2}
  $$

* Двойку мы получаем, если первый игрок выбирает вторую стратегию (с вероятностью ${2 \over 3}$), а второй игрок выбирает вторую (с вероятностью ${1 \over 2}$).

  $$
  2 \cdot {2 \over 3} \cdot {1 \over 2}
  $$

* Наконец, мы получаем $5$, если и первый и второй игрок выбирают вторые стратегии (с вероятностями ${2 \over 3}$ и ${1 \over 2}$ соответственно).

  $$
  5 \cdot {2 \over 3} \cdot {1 \over 2}
  $$

Тогда средний выигрыш первого игрока при условии, что оба игрока применяют данные смешанные стратегии для данной матрицы, равен

$$
7 \cdot {1 \over 3} \cdot {1 \over 2} + 3 \cdot {1 \over 3} \cdot {1 \over 2} + 2 \cdot {2 \over 3} \cdot {1 \over 2} + 5 \cdot {2 \over 3} \cdot {1 \over 2} =
$$

$$
= { 7 + 3 + 4 + 10 \over 6 } = { 24 \over 6 } = 4.
$$

Как это можно было бы ещё посчитать? Можно взять вектор $\bar{x}$, умножить его на матрицу $H$ и умножить на транспонированный вектор $\bar{y}$:

$$
\bar{x} \cdot H \cdot \bar{y}^T =
\begin{bmatrix} {1 \over 3} & {2 \over 3} \end{bmatrix}
\begin{bmatrix} 7 & 3 \\ 2 & 5 \end{bmatrix}
\begin{bmatrix} {1 \over 2} \\ {1 \over 2} \end{bmatrix}
=
$$
$$
=
\begin{bmatrix}
{1 \over 3} \cdot 7 + {2 \over 3} \cdot 2 & {1 \over 3} \cdot 3 + {2 \over 3} \cdot 5
\end{bmatrix}

\begin{bmatrix}
{1 \over 2} \\ {1 \over 2}
\end{bmatrix}
=
\begin{bmatrix}
{11 \over 3} & {13 \over 3}
\end{bmatrix}

\begin{bmatrix}
{1 \over 2} \\ {1 \over 2}
\end{bmatrix}
=
$$

$$
=
{11 \over 3} \cdot {1 \over 2} + {13 \over 3} \cdot {1 \over 2}
=
{11 + 13 \over 6}
= {24 \over 6} = 4.
$$
:::

Введём определение.

::: info ОПРЕДЕЛЕНИЕ
Пусть $\bar{x} = [\xi_1, \xi_2, ..., \xi_n] \in X$, где $X$ — множество таких смешанных стратегий $\bar{x} = [\xi_1, \xi_2, ..., \xi_n]$, что $\sum\limits_{i=1}^n \xi_i = 1$. Тогда множество индексов

$$
M_x = \set{ i : i \in M, ~ \xi_i > 0 },
$$

где $M = \set{1, ..., n}$, называется **спектром** стратегий $X$.
:::

Вообще говоря, стратегия состоит из соответствующих вероятностей выбора некой строки (если мы говорим про первого игрока). И если вероятность этого выбора положительна, то тогда этот индекс входит в этот спектр. Если она равна нулю, то в спектре стратегий этой стратегии нет.

Спектр чистой стратегии $j$ состоит из одного элемента $j$.

Всё это аналогично работает для второго игрока.

Пара $(x, y)$ называется **ситуацией** (или **исходом**) игры в смешанных стратегиях, где $x$ и $y$ — смешанные стратегии.

Если мы рассматриваем такую матричную игру, что она характеризуется матрицей

$$
H = \set{ h_{ij} },
$$

где $i = \overline{1,n}$, $j = \overline{1, m}$, то средний выигрыш в этой игре при применении смешанной стратегии $\bar{x} = [\xi_1, ..., \xi_n]$ первым игроком и $\bar{y} = [\eta_1, ..., \eta_n]$ вторым игроком будет определяться выражением

$$
\bar{x} \cdot H \cdot \bar{y}^T = \sum_{j=1}^m \sum_{i=1}^n h_{ij} \xi_i \eta_j,
$$

т. е. вероятность того, что первый игрок выиграет $h_{ij}$, умноженный на вероятность того, что первый игрок выберет стратегию, соответствующую этому элементу и второй тоже выберет стратегию, которая соответствует этому элементу. Другими словами, это математическое ожидание.

Если один из игроков применяет какую-то чистую стратегию, например, первый игрок применяет чистую стратегию $i$, а второй игрок использует "грязную стратегию" $y$, то тогда мы должны суммировать по столбцам (по $j$):

$$
H(i, y) = \sum_{j=1}^m h_{ij} \eta_j,
$$

потому что у нас вероятности использования соответствующих стратегий, которые у нас использует второй игрок, соответствуют выбору столбца, а получается, что первый игрок ничего не выбирает кроме $i$-й строки.

$$
\begin{array}{cl}
0 & \\
\vdots & \\
i: &
\begin{bmatrix}
& h_{i1} & h_{i2} & \cdots & h_{im} &
\end{bmatrix} \\
\vdots & \\
n &
\end{array}
$$

Первый игрок выбирает всё время $i$-ю строку, и тогда вероятность, соответственно, упрощается, если один из игроков использует чистую стратегию.

<!--Ну и, естественным образом, у нас обобщается всё это на ситуацию, когда...-->

Что такое ситуация равновесия в данном случае? То есть если мы сейчас введём обозначение

$$
K(x, y) = x H y^T,
$$

то тогда можно ввести следующее определение.

::: info ОПРЕДЕЛЕНИЕ
**Ситуацией равновесия** в смешанных стратегиях называется ситуация (исход) $(x^*, y^*)$ такая, что

$$
K(x, y^*) \le K(x^*, y^*) \le K(x, y^*).
$$
:::

Раз мы определяем точно так же ситуацию равновесия (только здесь немного другой смысл имеет функция выигрыша), то все теоремы, доказанные ранее, легко обобщаются на эту ситуацию, потому что все рассуждения повторяются.


::: info СЛЕДСТВИЕ (ОБОБЩЕНИЯ)
Если

$$
\forall i, j ~ ~ ~ H_i (y^*)^T \le x^* H (y^*)^T \le x^* H_j,
$$

где $H_i$ — $i$-я строка, $H_j$ — $j$-й столбец, то тогда $(x^*, y^*)$ — седловая точка.
:::

Если вы помните, то смысл теоремы и вообще этого утверждения заключается в том, что это неравенство выполняется для любого $x$ и $y$, то есть получается, что если у нас есть такая ситуация равновесия, то тогда выигрыш, который нам даёт выбор этой пары стратегий, он будет больше или равен любому выигрышу, который будет играться, если игрок 2 выбирает свою смешанную стратегию, а игрок 1 выбирает любую другую, но чистую. И, соответственно, наоборот.

::: info ПРИМЕР
Пусть есть матрица

$$
H = \begin{bmatrix}
1 & -1 & -1 \\
-1 & -1 & 3 \\
-1 & 3 & -1
\end{bmatrix}.
$$

Проверим, что стратегии $x^* = \left[ {1 \over 2}, {1 \over 4}, {1 \over 4} \right]$ и $y^* = \left[ {1 \over 2}, {1 \over 4}, { 1 \over 4} \right]$ являются оптимальными.

Пока мы можем только сказать, что есть такая-то стратегия, которая определяется набором вероятностей, и мы можем проверить, например, удовлетворяет ли она определению выше. А вот сказать, как найти эту стратегию, мы пока не можем.

Сначала преобразуем матрицу, потому что она неудобная, а у нас есть лемма о масштабе. То есть мы можем заменить эту матрицу на эквивалентную, лементы которой умножены на одно и то же число или сложены с одним и тем же числом. Поскольку в матрице $H$ слишком много $-1$, то напрашивается прибавить ко всем элементам $1$. Тогда мы получим:

$$
H \sim \begin{bmatrix}
2 & 0 & 0 \\
0 & 0 & 4 \\
0 & 4 & 0
\end{bmatrix}.
$$

Эта матрица тоже дурацкая, потому что все элементы кратны двум, поэтому давайте умножим её на ${1 \over 2}$. То есть матрица $H$ стратегически эквивалентна следующей матрице:

$$
H \sim \begin{bmatrix}
1 & 0 & 0 \\
0 & 0 & 2 \\
0 & 2 & 0
\end{bmatrix}.
$$

Вот такую матрицу мы можем рассматривать — это уже намного приятнее.

Тут нет ни одного нулевого столбца или нулевой строки, и в спектре стратегий тоже всё представлено. Т. е. если, например, у второго игрока, скажем, на месте какого-нибудь элемента был ноль, то мы могли бы просто этот столбец вообще сразу выкинуть и его не учитывать, потому что его никто никогда не будет выбирать. Но у нас в данном примере такой возможности нет.

Сначала посчитаем выигрыш, который сулит выбор оптимальной стратегии.  Элемент $h_{11} = 1$ игроки 1 и 2 выберут с вероятностями ${1 \over 2}$ и ${1 \over 2}$ соответственно, элемент $h_{23} = 2$ — с вероятностями ${1 \over 4}$ и ${1 \over 4}$ соответственно, элемент $h_{32} = 2$ — с вероятностями ${1 \over 4}$ и ${1 \over 4}$ соответственно:

$$
x^* H (y^*)^T = 1 \cdot {1 \over 2} \cdot {1 \over 2} + 2 \cdot {1 \over 4} \cdot {1 \over 4} + 2 \cdot {1 \over 4} \cdot {1 \over 4} = {1 \over 2}.
$$

А теперь чистые стратегии игроков 1 и 2:

$$
H_1 (y^*)^T =
\begin{bmatrix}
1 & 0 & 0
\end{bmatrix} \cdot
\begin{bmatrix}
1/2 \\ 1/4 \\ 1/4
\end{bmatrix}
= 1 \cdot {1 \over 2}
= {1 \over 2}.
$$

$$
H_2 (y^*)^T =
\begin{bmatrix}
0 & 0 & 2
\end{bmatrix} \cdot
\begin{bmatrix}
1/2 \\ 1/4 \\ 1/4
\end{bmatrix}
= 2 \cdot {1 \over 4} = {1 \over 2}.
$$

$$
H_3 (y^*)^T =
\begin{bmatrix}
0 & 2 & 0
\end{bmatrix} \cdot
\begin{bmatrix}
1/2 \\ 1/4 \\ 1/4
\end{bmatrix}
= 2 \cdot {1 \over 4} = {1 \over 2}.
$$

$$
x^* H_1 =
\begin{bmatrix}
{1 \over 2} & {1 \over 4} & {1 \over 4}
\end{bmatrix} \cdot
\begin{bmatrix}
1 \\ 0 \\ 0
\end{bmatrix}
= {1 \over 2}.
$$

$$
x^* H_2 =
\begin{bmatrix}
{1 \over 2} & {1 \over 4} & {1 \over 4}
\end{bmatrix} \cdot
\begin{bmatrix}
0 \\ 0 \\ 2
\end{bmatrix}
= {1 \over 2}.
$$

$$
x^* H_3 =
\begin{bmatrix}
{1 \over 2} & {1 \over 4} & {1 \over 4}
\end{bmatrix} \cdot
\begin{bmatrix}
0 \\ 2 \\ 0
\end{bmatrix}
= {1 \over 2}.
$$

Таким образом,

$$
\forall i,j ~ ~ ~ {1 \over 2} \le {1 \over 2} \le {1 \over 2},
$$

значит $(x^*, y^*)$ — оптимальная стратегия.
:::

Нам сейчас понадобится понятие выпуклого множества, потому что множество смешанных стратегий является таковым.

::: info ОПРЕДЕЛЕНИЕ
Множество $M \subset \mathbb{R}^n$ называется **выпуклым**, если

$$
\forall x_1, x_2 \in M ~ ~ ~ \forall \lambda: ~ 0 \le \lambda \le 1 ~ ~ ~ \left( \lambda x_1 + (1 - \lambda) x_2 \right) \in M.
$$
:::

Напоминаю, это наглядный смысл имеет такой: если есть выпуклое множество, то тогда вместе с любыми двумя точками $x_1$ и $x_2$ оно содержит также и отрезок, который их соединяет, то есть любая точка на этом отрезке задаётся формулой $\lambda x_1 + (1 - \lambda) x_2$.

С другой стороны, понятно, что если множество невыпуклое, то одна часть точек отрезка между $x_1$ и $x_2$ принадлежит множеству, а другая — не принадлежит.

<div class="figures-flex">
  <figure>
    <img src="/media/images/Convex_polygon_illustration1.svg.png" />
    <figcaption>Выпуклое множество</figcaption>
  </figure>

  <figure>
    <img src="/media/images/Convex_polygon_illustration2.svg.png" />
    <figcaption>Невыпуклое множество</figcaption>
  </figure>
</div>

Для любых элементов $x_1$ и $x_2$ из множества $M$ и для любого $\lambda \in [0, 1]$ элемент $\lambda x_1 + (1 - \lambda) x_2$ тоже содержится в множестве $M$. Тогда $M$ — выпуклое множество.

Данное определение можно обобщить.

::: info ОПРЕДЕЛЕНИЕ (ЭКВИВАЛЕНТНОЕ)
Множество $M$ называется **выпуклым**, если для любого $x_1$, $x_2$, ..., $x_k$ оно содержит элемент

$$
\lambda_1 x_1 + \lambda_2 x_2 + \cdots + \lambda_k x_k,
$$

где $\sum_{i=1}^k \lambda_i = 1$, $\lambda_i \ge 0$.
:::

Теперь рассмотрим систему линейных неравенств вида $x \cdot H \le b$ или, если вместо $H$ ввести множество строк ($H = \left[ h^j, ~ j \in N \right]$), $x \in \mathbb{R}^n$, $b = \left[ \beta_1, ..., \beta_n \right] \in \mathbb{R}^n$, то
$$
xh^j \le \beta_j,
$$

где $j \in N$, $N = \set{ 1, 2, ..., n }$, $H = \set{h_{ij}}_{n \times m}$.

и это тогда просто система линейных неравенств вида

$$
\begin{matrix}
x_1 h_{11} + x_2 h_{12} + \cdots + x_n h_{1m} \le \beta_1, \\
x_1 h_{21} + x_2 h_{22} + \cdots + x_n h_{2m} \le \beta_2, \\
\cdots \\
x_1 h_{n1} + x_2 h_{n2} + \cdots + x_n h_{nm} \le \beta_n.
\end{matrix}
$$

Матрица $H$ в данном случае размера $n \times m$, то есть она не обязательно квадратная.

$\tilde{X}$ — это множество таких $x$, для которых $xA \le b$:

$$
\tilde{X} = \set{ x : xA \le b },
$$

то есть это множество решений системы уравнений выше.

Это множество является выпуклым (по определению), потому что для $x_1 \in \tilde{X}$ и $x_2 \in \tilde{X}$ их сумма с определёнными коэффициентами $(\alpha_1 x_1 + \alpha_2 x_2) \in \tilde{X}$.

::: info ОПРЕДЕЛЕНИЕ
Точка $x \in M$, где $M$ — выпуклое множество, называется **крайней** точкой, если из условия

$$
x = \lambda x_1 + (1 - \lambda) x_2,
$$

где $x_1, x_2 \in M$, $0 < \lambda < 1$ следует, что

$$
x_1 = x_2 = x.
$$
:::

Иными словами, нет такого отрезка, на котором она лежит, а этот отрезок вырождается в точку. Такая точка называется крайней.

А теперь приведём несколько теорем, которые касаются выпуклых множеств (без доказательств).

Пусть $X$ — выпуклое множество, заданное системой $xH \le b$. Тогда:

::: info ТЕОРЕМА 1
Множество $\tilde{X}$ имеет крайние точки тогда и только тогда, когда ранг матрицы $H$ совпадает с рангом системы столбцов:

$$
\text{rank} ~ H = \text{rank} ~ \left[ h^j, ~ j \in N \right] = m.
$$
:::

::: info ТЕОРЕМА 2
Для того, чтобы точка $x_0$ была крайней, необходимо и достаточно, чтобы она была решением системы

$$
\begin{cases}
x_0 h^j = \beta_j, & j \in N_1, \\
x_0 h^j \le \beta_j, & j \in N \backslash N_1,
\end{cases}
$$

где $N_1 \subset N$, $\text{rank} ~ \left[ h^j, ~ j \in N_1 \right] = m$.
:::

Запишем ещё одно определение.

::: info ОПРЕДЕЛЕНИЕ
**Выпуклой оболочкой** $\text{conv}(P)$ множества $P$ называется пересечение всех выпуклых множеств, содержащих $P$.

$$
\text{conv} (P) = \left\{ x : x \in \sum_{i=1}^n \lambda_i x_i, ~ \sum_{i=1}^n \lambda_i = 1, ~ \lambda_i \ge 0, ~ x_i \in P \right\}.
$$
:::

::: info ОПРЕДЕЛЕНИЕ
Выпуклая оболочка конечного числа точек называется **выпуклым многогранником**.
:::