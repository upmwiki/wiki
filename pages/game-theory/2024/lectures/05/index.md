---
prev:
   text: 4. Смешанное расширение игры (продолжение)
   link: ../04
next:
   text: 6. Редукция игры
   link: ../06
---

**Лекция 5**

# Задача линейного программирования

::: info ОПРЕДЕЛЕНИЕ
Задача нахождения минимума $cx^T \to \min$, где $c \in \mathbb{R}^n$, $x \in \mathbb{R}^n \ge 0$, при ограничениях $xA \ge b$, где $b \in \mathbb{R}^n$, $A$ — $(m \times n)$-матрица, называется **прямой задачей линейного программирования**.

В свою очередь, задача $by^T \to \max$, где $y \in \mathbb{R}^n$, при ограничениях $Ay \le c$, где $y \ge 0$, называется **двойственной задачей линейного программирования**.
:::

На этот счёт есть важная теорема.

::: info ТЕОРЕМА (ДВОЙСТВЕННОСТИ)
Если обе задачи (прямая и двойственная) имеют допустимые решения, то они обе имеют оптимальные решения, причём $c\bar{x}^T = b\bar{y}^T$.
:::

Определим, что такое допустимые и оптимальные решения.
* *Допустимые решения* — это такие $x$, что $xA \ge b$ (такие $y$, что $Ay^T \le c$).
* *Оптимальные решения* — это допустимое решение, которое доставляет соответствующий максимум или минимум (по условию задачи).

Данная теорема говорит о том, что если есть какие-нибудь допустимые решения (т. е. если область допустимых решений задачи не пустая), то оптимальное решение есть и у прямой и у двойственной задачи. Мало того, будет соблюдаться соотношение $c\bar{x}^T = b\bar{y}^T$, и это соотношение говорит о том, что оптимальные решения совпадают.

Сформулируем основную теорему сегодняшней встречи, да и целом основную теорему матричных игр.

:::: info ТЕОРЕМА (фон Неймана, основная теорема матричных игр)
Любая матричная игра имеет ситуацию равновесия в смешанных стратегиях.

::: info Доказательство (для двух игроков)

Пусть есть матричная игра $\Gamma_A$ с матрицей $A = \set{a_{ij}}_{m \times n}$, причём $a_{ij} > 0$. Рассмотрим задачу линейного программирования следующего вида:

$$
\begin{matrix}
\min xu: & xA \ge w, & w = [1, ..., 1], \\
\end{matrix}
$$

и двойственную ей задачу

$$
\begin{matrix}
\max yw: & Ay^T \le u, & u = [1, ..., 1].
\end{matrix}
$$

Т. к. $\forall i, j ~ ~ ~ a_{ij} > 0$, то $\exists x : xA \ge w$. С другой стороны, например, $y = \bar{0}$ — это тоже допустимое решение $Ay^T \le u$. Мы этим самым показали, что у обеих задач существует допустимое решение. Это говорит о том, что у них есть и оптимальное решение (по теореме о двойственности).

По теореме о двойственности существуют оптимальные $\bar{x}$, $\bar{y}$ такие, что $\bar{x}u^T = \bar{y}w^T = \theta$, где $\theta$ — некое число. Соответственно, максимальное значение в задаче 2 — оно же минимальное значение в задаче 1.

Покажем, что $x^* = {\bar{x} \over \theta}$ и $y^* = {\bar{y} \over \theta}$ — оптимальные стратегии игроков.

Для начала докажем, что $x^*$ и $y^*$ вообще являются (смешанными) стратегиями. Нам нужно, чтобы все элементы этих векторов были неотрицательными, а также сумма этих элементов должна быть равна единице.

* $x^* u^T = {\bar{x} u^T \over \theta} = \textcolor{gray}{\set{ \bar{x}u^T = \theta }} = {\theta \over \theta} = 1$;
* $y^* w^T = { \bar{y} w \over \theta } = \textcolor{gray}{\set{ \bar{y}w^T = \theta }} = {\theta \over \theta} = 1$.

<!--Иначе это можно представить так:-->
Поскольку $x^* = [\xi_1^*, ..., \xi_n^*]$, то $x^*u^T = \sum\limits_{i=1}^n \xi_i = 1$, $\xi_i \ge 0$. Аналогично для $y^*$ и $y^*w^T$. Это показывает, что $y^*$ и $x^*$ являются смешанными стратегиями игроков, потому что сумма всех вероятностей равна единице и все вероятности неотрицательны. Но это не значит, что $x^*$ и $y^*$ — оптимальные.

Мы показали, что $x^*$ и $y^*$ — смешанные стратегии игроков 1 и 2 соответственно. А выигрыш игрока 1 при паре стратегий $(x^*, y^*)$ (по определению выигрыша) равен

$$
H(x^*, y^*) = x^* A (y^*)^T = {\bar{x} A \bar{y} \over \theta^2}.
$$

Найдём это значение. Посмотрим на равенство $\theta = w\bar{y}^T$ и оценим его. Но по условию $\bar{y}$, поскольку является допустимым решением, то удовлетворяет неравенству:

$$
\theta = w\bar{y} \le (\bar{x}A)\bar{y}^T,
$$

потому что у нас есть условие $xA \ge w$. С другой стороны,

$$
\theta = w\bar{y} \le (\bar{x}A) \bar{y}^T = \bar{x} (A\bar{y}^T),
$$

а, поскольку $A\bar{y}^T \le u$, то

$$
\theta = w\bar{y} \le (\bar{x}A) \bar{y}^T = \bar{x} (A\bar{y}^T) \le \bar{x}u^T = \theta.
$$

Мы получили, что

$$
\theta \le \bar{x}A\bar{y}^T \le \theta,
$$

откуда следует, что $\bar{x}A\bar{y}^T = \theta$.

Стало быть,

$$
H(x^*, y^*) = {\theta \over \theta^2} = {1 \over \theta},
$$

то есть мы нашли выигрыш, который получается, если игроки играют эти стратегии.

Для того, чтобы показать, что это ситуация равновесия, нужно сказать, что есть условие, которому удовлетворяет ситуация равновесия, т. е. что выполняется неравенство $H(x, y^*) \le H(x^*, y^*) \le H(x^*, y)$ для произвольных стратегий $x$ и $y$.

Пусть $x \in X$ и $y \in Y$ — произвольные стратегии игроков 1 и 2 соответственно. Тогда

$$
H(x^*, y) = x^* Ay^T = {\bar{x} A \over \theta} y^T \ge {wy^T \over \theta} = {1 \over \theta} = H(x^*, y^*) \implies
$$
$$
\implies H(x^*, y^*) \le H(x^*, y).
$$

Аналогичным образом,

$$
H(x, y^*) = xA(y^*)^T = {xA\bar{y}^T \over \theta} \le {xu^T \over \theta} = {1 \over \theta} = H(x^*, y^*) \implies
$$
$$
\implies H(x, y^*) \le H(x^*, y^*).
$$

Таким образом,

$$
H(x, y^*) \le H(x^*, y^*) \le H(x^*, y),
$$

следовательно, мы доказали, что это ситуация равновесия.

Осталось последнее. В самом начале мы указали, что матрица $A$ не любая, а строго положительная. Это верно, согласно лемме о масштабе. Если $A'$ — любая, то $\exists \beta: ~ A = A' + B$ — строго положительная, т. е. $a_{ij} > 0$ $~\forall i, j$, где $B = (\beta_{ij})$, $\beta_{ij} = \beta$ $~\forall i, j$, то есть $B$ — это матрица состоящая из одинаковых чисел. Кроме того, цена игры также связаны:

$$
v'_A = v_A - \beta = {1 \over \theta} - \beta.
$$

Теорема доказана.
:::

::::

На самом деле, данное доказательство теоремы довольно конструктивно, т. е. оно даёт **алгоритм нахождения оптимальных решений**. Запишем его:

1. Если матрица ($A'$) не строго положительная (т. е. не все элементы положительные), надо её привести к таковой ($A$).
   
   $$
   A' \to A = A' + B,
   $$

   (см. конец доказательства).

2. Решаем две задачи линейного программирования, находим $\bar{x}$, $\bar{y}$, $\theta$.

3. Объявляем, что $x^* = {\bar{x} \over \theta}$ и $y^* = {\bar{y} \over \theta}$ — оптимальные стратегии.

4. Не забываем, что если в п. 1 был произведён сдвиг, то, соответственно, нужно вернуться к тому, что найденная цена игры — это искомая цена игры со сдвигом, и нужно вернуться к исходной:

   $$
   v'_A = {1 \over \theta} - \beta.
   $$

Рассмотрим пример.

::: info ПРИМЕР
Дана матрица

$$
A' = \begin{bmatrix}
4 & 0 \\
2 & 3
\end{bmatrix}.
$$

Первым делом проверим, есть ли седловая точка. Её здесь нет.

Начнём следовать приведённому выше алгоритму нахождения оптимального решения.

В матрице $A'$ имеется элемент $0$, а, согласно пункту 1, нам нужно, чтобы все элементы были строго положительные, то есть больше нуля. Поэтому произведём сдвиг, добавив ко всем элементам матрицы $A$ по единице:

$$
A = A' + B = \begin{bmatrix} 5 & 1 \\ 3 & 4 \end{bmatrix},
$$

где $B = \begin{bmatrix} 1 & 1 \\ 1 & 1 \end{bmatrix}$.

Тогда прямая задача линейного программирования будет выглядеть так:

$$
\begin{cases}
\xi_1 + \xi_2 \to \min \\
5\xi_1 + 3\xi_2 \ge 1 \\
\xi_1 + 4\xi_2 \ge 1 \\
\xi_1, \xi_2 \ge 0
\end{cases}
$$

Двойственная задача программирования:

$$
\begin{cases}
\eta_1 + \eta_2 \to \max \\
5\eta_1 + \eta_2 \le 1 \\
3\eta_1 + 4\eta_2 \le 1 \\
\eta_1, \eta_2 \ge 0
\end{cases}
$$

Задача с двумя переменными, соответственно, можно решить геометрически. *(Остаётся в качестве упражнения на дом: найти решение этих двух задач линейного программирования.)*
:::

Докажем следующую теорему, которую вводили в одной из предыдущих лекций.

:::: info ТЕОРЕМА
Для того, чтобы ситуация $(x^*, y^*)$ была ситуацией равновесия в игре $\Gamma_A$, а число $v = H(x^*, y^*)$ — ценой игры, необходимо и достаточно, чтобы для любой чистой стратегии из множеств индексов выполнялось

$$
\forall i \in M ~ ~ \forall j \in N ~ ~ ~ ~ H(i, y^*) \le H(x^*, y^*) \le H(x^*, j).
$$

::: info Доказательство
1. *Доказательство необходимости.* Необходимость очевидна. Если $(x^*, y^*)$ — ситуация равновесия, то (по определению)

   $$
   \forall x \in X ~ ~ \forall y \in Y ~ ~ ~ ~ H(x, y^*) \le H(x^*, y^*) \le H(x^*, y).
   $$

   Поскольку это верно $\forall x \in X ~ ~ \forall y \in Y$, то пусть $x = u_i$ — чистая стратегия $i$, а $y = w_j = \left[ 0, ..., 0, 1, 0, ..., 0 \right]$ (на $j$-ом месте единица) — это чистая стратегия, которая является частным случаем смешанной.

2. *Доказательство достаточности.* Пусть $(x^*, y^*)$ такие, что

   $$
   \forall i, j ~ ~ ~ H(i, y^*) \underset{(1)}{\le} H(x^*, y^*) \underset{(2)}{\le} H(x^*, j).
   $$

   Рассмотрим каждую из частей-половин данного неравенства.

   * Рассмотрим (1): $H(i, y^*) \le H(x^*, y^*)$. Умножим неравенство на соответствующие компоненты вектора $x = \left[ \xi_1, ..., \xi_n \right]$, $\sum\limits_{i=1}^n \xi_i = 1$, $\xi_i \ge 0$, т. е. на $\xi_i$:

      $$
      \forall i ~ ~ ~ \xi_i \cdot H(i, y^*) \le \xi_i \cdot H(x^*, y^*).
      $$

      Возьмём и просуммируем для всех $i$:

      $$
      \underbrace{\sum_i \xi_i H(i, y^*)}_{H(x, y^*)} \le H(x^*, y^*) \cdot \underbrace{\sum_i \xi_i}_{1},
      $$
      
      т. е. $H(x, y^*) \le H(x^*, y^*)$.
    
   * Аналогично для (2).

   Таким образом,

   $$
   H(x, y^*) \le H(x^*, y^*) \le H(x^*, y).
   $$

Теорема доказана.
:::

::: info Следствие
Если $(i^*, j^*)$ — ситуация равновесия в игре $\Gamma_A$, то она равновесна и в смешанном расширении игры.
:::

::::

Следующие теоремы также следуют из предыдущей теоремы.

:::: info ТЕОРЕМА 1
Чтобы была ситуация равновесия, необходимо и достаточно, чтобы 

$$
\max_{1 \le i \le m} H(i, y^*) = \min_{1 \le j \le n} H(x^*, j).
$$

::: info Доказательство
*Доказать самостоятельно.*
:::
::::

:::: info ТЕОРЕМА 2
Для матричной игры справедливо:

$$
\max_x \min_j H(x, j) = v_A = \min_y \max_i H(i, y),
$$

причём экстремумы по $x$ и $y$ достигаются на оптимальных стратегиях.

::: info Доказательство
*Доказать самостоятельно.*
:::

::::