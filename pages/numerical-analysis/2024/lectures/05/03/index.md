---
prev:
    text: § 20. Линейные уравнения второго порядка с постоянными коэффициентами
    link: ../02/
next:
    text: Тема 6. Аппроксимация функций
    link: ../../06/intro/
---

**Тема 5. Конечно-разностные уравнения**

# § 21. Линейные уравнения второго порядка с переменными коэффициентами. Метод прогонки

Рассмотрим уравнение следующего вида:

$$
a_n y_{n+1} - b_n y_n + c_n y_{n-1} = f_n,
$$

где $n = \overline{1, N-1}$, с граничными условиями

$$
\begin{matrix}
y_0 = \varkappa_1 y_1 + \mu_1, \\
y_N = \varkappa_2 y_{N-1} + \mu_2.
\end{matrix}
$$

В общем случае данная задача задаётся СЛАУ с трёхдиагональной матрицей:

$$
\left(\begin{matrix}
1 & -\varkappa_1 & & & & 0 & 0 \\
c & -b_1 & a_1 & & & & 0 \\
& \dots & \dots & \dots \\
& & c_i & -b_i & a_i \\
& & & \dots & \dots & \dots \\
0 & & & & c_{N-1} & -b_{N-1} & a_{N-1} \\
0 & 0 & & & & -\varkappa_2 & 1
\end{matrix}\right)
\left(\begin{matrix}
y_0 \\ y_1 \\ \dots \\ \dots \\ \dots \\ y_{N-1} \\ y_N
\end{matrix}\right) =
\left(\begin{matrix}
\mu_1 \\ f_1 \\ \dots \\ \dots \\ \dots \\ f_{N-1} \\ \mu_2
\end{matrix}\right).
$$

Эта СЛАУ имеет матрицу ленточного вида (трёхдиагональную).

Следует отметить, что СЛАУ такого вида очень часто возникают в численных методах и, как правило, имеют большую размерность.

Очевидно, что поскольку в матрице системы подавляющее большинство элементов — нули, обычными методами решать её неэкономично (невыгодно). Поэтому для таких СЛАУ разработан специальный метод — **метод прогонки**.

Перепишем граничные условия так, чтобы они выглядели как общее уравнение системы:

$$
n=0: ~ ~ ~ \underbrace{\varkappa_1}_{a_0} y_1 - \underbrace{1}_{b_0} \cdot y_0 + \underbrace{0}_{c_0} \cdot y_{-1} = \underbrace{-\mu_1}_{f_0};
$$

$$
n = N: ~ ~ ~ \underbrace{0}_{a_N} \cdot y_{N+1} - \underbrace{1}_{b_N} \cdot y_N + \underbrace{\varkappa_2}_{c_N} y_{N-1} = \underbrace{-\mu_2}_{f_N}.
$$

Будем искать решение уравнений в следующем виде:

$$
y_n = \alpha_{n+1} y_{n+1} + \beta_{n+1}, \tag{∗}
$$

где $n = \overline{N-1, 0}$.

Подставив, получим:

$$
a_n y_{n+1} - b_n y_n + c_n (\alpha_n y_n + \beta_n) = f_n,
$$

откуда

$$
y_n (b_n - c_n \alpha_n) = a_n y_{n+1} + c_n \beta_n - f_n.
$$

Таким образом,

$$
y_n = { a_n \over b_n - c_n \alpha_n } y_{n+1} + { c_n \beta_n - f_n \over b_n - c_n \alpha_n }. \tag{∗∗}
$$

Сравним выражения $(∗)$ и $(∗∗)$. Получим:

$$
\alpha_{n+1} = { a_n \over b_n - c_n \alpha_n }, ~ ~ ~
\beta_{n+1} = { c_n \beta_n - f_n \over b_n - c_n \alpha_n },
\tag{∗∗∗}
$$

где $n = \overline{1, N-1}$.

Начальные значения $\alpha_1$ и $\beta_1$ получим из первого граничного условия:

при $n = 0$: $a_0 = \varkappa_1$, $b_0 = 1$, $c_0 = 0$, $f_0 = \mu_1$ $\implies$ $\alpha_1 = \varkappa_1$, $\beta_1 = \mu_1$.

Из второго граничного условия получим:

при $n = N$: $a_N = 0$, $b_N = 1$, $c_N = \varkappa_2$, $f_N = -\mu_2$ $\implies$

$$
\implies y_N = \underbrace{a_N \over b_N - c_N \alpha_N}_{=0} y_{N+1} + \underbrace{ c_N \beta_N - f_N \over b_N - c_N \alpha_N }_{\varkappa_2 \beta_N + \mu_2 \over 1 - \varkappa_2 \alpha_N} \implies
$$

$$
\implies y_N = { \varkappa_2 \beta_N + \mu_2 \over 1 - \varkappa_2 \alpha_N }.
$$

Таким образом, зная $\alpha_1$ и $\beta_1$, мы по формулам $(∗∗∗)$ определяем все $\alpha_n$ и $\beta_n$ (*прямой ход прогонки*). Затем вычисляем $y_N$ по формулам $(∗)$, определяем все $y_n$ (*обратный ход прогонки*).

Очевидно, данный метод эффективен, если он устойчив к вычислительной погрешности.

Будем называть прогонку **корректной**, если знаменатели прогоночных коэффициентов $(∗∗∗)$ не обращаются в нуль, и **устойчивой**, если коэффициенты $\alpha_n$ в формуле $(∗)$ по модулю меньше единицы ($\forall n = \overline{1, N} ~ ~ |\alpha_n| < 1$).

Справедлива следующая теорема.

:::: info Теорема
Пусть $a_n, c_n \ne 0 \forall n = \overline{1, N-1}$, и $|b_n| > |a_n| + c_n| ~ ~ \forall n = \overline{0, N}$ (диагональное преобладание). Тогда прогонка устойчива и корректна.

::: details Доказательство
Воспользуемся методом математической индукции.

Для $n = 0$:

$$
|1| > |\varkappa_1| + |0| \implies |\varkappa_1| < 1 \implies
$$
$$
\implies |\alpha_1| = \left|{ \varkappa_1 \over 1-0 }\right| < 1.
$$

Пусть $\forall k = \overline{1, n-1} ~ ~ ~ b_k - c_k \alpha_k \ne 0$ и $\forall k = \overline{1,n} ~ ~ ~ |\alpha_k| < 1$. Тогда

$$
|b_n - c_n \alpha_n| > |b_n| - |c_n \alpha_n| > |a_n| + |c_n| - |c_n| \cdot |\alpha_n| =
$$
$$
= |a_n| + |c_n| \underbrace{(1 - |\alpha_n|)}_{>0} > |a_n| > 0.
$$

Кроме того,

$$
|\alpha_{n+1}| = \left|{ a_n \over b_n - c_n \alpha_n }\right| = { |a_n| \over |b_n - c_n \alpha_n| } <
$$
$$
< { |a_n| \over |a_n| } = 1.
$$

Корректность и устойчивость доказана.
:::

::::

*Замечание.* Прямой ход метода прогонки соответствует LU-разложению, выполненному для трёхдиагональной матрицы.