---
prev:
    text: § 19. Линейные конечно-разностные уравнения произвольного порядка
    link: ../01/
next:
    text: § 21. Линейные уравнения второго порядка с переменными коэффициентами. Метод прогонки
    link: ../03/
---

**Тема 5. Конечно-разностные уравнения**

# § 20. Линейные уравнения второго порядка с постоянными коэффициентами

Рассмотрим уравнение вида
$$
a_n y_{n+1} + b_n y_n + c_n y_{n-1} = f_n,
$$
где $a_n \ne 0, c_n \ne 0 ~ ~ ~ \forall n$.

Такие уравнения называются **линейными уравнениями второго поряда**.

Если же их коэффициенты не зависят от $n$, т. е.
$$
ay_{n+1} - by_n + cy_{n-1} = f_n,
\tag{∗}
$$
то они называются **линейными уравнениями второго порядка с постоянными коэффициентами**.

Рассмотрим сначала однородное уравнение
$$
ay_{n+1} - by_n + cy_{n+1} = 0. \tag{∗∗}
$$

Будем искать ФСР в виде $y_n = \lambda^n$, $\lambda = \text{const}$:

$$
a\lambda^{n+1} - b\lambda^n + c\lambda^{n-1} = 0.
$$
Тогда
$$
a\lambda^2 - b\lambda + c = 0
$$
называется *характеристическим уравнением*.

Возможны следующие варианты:
1. Корни действительные и различаются ($\lambda = \lambda_1, \lambda = \lambda_2, \lambda_1 \ne \lambda_2$).<br>Тогда ФСР имеет вид:
   $$
   \begin{rcases}
   y_n^{(1)} = \lambda_1^n, \\
   y_n^{(2)} = \lambda_2^n
   \end{rcases} \implies y_n^\text{oo} = C_1\lambda_1^n + C_2\lambda_2^n.
   $$

2. Корни действительные и совпадают ($\lambda_1 = \lambda_2 = \lambda$).<br>
   Тогда $y_n^{(1)} = \lambda^n$, $y_n^{(2)} = n\lambda^n$.

   Покажем, что это действительно так. Подставим это выражение в $(∗∗)$:
   $$
   a(n+1)\lambda^{n+1} - bn\lambda^n + c(n-1)\lambda^{n-1} =
   $$
   $$
   = n\lambda^{n-1} \underbrace{\left( a\lambda^2 - b\lambda + c \right)}_{= 0} + \lambda^{n-1} \left( a\lambda^2 - c \right) =
   $$
   $$
   = \textcolor{gray}{\left\{\begin{matrix}
   D = b^2 - 4ac = 0, \\
   \lambda = -{b \over 2a}
   \end{matrix} \implies D = 4a^2 - \lambda^2 - 4ac = 0 \implies \right.}
   $$
   $$
   \textcolor{gray}{\left.\implies a\lambda^2 - c = 0 \right\}} = 0.
   $$
   Мы убедились, что при подставновке равенство выполняется. Таким образом, $y_n^\text{oo} = C_1\lambda^n + C_2n\lambda^n$.

3. Корни представляют из себя комплексно-сопряжённую пару ($D = b^2 - 4ac < 0$, $\lambda_{1,2} = {b \pm i\sqrt{-D} \over 2a}$).

   Представим это выражение в тригонометрической форме:
   $$
   \lambda_{1,2} = r(\cos i\varphi \pm i\sin\varphi) = re^{\pm i\varphi}.
   $$
   Тогда $y_n^{(1)} = re^{i\varphi}$, $y_n^{(2)} = re^{-i\varphi}$.

   $$
   y_n^\text{oo} = \tilde{C}_1 (re^{i\varphi})^n + \tilde{C}_2 (re^{-i\varphi})^n = \tilde{C}_1 r^n e^{in\varphi} + \tilde{C}_2 r^ne^{-in\varphi} =
   $$
   $$
   = r^n ( \underbrace{(\tilde{C}_1 + \tilde{C}_2)}_{C_1} \cos n\varphi + \underbrace{i(\tilde{C}_1 - \tilde{C}_2)}_{C_2} \sin n\varphi ) \implies
   $$
   $$
   \implies y_{n}^\text{oo} = r^n (C_1 \cos n\varphi + C_2 \sin n\varphi).
   $$

::: info Пример 1
Числа Фибоначчи:
$$ y_{n+1} = y_n + y_{n+1}, ~ ~ ~ y_1 = 1, ~ y_2 = 1. $$
Поставляя известные значения в уравнение, можно легко получить, что:
* $y_3 = y_2 + y_1 = 2$;
* $y_4 = y_3 + y_2 = 3$;
* $y_5 = 5$;
* $y_6 = 0$

и т. д.

Уравнение можно записать так:
$$ y_{n+1} - y_n - y_{n-1} = 0. $$

Мы хотим получить аналитическое решение (т. е. формулу прогрессии) и оценить скорость роста.

Составим характеристическое уравнение, сделав замену $y_n = \lambda^n$:
$$ \lambda^2 - \lambda - 1 = 0. $$
Дискриминант $D = 1 + 4 = 5$, получаются корни вида
$$
\lambda_{1,2} = {1 \pm \sqrt{5} \over 2}.
$$
Таким образом, общее решение имеет вид
$$
y_n^\text{oo} = y_n = C_1 \left( {1 + \sqrt{5} \over 2} \right)^n + C_2 \left( {1 - \sqrt{5} \over 2} \right)^n.
$$

При больших значениях $n$ ($n \to \infty$) значение ${1 - \sqrt{5} \over 2}$ в общем решении стремится к нулю.

Определим входящие в решение константы $C_1$ и $C_2$ через начальное условие:

$$n=1: ~ ~ ~ C_1 \cdot {1 + \sqrt{5} \over 2} + C_2 \cdot {1 - \sqrt{5} \over 2} = 1;$$
$$n=2: ~ ~ ~ C_1 \cdot {1 + 5 + 2\sqrt{5} \over 4} + C_2 \cdot {1 + 5 - 2\sqrt{5} \over 4} = 1$$

$$\begin{cases}
C_1(1 + \sqrt{5}) + C_2(1 - \sqrt{5}) = 2, \\
C_1(3 + \sqrt{5}) + C_2(3 - \sqrt{5}) = 2.
\end{cases}$$

$$\Delta = \left|\begin{matrix}
1 + \sqrt{5} & 1 - \sqrt{5} \\
3 + \sqrt{5} & 3 - \sqrt{5}
\end{matrix}\right| = (1 + \sqrt{5})(3 - \sqrt{5}) - (1 - \sqrt{5})(3 + \sqrt{5}) = 4\sqrt{5};
$$

$$\Delta_1 = \left|\begin{matrix}
2 & 1 - \sqrt{5} \\
2 & 3 - \sqrt{5}
\end{matrix}\right| = 4;
$$

$$\Delta_2 = \left|\begin{matrix}
1 + \sqrt{5} & 2 \\
3 + \sqrt{5} & 2
\end{matrix}\right| = -4.
$$

Таким образом, $C_1 = {\Delta_1 \over \Delta} = {1 \over \sqrt{5}}$ и $C_2 = {\Delta_2 \over \Delta} = -{1 \over \sqrt{5}}$.

Таким образом, это общее решение принимает вид
$$
y_n^\text{oo} = {1 \over \sqrt{5}} \left({1 + \sqrt{5} \over 2}\right)^n - {1 \over \sqrt{5}} \left({1 - \sqrt{5} \over 2}\right)^n.
$$

Для больших $n$ общее решение $y_n \approx {1 \over \sqrt{5}} \left({1 + \sqrt{5} \over 2}\right)^n$.

**Вывод:** для больших $n$ последовательность ведёт себя как геометрическая прогрессия, причём отношение последнего к предыдущему
$$
{y_n \over y_{n+1}} \approx {2 \over 1 + \sqrt{5}} \approx 0,618
$$
представляет из себя золотое сечение.
:::

### Линейные неоднородные уравнения второго порядка с постоянными коэффициентами

**Метод подбора.** В случае, когда $f_n$ представляет из себя обобщённый многочлен, т. е. является функцией вида
$$
f_n = \rho^n (P_{n_1}(n) \cos \varphi n + Q_{n_2}(n) \sin \varphi n),
$$
где $P$ и $Q$ — многочлены степеней $n_1$ и $n_2$, частное решение неоднородного уравнения можно подобрать.

Частное решение неоднородного уравнения следует искать в виде:
$$
y_n^\text{чн} = n^k \rho^n (\tilde{P}_m(n)\cos \varphi n + \tilde{Q}_m (n) \sin \varphi n),
$$
где $m = \max \set{ n_1, n_2 }$, $\tilde{P}$ и $\tilde{Q}$ — многочлены степени $m$, $k = \begin{cases} \text{кратность корня} ~ re^{i\varphi}, & \text{если} ~ re^{i\varphi} = \rho e^{i\alpha}, \\ 0, & \text{в противном случае}. \end{cases}$

Коэффициенты $\tilde{P}$ и $\tilde{Q}$ определяются методом неопределённых коэффициентов после подстановки в уравнение.

::: info Пример 2
Найти общее решение уравнения $y_{n+1} + 2y_n + y_{n-1} = (-1)^n$.

*Решение.*
1. Общее однородное:
   $$ y_{n+1}^\text{oo} + 2y_n^\text{oo} + y_{n-1}^\text{oo} = 0; $$
   $$ \lambda^2 + 2\lambda + 1 = 0; $$
   $$ (\lambda + 1)^2 = 0 $$
   $$ \implies \lambda_1 = \lambda_2 = -1 ~ ~ ~ (k=2) $$
   $$ \implies y_n^\text{oo} = C_1 (-1)^n + C_2 n (-1)^n. $$
2. Частное неоднородное:
   $$ y_{n+1}^\text{чн} + 2y_n^\text{чн} + y_{n-1}^\text{чн} = (-1)^n; $$
   $$ y_n^\text{чн} = An^2 (-1)^n, $$
   где $n^2$ — резонансный множитель.
   $$ A(n+1)^2 \cdot (-1)^{n+1} + 2An^2\cdot(-1)^n + A(n-1)^2 \cdot (-1)^{n-1} = (-1)^n; $$
   $$ -A(n+1)^2 + 2An^2 - A(n-1)^2 = 1; $$
   $$ -A(n^2 + 2n + 1) + 2An^2 - A(n^2 - 2n + 1) = 1 $$
   $$ \implies -A - A = 1 \implies A = -{1 \over 2} $$
   $$ \implies y_n^\text{чн} = -{1 \over 2} n^2 (-1)^n. $$
3. $$ y_n^\text{он} = C_1(-1)^n + C_2n(-1)^n - {1 \over 2}n^2(-1)^n. $$

**Ответ:** $y_n = C_1(-1)^n + C_2n(-1)^n - {1 \over 2}n^2(-1)^n$.
:::

::: info Пример 3
Найти общее решение уравнения $y_{n+1} - 4y_n + 8y_{n-1} = n^2 + 1$.

*Решение.*

1. $$ y_{n+1}^\text{oo} - 4y_n^\text{oo} + 8y_{n-1}^\text{oo} = 0; $$
   $$ \lambda^2 - 4\lambda + 8 = 0; $$
   $$ D = 16 - 32 = -16 < 0 \implies $$
   $$ \implies = \lambda_{1,2} = {4 \pm 4i \over 2} = 2 \pm 2i = 2\sqrt{2}e^{\pm i{\pi \over 4}} $$
   $$ \implies y_n^\text{oo} = (2\sqrt{2})^n \left[ C_1 \cos {\pi n \over 4} + C_2 \sin {\pi n \over 4} \right]. $$

2. $$ y_{n+1}^\text{чн} - 4y_n^\text{чн} + 8y_{n-1}^\text{чн} = n^2 + 1n. $$
   Будем искать в виде $y_n^\text{чн} = An^2 + Bn + C$. Подставляем:
   $$A(n+1)^2 + B(n+1) + C - 4(An^2 + Bn + C) + $$
   $$+ 8(A(n-1)^2 + B(n-1) + C) = n^2 + 1;$$

   $$ n^2: ~ ~ ~ A-4A + 8A = 1 \implies A = {1 \over 5} $$
   $$ n: ~ ~ ~ 2A + B - 4B - 16A + 8B = 0 \implies B = {14 \over 25} $$
   $$ n^0: ~ ~ ~ A + B + C - 4C + 8A - 8B + 8C = 1 \implies C = {79 \over 125} $$

   $$ y_n^\text{чн} = {1 \over 5}n^2 + {14 \over 25}n + {79 \over 125}. $$

3. $$ y_n = (2\sqrt{2})^n \left[ C_1 \cos{\pi n \over 4} + C_2 \sin {\pi n \over 4} \right] + {1 \over 5}n^2 + {14 \over 25}n + {79 \over 125}. $$

**Ответ:** $y_n = (2\sqrt{2})^n \left[ C_1 \cos{\pi n \over 4} + C_2 \sin {\pi n \over 4} \right] + {1 \over 5}n^2 + {14 \over 25}n + {79 \over 125}$.
:::

## Метод вариации произвольного постоянного

Рассмотрим случай, когда функция правой части $f_n$ не является обобщённым многочленом. В этом случае для определения решения можно использовать **метод вариации постоянного**.

Пусть дано уравнение в виде

$$
ay_{n+1} - by_n + c_n y_{n-1} = f_n,
$$

а также $y_n^{(1)}$ и $y_n^{(2)}$ — частные линейно независимые решения однородного уравнения.

Тогда будем искать $y_n$ в виде

$$
y_n = A_n \cdot y_n^{(1)} + B_n \cdot y_n^{(2)},
$$

где $A_n$ и $B_n$ — некоторые пока неизвестные функции.

Поскольку этих функций две, можно потребовать, чтобы они удовлетворяли одному дополнительному условию:

$$
\left( A_{n+1} - A_n \right) y_{n+1}^{(1)} + \left( B_{n+1} - B_n \right) y_{n+1}^{(2)} = 0
$$

или

$$
A_{n+1} y_{n+1}^{(1)} + B_{n+1}y_{n+1}^{(2)} =  A_n y_{n+1}^{(1)} + B_n y_{n+1}^{(2)}.
$$

Подставим данное решение в исходное уравнение:

$$
a\left( A_{n+1} y_{n+1}^{(1)} + B_{n+1} y_{n+1}^{(2)} \right) - b\left( A_n y_n^{(1)} + B_n y_n^{(t)} \right) +
$$
$$
+ c \left( A_{n-1} y_{n-1}^{(1)} + B_{n-1} y_{n-1}^{(1)} \right) = f_n.
$$

В силу дополнительного условия получим:

$$
\tag{∗} \begin{matrix}
a\left( A_n y_{n+1}^{(1)} + B_n y_{n+1}^{(2)} \right) - b\left( A_n y_n^{(1)} + B_n y_n^{(1)} \right) + \\
+ c \left( A_{n-1} y_{n-1}^{(1)} + B_{n-1} y_{n-1}^{(1)} \right) = f_n.
\end{matrix}
$$

Но $y_n^{(1)}$ и $y_n^{(2)}$ — это решения однородного уравнения, поэтому

$$
ay_{n+1}^{(1)} - by_n^{(1)} + cy_{n-1}^{(1)} = 0 \tag{∗∗}
$$

и

$$
ay_{n+1}^{(2)} - by_n^{(2)} + cy_{n-1}^{(2)} = 0. \tag{∗∗∗}
$$

В $(∗)$ сгруппируем коэффициенты при $A_n$ и $B_n$:

$$
A_n \left( ay_{n+1}^{(1)} - by_n^{(1)} \right) +
B_n \left( ay_{n+1}^{(2)} - by_n^{(2)} \right) +
$$
$$
+ c \left( A_{n-1} B_{n-1}^{(1)} + B_{n-1} y_{n-1}^{(2)} \right) = f_n.
$$

Поскольку $(∗∗)$ и $(∗∗∗)$, то

$$
-c \cdot A_n \cdot y_{n-1}^{(1)} - c \cdot B_n \cdot y_{n-1}^{(2)} + c \cdot A_{n-1} \cdot y-{n-1}^{(1)} +
$$
$$
+ c \cdot B_{n-1} \cdot y_{n-1}^{(2)} = f_n.
$$

Выразим $y_{n-1}^{(1)}$ и $y_{n-1}^{(2)}$ и сгруппируем коэффициенты при них:

$$
\left( A_{n-1} - A_n \right) y_{n-1}^{(1)} + \left( B_{n-1} - B_n \right) y_{n-1}^{(2)} = {f_n \over c}, \tag{1}
$$

а если в дополнительном условии поменяем $n$ на $n-1$, то получим:
$$
\left( A_n - A_{n-1} \right) y_n^{(1)} + \left( B_n - B_{n-1} \right) y_n^{(2)} = {f_n \over c}.
\tag{2}
$$

Решим эту систему $(4)-(5)$ через определители, а также обозначим $y_{n-1}^{(1)} y_n^{(2)} - y_n^{(1)} y_{n-1}^{(2)} = \Delta_n$. В результате получим:

$$
A_n - A_{n-1} = -{f_n \over c} { y_n^{(2)} \over \Delta_n };
$$

$$
B_n - B_{n-1} = {f_n \over c} { y_n^{(1)} \over \Delta_n }.
$$

Отсюда, если будем начинать с некоторой $A_0$ (которая, предположительно, известна), получим, что $A_n$ будет суммой:

$$
A_n = \sum_{i=1}^n -{ f_i \cdot y_i^{(2)} \over c \cdot \Delta_i } + A_0.
$$

Аналогично для $B_n$:

$$
B_n = \sum_{i=1}^n { f_i \cdot y_i^{(1)} \over c \cdot \Delta_i } + B_0.
$$

Считая $A_0$ и $B_0$ произвольными константами, получим

$$
y_n = \underbrace{ A_0 y_n^{(1)} + B_0 y_n^{(2)} }_{y_n^\text{oo}} +

\underbrace{ \sum_{i=1}^n \left[ { -f_i \cdot y_i^{(2)} \over c \cdot \Delta_i } y_n^{(1)} + { f_i y_i^{(1)} \over c \cdot \Delta_i } y_n^{(2)} \right] }_{y_n^\text{чн}}.
$$

::: info Замечание
Линейные разностные уравнения с постоянными коэффициентами произвольного порядка решаются так же, как и уравнения второго порядка.
:::

Рассмотрим следующее уравнение произвольного порядка $k+l$:

$$
a_k y_{n+k} + \dots + a_1 y_{n+1} + a_0 y_n + b_1 y_{n-1} + \dots + b_l y_{n-l} = f_n,
$$

где $a_i$, $b_j$ — константы.

Для такого уравнения:

1. характеристическое уравнение:
   $$ a_k \lambda^{k+l} + \dots + b_{l-1} \lambda + b_l = 0. $$
   Тогда $y_n^\text{oo}$ имеет фундаментальную систему решений следующего вида:
   * каждому действительному $\lambda$ кратности $k$ соответствуют функции $y_n^{(1)} = \lambda^n$, $y_n^{(2)} = n \cdot \lambda^n$, $...$, $y_n^{(k)} = n^{k-1} \cdot \lambda^n$;
   * каждой комплексно-сопряжённой паре $\lambda = re^{\pm i\varphi}$ кратности $k$ соответствют пары функций

      $$
      \begin{matrix}
      y_n^{(1,1)} = r^n \cos n \varphi, y_n^{(1,2)} = nr^n \cos n \varphi, \\
      ..., y_n^{(1,k)} = n^{k-1} r^n \cos n \varphi;
      \end{matrix}
      $$
      
      $$
      \begin{matrix}
      y_n^{(2,1)} = r^n \sin n \varphi, y_n^{(2,2)} = nr^n \sin n \varphi, \\
      ..., y_n^{(2,k)} = n^{k-1} r^n \sin n \varphi.
      \end{matrix}
      $$

2. $y_n^\text{чн}$ может быть найден подробом по тем же правилам.

3. $y_n = y_n^\text{oo} + y_n^\text{чн}$.

::: info Пример 1
Решить уравнение второго порядка:
$$
y_{n+2} + 3y_{n+1} + 3y_n + y_{n-1} = 0.
$$

*Решение.* Составим характеристическое уравнение:
$$ \lambda^3 + 3\lambda^2 + 3\lambda + 1 = 0. $$

Легко заметить, что данное уравнение можно записать в виде $(\lambda + 1)^3 = 0$. Таким образом, решением будет корень $\lambda = -1$ (кратности $k=3$).

Таким образом, решение уравнения имеет вид

$$
y_n = C_1 \cdot (-1)^n + C_2 \cdot n \cdot (-1)^n + C_3 \cdot n^2 \cdot (-1)^n.
$$
:::

::: info Пример 2
Решить уравнение четвертого порядка:
$$
y_{n+2} + 4y_n + 4y_{n-1} = 0.
$$

*Решение.* Составим характеристическое уравнение:
$$ \lambda^4 + 4\lambda^2 + 4 = 0. $$

Данное уравнение можно записать в виде $\left(\lambda^2 + 2\right)^2 = 0$. Таким образом, получается две пары комплексно-сопряжённых корней:
$$
\lambda_{1,2} = \pm i\sqrt{2} ~ ~ ~ (k=2)
$$

Представим данные корни в показательной форме:
$$
\lambda_{1,2} = \left\{\begin{matrix} r = |\lambda| = \sqrt{2} \\ \varphi = \pm {\pi \over 2} \end{matrix}\right\} = \sqrt{2} e^{\pm i {\pi \over 2}}.
$$

Таким образом, решение уравнения имеет вид

$$
y_n = (\sqrt{2})^n \left( C_1 \cos {\pi n \over 2} + C_2 \sin {\pi n \over 2} + C_3 \cdot n \cdot \cos {\pi n \over 2} + \right.
$$
$$
\left. + C_4 \cdot n \cdot \sin {\pi n \over 2} \right).
$$
:::

::: info Пример 3
Решить уравнение четвертого порядка:
$$ y_{n+2} - 16y_{n-2} = 0. $$

*Решение.* Составим характеристическое уравнение:
$$ \lambda^4 - 16 = 0. $$

Упростим данное уравнение:
$$ (\lambda^2 - 4)(\lambda^2 + 4) = 0; $$
$$ (\lambda - 2)(\lambda + 2)(\lambda - 2i)(\lambda + 2i) = 0. $$

Получили два действительных корня $\lambda_1 = 2$ и $\lambda_2 = -2$, а также пару комплексно-сопряжённых корней $\lambda_{3,4} = \pm 2i (= 2e^{\pm i {\pi \over 2}})$.

Таким образом, решение уравнения имеет вид

$$
y_n = C_1 \cdot 2^n + C_2 \cdot (-2)^n + 2^n \left( C_3 \cdot \cos {\pi n \over 2} + C_4 \cdot \sin { \pi n \over 2 } \right).
$$
:::

