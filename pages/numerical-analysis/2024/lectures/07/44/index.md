---
prev:
    text: § 43. Применение формул Ньютона-Котеса
    link: ../43/
next:
    text: § 45. Примеры квадратурных формул Гаусса
    link: ../45/
---

**Тема 7. Численное интегрирование**

# § 44. Квадратурные формулы Гаусса

Другой класс квадратурных формул отличается тем, что в них используется один интерполяционный многочлен достаточно высокого поряда, выбираемый из требования, чтобы данная квадратурная формула имела наибольшую степень точности.

> Напомним, что *степенью точности* квадратурной формулы называется наивысший порядок многочлена, для которого эта формула точна ($R = 0$).

Попробуем повысить степень точности квадратурной формулы за счёт правильного выбора узлов интегрирования (интерполирования).

Рассмотрим семейство интегралов вида $\int_a^b p(x) f(x) ~ \text{d}x$, где $p(x)$ — весовая функция, $p(x) \ge 0$. Потребуем, чтобы степень точности была не меньше $2n + 1$, где $n$ — порядок интерполяционного многочлена. Тогда имеется $n + 1$ узел интегрирования $x_i$, $i = \overline{0,n}$.

Тогда интеграл представляется суммой

$$
\int_a^b p(x) f(x) ~ \text{d}x = \sum_{i=1}^n c_i f(x_i) + R,
$$

где $c_i$ — веса, $R$ — остаточный член интегрирования.

По заданному условию $R=0$, если $f(x)$ есть многочлен

$$
f(x) = a_{2n+1} x^{2n+1} + \cdots + a_1 x + a_0.
$$

Тогда

$$
\int_a^b p(x) f(x) ~ \text{d}x
= a_0 \int_a^b p(x) ~ \text{d}x + a_1 \int_a^b x p(x) ~ \text{d}x + ~\!\!
$$

$$
+ \cdots + a_{2n+1} \int_a^b x^{2n+1} p(x) ~ \text{dx} =
$$

$$
= c_0 \sum_{j=0}^{2n+1} a_j x_0^j + c_1 \sum_{j=0}^{2n+1} a_j x_1^j + \cdots + c_n \sum_{j=0}^{2n+1} a_j x_n^j.
$$

Но поскольку многочлен выбирается произвольно, то его коэффициенты также выбираются произвольно, поэтому коэффициенты при них в обеих частях равенства должны совпадать.

$$
\begin{array}{l}
\displaystyle c_0 + c_1 + \cdots + c_n = \int_a^b p(x) ~ \text{d}x; \\
\displaystyle c_0 x_0 + c_1 x_1 + \cdots + c_n x_n = \int_a^b x p(x) ~ \text{d}x; \\
\displaystyle \cdots \\
\displaystyle c_0 x_0^{2n+1} + c_1 x_1^{2n+1} + \cdots + c_n x_n^{2n+1} = \int_a^b x^{2n+1} p(x) ~ \text{d}x.
\end{array}
$$

В этой системе $2n+2$ уравнений, $n+1$ неизвестные $x_i$ и $n+1$ неизвестные $c_i$. Система нелинейна, и сказать что-либо о существовании и единственности её решения пока нельзя.

---

*(Дополнение от 06.05.2025)*

Получаем систему уравнений вида

$$
\begin{cases}
\displaystyle c_0 + c_1 + \cdots + c_n = \int_a^b p(x) ~ \text{d}x; \\
\displaystyle c_0 x_0 + c_1 x_1 + \cdots + c_n x_n = \int_a^b x p(x) ~ \text{d}x; \\
\displaystyle \cdots \\
\displaystyle c_0 x_0^{2n+1} + c_1 x_1^{2n+1} + \cdots + c_n x_n^{2n+1} = \int_a^b x^{2n+1} p(x) ~ \text{d}x.
\end{cases}
$$

Это система относительно $c_i$, $i = \overline{0,n}$ и $x_i$, $i = \overline{0, n}$. Следовательно, получаем $2n + 2$ неизвестных и $2n + 2$ уравнений.

Данная система нелинейная, поэтому неизвестно, существует ли решение, а если существует, то сколько их.

Предположим, что откуда-то все $x_i$ известны. Тогда $c_i$ можно однозначно определить из первых $n + 1$ уравнений, т. к. определитель данной системы имеет вид

$$
\Delta =
\begin{vmatrix}
1 & 1 & \cdots & 1 \\
x_0 & x_1 & \cdots & x_n \\
\vdots & \vdots & \ddots & \vdots \\
x_0^n & x_1^n & \cdots & x_n^n
\end{vmatrix}.
$$

Известно, что $\Delta \ne 0$, если $x_i \ne x_j ~ ~ \forall i,j$.

Другими словами, если откуда-то мы узнали расположение узлов, то веса однозначно определяются из СЛАУ.

Оказывается, что для определения расположения узлов справедлива следующая теорема.

:::: info Теорема
Пусть задан следующий многочлен:

$$
w_{n+1}(x) = (x - x_0)(x - x_1) \cdots (x - x_n).
$$

Тогда для того, чтобы квадратурная формула имела порядок точности $2n + 1$, необходимо и достаточно, чтобы её узлы были корнями многочлена $w_{n+1}(x)$, ортогонального с весом $p(x)$ к любому многочлену степени не выше $n$, т. е. чтобы

$$
\int_a^b p(x) w_{n+1}(x) Q_k(x) ~ \text{d}x = 0,
$$

где $Q_k(x)$ — многочлен, $k = \overline{0, n}$.

::: info Доказательство
1. **Необходимость.** Пусть
   
   $$
   \int_a^b p(x) P_{2n+1}(x) ~ \text{d}x = \sum_{i=0}^n c_i P_{2n+1}(x_i).
   $$

   Требуется доказать, что

   $$
   \int_a^b p(x) w_{n+1}(x) Q_k(x) ~ \text{d}x = 0
   $$

   при $k = \overline{0, n}$.

   Берём $x_i$ в качестве узлов интегрирования.
   
   Произведение $w_{n+1}(x) Q_k(x)$ — многочлен степени, не превосходящей $2n + 1$. Следовательно, можем обозначить

   $$
   w_{n+1}(x) Q_k(x) = P_{2n+1}(x),
   $$

   и интеграл

   $$
   \int_a^b p(x) w_{n+1}(x) Q_k(x) ~ \text{d}x = \sum_{i=1}^n c_i \underbrace{w_{n+1}(x_i)}_{=0} Q_k(x_i) = 0.
   $$

2. **Достаточность.** Пусть

   $$
   \int_a^b p(x) w_{n+1}(x) Q_k(x) ~ \text{d}x = 0
   $$

   для $k = \overline{0, n}$. Требуется доказать, что формула точна для $P_{2n+1}(x)$.

   Берём $f(x) = P_{2n+1}(x)$. Поделим $P_{2n+1}(x)$ на $w_{n+1}(x)$:

   $$
   {P_{2n+1}(x) \over w_{n+1}(x)} = Q_k(x) + {r_n(x) \over w_{n+1}(x)},
   $$

   где $k \le n$. Здесь $Q_k(x)$ — это целая часть, а ${r_n(x) \over w_{n+1}(x)}$ — остаток.

   Следовательно, можем записать, что $P_{2n+1}(x)$ представляется в виде

   $$
   P_{2n+1}(x) = w_{n+1}(x) Q_k(x) + r_n(x).
   $$

   Подставляем этот многочлен в интеграл:

   $$
   \int_a^b p(x) f(x) ~ \text{d}x = \int_a^b p(x) w_{n+1}(x) Q_k(x) ~ \text{d}x + \int_a^b p(x) r_n(x) ~ \text{d}x.
   $$

   По условию первый интеграл равен нулю. Тогда остаётся выражение
   
   $$
   \int_a^b p(x) f(x) ~ \text{d}x = \int_a^b p(x) r_n(x) ~ \text{d}x.
   $$

   $r_n$ — многочлен степени не выше $n$, следовательно, он совпадает со своим интерполяционным многочленов порядка не выше $n$. Тогда формула интеграла:

   $$
   \int_a^b p(x) r_n(x) ~ \text{d}x = c_0 r_n(x_0) + c_1 r_n(x_1) + \cdots + c_n r_n(x_n),
   $$

   т. е. данная квадратурная формула является точной. Т. е.

   $$
   P_{2n+1}(x_i) = \underbrace{w_{n+1}(x_i) Q_k(x_i)}_{=0} + r_n(x_i),
   $$

   следовательно,

   $$
   \int_a^b p(x) P_{2n+1}(x) ~ \text{d}x = \sum_{i=1}^n c_i P_{2n+1}(x_i),
   $$

   т. е. квадратурная формула точна.

Теорема доказана.
:::
::::

**Вывод:** для построения квадратурных формул Гаусса необходимо использовать системы ортогональных многочленов и их корни. *(см. лекцию о системах ортогональных многочленов.)*