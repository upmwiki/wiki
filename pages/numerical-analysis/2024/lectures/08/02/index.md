---
prev:
    text: § 46. Аппроксимация производных. Вывод формул численного дифференцирования
    link: ../01
next:
    text: § 48. Оптимизация выбора шага численного дифференцирования
    link: ../03
---

**Тема 8. Численное дифференцирование**

# § 47. Остаточные члены формул численного дифференцирования

Рассмотрим узел $(x_i, y_i)$ и узлы, соседние с ним.

[image]

Попробуем определить погрешность, возникающую при замене производной на её аппроксимацию.

## Простейшая несимметричная аппроксимация $f'(x)$

Воспользуемся формулой Тейлора для разложения функции в окрестности точки $x = x_i$:

$$
f(x) = f(x_i) + f'(x_i) (x - x_i) + {f''(\xi) \over 2!} (x - x_i)^2.
$$

Выразим производную:

$$
f'(x_i) = {f(x) - f(x_i) \over x - x_i} + {f''(\xi) \over 2!} (x - x_i).
$$

Зафиксируем в этой формуле $x = x_{i-1}$. Отсюда получим, что $\xi$ тоже фиксирована и равна $\xi = \xi_{i-1}$.

Учитывая то, что $x_i - x_{i-1} = h$, получим, что

$$
f'(x_i) = {y_i - y_{i-1} \over h} + {f''(\xi_{i-1}) \over 2} \cdot h,
$$

где первое слагаемое является *аппроксимацией*, а второе — *остаточным членом*.

Аналогично, если зафиксировать $x = x_{i+1}$, то получим, что $\xi = \xi_{i+1}$ и, следовательно,

$$
f'(x_i) = {y_{i+1} - y_i \over h} - {f''(\xi_{i+1}) \over 2} \cdot h,
$$

где первое слагаемое является *аппроксимацией*, а второе — *остаточным членом*.

Таким образом, мы получили формулы левой и правой аппроксимации первой производной. В них $h$ входит в остаточный член в первой степени, то есть, используя приближённые формулы

$$
f'(x_i) \approx {y_{i+1} - y_i \over h}
$$

или

$$
f'(x_i) \approx {y_i - y_{i-1} \over h},
$$

мы совершаем ошибку порядка $O(h)$, то есть эти формулы имеют первый порядок точности.

## Простейшая симметричная аппроксимация $f'(x)$

Рассмотрим формулу Тейлора третьего порядка:

$$
f(x) = f(x_i) + f'(x_i)(x - x_i) + {f''(x_i) \over 2!} (x - x_i)^2 + {f'''(\xi) \over 3!} (x - x_i)^3.
$$

Зафиксируем $x = x_{i+1}$ и $x = x_{i-1}$. Отсюда получим два выражения:

$$
f(x_{i+1}) = f(x_i) + f'(x_i) \cdot h + {f''(x_i) \over 2} \cdot h^2 + {1 \over 6} f'''(\xi_{i+1}) \cdot h^3;
$$

$$
f(x_{i-1}) = f(x_i) - f'(x_i) \cdot h + {f''(x_i) \over 2} \cdot h^2 - {1 \over 6} f'''(\xi_{i-1}) \cdot h^3.
$$

Вычтем из первого равенства второе, получим:

$$
y_{i+1} - y_{i-1} = 2h f'(x_i) + {h^3 \over 6} \left(
    f'''(\xi_{i+1}) + f'''(\xi_{i-1})
\right).
$$

По теореме о среднем, $f'''(\xi_{i+1}) + f'''(\xi_{i-1}) = 2 f'''(\xi_i)$.

Окончательно получим:

$$
f'(x_i) = {y_{i+1} - y_{i-1} \over 2h} - {h^2 \over 6} f'''(\xi_i),
$$

где первое слагаемое является *аппроксимацией*, а второе — *остаточным членом*, $\xi \in (x_{i-1}, x_{i+1})$.

Таким образом, мы видим, что симметричная аппроксимация имеет второй порядок точности.

**Замечание.** Действуя похожим образом, можно вывести несимметричные аппроксимации второго порядка точности:

* левая:
  $$
  f'(x_{i-1}) = {-3y_{i-1} + 4y_i - y_{i+1} \over 2h} + {h^2 \over 3} f'''(\xi_{i-1});
  $$

* правая:
  $$
  f'(x_{x+1}) = {y_{i-1} - 4y_i + 3y_{i+1} \over 2h} + {h^2 \over 3} f'''(\xi_{i+1}).
  $$

**Замечание.** Для того чтобы все формулы были справедливы, необходимо наличие непрерывной производной соответствующего порядка.

## Простейшая аппроксимация производной второго порядка

Рассмотрим формулу Тейлора четвёртой степени:

$$
~ f(x) = f(x_i) + f'(x_i) (x - x_i) + {f''(x_i) \over 2!} (x - x_i)^2 + ~
$$

$$
~ + {f'''(x_i) \over 3!} (x - x_i)^3 + {f^{(4)}(\xi) \over 4!} (x - x_i)^4. ~
$$

Аналогично имеем

$$
~ f(x_{i+1}) = f(x_i) + h \cdot f'(x_i) + {h^2 \over 2} \cdot f''(x_i) + ~
$$

$$
~ + {h^3 \over 6} \cdot f'''(x_i) + {h^4 \over 24} \cdot f^{(4)}(\xi_{i+1}); ~
$$

$$
~ f(x_{i-1}) = f(x_i) - h \cdot f'(x_i) + {h^2 \over 2} \cdot f''(x_i) - ~
$$

$$
~ - {h^3 \over 6} \cdot f'''(x_i) + {h^4 \over 24} \cdot f^{(4)}(\xi_{i-1}). ~
$$

Сложим оба равенства, а также перенесём в левую часть все $f(x)$:

$$
y_{i+1} - 2y_i + y_{i-1} = h^2 f''(x_i) + {h^4 \over 24} \left(
    f^{(4)} (\xi_{i-1}) + f^{(4)} (\xi_{i+1})
\right).
$$
По теореме о среднем, $f^{(4)} (\xi_{i-1}) + f^{(4)} (\xi_{i+1}) = 2 f^{(4)} (\xi_i)$.

Окончательно получим:

$$
f''(x_i) = {y_{i+1} - 2y_i + y_{i-1} \over h^2} - {h^2 \over 12} f^{(4)} (\xi_i).
$$

То есть симметричная аппроксимация второй производной также имеет второй порядок точности.

Можно показать, что несимметричные аппроксимации $f''(x)$ имеют первый порядок точности, поэтому обычно их не используют.