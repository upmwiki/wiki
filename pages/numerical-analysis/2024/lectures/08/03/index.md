---
prev:
    text: § 47. Остаточные члены формул численного дифференцирования
    link: ../02
next: false
    #text: § 42. Формулы Ньютона-Котеса
    #link: ../42
---

**Тема 8. Численное дифференцирование**

# § 48. Оптимизация выбора шага численного дифференцирования

Мы, используя формулу остаточного члена, считаем, что можем получить любую наперёд заданную точность при вычислении производных. Однако оказывается, что надо учитывать дополнительное влияние вычислительной погрешности при выборе шага сетки.

Пусть в данном случае $y_i$ — это приближённое значение $f(x_i)$, полученное с погрешностью округления $\delta > 0$. То есть будем считать, что $f(x_i) \approx y_i \pm \delta$ или $f(x_i) \in (y_i - \delta, y_i + \delta)$.

Рассмотрим простейшую формулу аппроксимации первой производной:

$$
f'(x_i) = {f(x_{i+1}) - f(x_i) \over h} - {h \over 2} \cdot f''(\xi_{i+1}).
$$

Как известно, при вычитании абсолютные погрешности складываются и, заменяя ${f( x_{i+1} ) - f(x_i) \over h}$ на ${y_{i+1} - y_i \over h}$, мы получим абсолютную погрешность ${2 \delta \over h}$.

Оценим остаточный член величиной ${M_2 h \over 2}$, где $M_2 = \max\limits_{x \in [x_i, x_{i+1}]} |f''(x)|$. Тогда погрешность аппроксимации оценивается серху следующим неравенством:

$$
\left|
    f'(x_i) - {y_{i+1} - y_i \over h}
\right| \le {2 \delta \over h} + {M_2 \over 2} \cdot h.
$$

Обозначим $g(h) = {2\delta \over h} + {M_2 \over 2} \cdot h$ и построим график этой функции:

[image]

Таким образом, оценку погрешности нельзя сделать сколь угодно малой, но можно сделать минимальной за счёт выбора шага:

$$
g'(h) = -{2 \delta \over h^2} + {M_2 \over 2} = 0 \implies
$$

$$
\implies h_\min = 2 \sqrt{\delta \over M_2}.
$$

Если рассматривать числа в двоичных разрядах, то можно взять $\delta = 2^{-m}$, где $m$ — длина мантиссы. Считая $M_2 \approx 1$ (величиной порядка единицы), получим

$$
g_\min = {2 \cdot 2^{-m} \over 2 \cdot 2^{-m/2}} + {2 \cdot 2^{-m/2} \over 2} = 2 \cdot 2^{-m/2}.
$$

Этот результат говорит о том, что при простейших аппроксимациях производных происходит потеря точности, составляющая половину значащих цифр числа, поэтому применять данные формулы при вычислениях напрямую надо с осторожностью.

Можно показать, что при применении формулы центральной аппроксимации при тех же предположениях теряется 1/3 значащих разрядов.