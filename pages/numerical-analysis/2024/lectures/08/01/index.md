---
prev:
    text: Тема 8. Численное дифференцирование
    link: ../intro
next:
    text: § 47. Остаточные члены формул численного дифференцирования
    link: ../02
---

**Тема 8. Численное дифференцирование**

# § 46. Аппроксимация производных. Вывод формул численного дифференцирования

Предположим, что функция $y = f(x)$ задана на сетке $x_i = x_0 + ih$, где $i = \overline{0, n}$, $h$ — шаг, $y_i = f(x_i)$. Возникает вопрос: как для такой функции вычислить производную?

Используем тот же подход, что и в численном интегрировании, а именно заменим функцию интерполяционным многочленом. Так как шаг постоянный, используем интерполяционный многочлен Ньютона (вперёд):

$$
t = {x - x_0 \over h};
$$

$$
f(x) \approx P_n \underbrace{(x_0 + th)}_{x} = (∗)
$$

Многочлен записывается через конечные разности:

$$
~ (∗) = x_0 + t \cdot \Delta y_0 + {t(t-1) \over 2} \cdot \Delta^2 y_0 + ~
$$

$$
~ + {t(t-1)(t-2) \over 3!} \cdot \Delta^3 y_0 + \cdots +
{t(t-1) \cdots (t - n + 1) \over n!} \cdot \Delta^n y_0. ~
$$

Возьмём производную:

$$
f'(x) \approx \left( P_n (x_0 + th) \right)'_t \cdot t'_x =
$$

$$
= \underbrace{1 \over h}_{t'_x} \left(
    \Delta y_0 + {2t - 1 \over 2} \cdot \Delta^2 y_0 + {3t^2 - 6t + 2 \over 6} \cdot \Delta^3 y_0 + \cdots
\right).
$$

**Замечание.** Здесь мы вычисляем производную в окрестности точки $x_0$, но в качестве начальной можно использовать любую другую. При этом количество слагаемых, оставляемых в формуле, определяется длиной интервала, в котором мы рассматриваем производную.

::: info Примеры
1. **Линейная интерполяция.** Рассматриваем интервал $x \in (x_0 - \delta, x_1 + \delta)$. Тогда

   $$
   f'(x) \approx {\Delta y_0 \over h},
   $$

   то есть производная не зависит от $x$.

2. **Квадратичная интерполяция.** Будем считать, что $x \in (x_0 - \delta, x_2 + \delta)$, тогда

   $$
   f'(x) \approx {1 \over h} \left(
    \Delta y_0 + {2t - 1 \over 2} \cdot \Delta^2 y_0
   \right).
   $$

3. **Кубическая интерполяция.** Пусть $x \in (x_0 - \delta, x_3 + \delta)$, тогда

   $$
   f'(x) \approx {1 \over h} \left(
    \Delta y_0 + {2t - 1 \over 2} \cdot \Delta^2 y_0 + {3t^2 - 6t + 2 \over 6} \cdot \Delta^3 y_0
   \right).
   $$
:::

На практике обычно требуется вычислять значения производных в тех же самых узлах сетки, то есть получить оценки для $f'(x_i)$ для $i = 0, 1, 2, ...$ .

Используем полученные выше формулы для соответствующих порядков аппроксимации.

* $n = 1$:

  $$
  f'(x_0) \approx {y_1 - y_0 \over h},
  $$

  $$
  f'(x_1) \approx {y_1 - y_0 \over h};
  $$

* $n = 2$:

  $$
  f'(x_0) \approx {-3y_0 + 4y_1 - y_2 \over 2h},
  $$

  $$
  f'(x_1) \approx {y_2 - y_0 \over 2h},
  $$

  $$
  f'(x_2) \approx {y_0 - 4y_1 + 3y_2 \over 2h};
  $$

* $n = 3$:

  $$
  f'(x_0) \approx {1 \over 6h} \left(
    -11 y_0 + 18 y_1 - 9y_2 + 2y_3
  \right),
  $$

  $$
  f'(x_1) \approx {1 \over 6h} \left(
    -2y_0 - 3y_1 + 6y_2 - y_3
  \right),
  $$

  $$
  f'(x_2) \approx {1 \over 6h} \left(
    y_0 - 6y_1 + 3y_2 + 2y_3
  \right),
  $$

  $$
  f'(x_3) \approx {1 \over 6h} \left(
    -2y_0 + 9y_1 - 18y_2 + 11y_3
  \right).
  $$

Аналогично получаются производные более высоких порядков. Например,

$$
f''(x) \approx {1 \over h^2} \left(
    \Delta^2 y_0 + (t-1) \cdot \Delta^3 y_0 + \cdots
\right).
$$

Наиболее часто используемой является **формула квадратичной интерполяции:**

$$
f''(x) \approx {\Delta^2 y_0 \over h},
$$

где $x \in (x_0 - \delta, x_2 + \delta)$, откуда следует **формула центральной аппроксимации:**

$$
f''(x_1) \approx {y_0 - 2y_1 + y_2 \over h^2}.
$$