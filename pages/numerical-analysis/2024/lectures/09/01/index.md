---
prev:
    text: Тема 9. Приближённое решение задачи Коши для обыкновенных дифференциальных уравнений
    link: ../intro
next: false
    #text: § 47. Остаточные члены формул численного дифференцирования
    #link: ../02
---

**Тема 9. Приближённое решение задачи Коши для обыкновенных дифференциальных уравнений**

# § 50. Метод Эйлера

Рассмотрим задачу Коши для одного дифференциального уравнения первого порядка:

$$
\begin{cases}
y' = f(x, y), \\
y(x_0) = y_0.
\end{cases}
$$

Предположим, нам требуется найти его решение в интервале $x \in [a,b]$, где $a = x_0$.

Переходим от интервала к сетке $x_i = x_0 + ih$, где $i = \overline{0, N}$, $h = {b - a \over N}$ — шаг сетки, следовательно, $x_N = b$.

Будем искать решение на сетке $(x_i, y(x_i))$, где вместо точных значений $y(x_i)$ будем брать приближённые значения $y_i$:

$$
y(x_i) \approx y_i.
$$

Воспользуемся формулой аппроксимации производной первого порядка и заменим дифференциальное уравнение на сеточное:

$$
y'(x_i) = {y(x_{i+1}) - y(x_i) \over h} - {y''(\xi_i) \over 2} \cdot h = f(x_i, y_i).
$$

Отсюда следует рекуррентная формула:

$$
y(x_{i+1}) = y(x_i) + h \cdot f(x_i, y_i) + {y''(\xi_i) \over 2} \cdot h^2,
$$

где $i = \overline{1, N}$ (начинаем с 1, т. к. $y(x_0)$ известен).

Если значения функции во всех узлах точны, то отбрасывание остаточного члена приводит к локальной погрешности порядка $O(h^2)$. Отбрасывание остаточного члена во всех уравнениях приводит к глобальной погрешности

$$
\sum_{i=1}^N { |y''(\xi_i)| \over 2 } \cdot h = (*)
$$

которая, по теореме о среднем, представляет из себя следующее:

$$
(*) = {N \over 2} \cdot y''(\xi) \cdot h^2 = {1 \over 2} \cdot \underbrace{b - a \over h}_{N} \cdot y''(\xi) \cdot h^2 = O(h),
$$

где $x_0 \le \xi \le x_n$. То есть глобальная погрешность имеет порядок $h$ в первой степени.

Таким образом, метод Эйлера относится к методам первого порядка точности.

В результате приближённое решение получается по формуле

$$
y_{i+1} = y_i + h \cdot f(x_i, y_i),
$$

где $i = \overline{1,n}$, при условии, что $y_0$ известно.

**Замечание.** Это принятая к рассмотрению оценка точности метода. Однако надо иметь в виду, что шаг от шага начальные условия также вычисляются с погрешностью более высокого порядка, что оказывает влияние на результат.

## Геометрическая интерпретация метода

Легко видеть из рекуррентной формулы, что каждое новое приближённое значение появляется в результате замены графика кривой на график касательной.

<figure>
    <img src="/media/images/IMG_20250912_014202_125.jpg" width="90%" />
</figure>

Из рисунка видно, что ломаная шаг за шагом удаляется от кривой. Однако тот факт, что глобальная погрешность имеет порядок малости $O(h)$, говорит о том, что при $h \to 0$ для всех узлов $y_i \to y(x_i)$, то есть метод Эйлера сходится (его погрешность стремится к нулю).

Этот факт глобальной сходимости можно доказать строго, приняв некоторые дополнительные требования к решению.

<!--::: info Доказательство-->
Рассмотрим в качестве меры отношения величину

$$
\delta_i = y(x_i) - y_i.
$$

Будем считать, что правая часть уравнения и решения обладают достаточной гладкостью, а именно выполняются условия:

$$
\exists C_1, C_2 > 0: ~ ~ |f'_y(x,y)| \le C_1, ~ ~ |y''(x)| \le C_2 ~ ~ \forall x \in [a,b].
$$

Пусть $x = x_{i+1}$. Тогда

$$
\delta_{i+1} = y(x_{i+1}) - y_{i+1} =
$$

$$
= \underbrace{
    y(x_i) + y'(x_i) \cdot h + {1 \over 2} \cdot y''(\xi_i)
}_{\text{по формуле Тейлора}} - \underbrace{
    y_i + h \cdot f(x_i, y_i)
}_{\text{по методу Эйлера}} =
$$

$$
= \delta_i + h \underbrace{\left(
    f(x_i, y(x_i)) - f(x_i, y_i)
\right)}_{\text{по формуле Лагранжа}} + {1 \over 2} \cdot y''(\xi_i) \cdot h^2 =
$$

$$
= \delta_i + h \cdot f'_y (x_i, \mu_i) \cdot \delta_i + {1 \over 2} \cdot y''(\xi_i) \cdot h^2,
$$

где $\mu_i$ — некая промежуточная точка между $y(x_i)$ и $y_i$.

В результате мы имеем конечно-разностное уравнение первого порядка вида

$$
\delta_{i+1} = A_i \delta_i + B_i,
$$

где $A_i = 1 + h \cdot f'_y(x_i, \mu_i)$, $B_i = {1 \over 2} \cdot y''(\xi_i) \cdot h^2$, $i = \overline{0, N-1}$.

Получим следующие оценки:

$$
|\delta_{i+1}| \le A \cdot |\delta_i| + B,
$$

где $A = 1 + C_1h$, $B = {1 \over 2} C_2 h^2$, $i = \overline{0, N-1}$.

Отсюда можно получить последовательность оценок:

$$
|\delta_{i+1}|
\le A \cdot (A \cdot |\delta_{i-1}| + B) + B =
$$

$$
= A^2 \cdot |\delta_{i-1}| + (A + 1) \cdot B
\le A^2 \cdot (A \cdot |\delta_{i-2}| + B) + (A + 1) \cdot B =
$$

$$
= A^3 \cdot |\delta_{i-2}| + (A^2 + A + 1) \cdot B \le \cdots \le
$$

$$
\le A^{i+1} \cdot \underbrace{\delta_0}_{=0} + (A^i + A^{i-1} + \cdots + 1) \cdot B = {A^{i+1} - 1 \over A - 1} \cdot B.
$$

Посмотрим последнее значение: возьмём $i = N-1$. Получим:

$$
|\delta_N|
\le {(1 + C_1 h)^N - 1 \over C_2 h} \cdot {1 \over 2} \cdot C_2 h^2 =
$$

$$
= {C_2 h \over 2 C_1} \cdot \underbrace{
    \left(
        (1 + C_1 h)^N - 1
    \right)
}_{\text{по биному Ньютона}} =
$$

$$
= {C_2 h \over 2 C_1} \cdot (C_1 N h + O(h^2)) = \textcolor{gray}{\left\{ N = {b - a \over h} \right\}} =
$$

$$
= {1 \over 2} \cdot C_2 \cdot (b-a) \cdot h + O(h^2) \xrightarrow[h \to 0]{} 0.
$$

Таким образом, метод Эйлера — действительно метод первого порядка.
<!--:::-->