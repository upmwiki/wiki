---
prev:
    text: § 51. Методы Рунге-Кутта
    link: ../02
next: false
    #text: § 47. Остаточные члены формул численного дифференцирования
    #link: ../02
---

**Тема 9. Приближённое решение задачи Коши для обыкновенных дифференциальных уравнений**

# § 52. Пошаговый контроль точности методов Рунге-Кутта

Порядок точности методов определяется в предположении о степени гладкости решения. Однако заранее эта степень может быть неизвестна. Поэтому для достижения заданной точности решения часто по ходу счёта меняю величину шага сетки $h$.

Для определения величины шага используют [правило Рунге](../../07/43/#правило-рунге). Для этого решение ОДУ производится параллельно на двух сетках с шагом $h$ и ${h \over 2}$.

В результате мы получаем два решения по семейству совпадающих узлов $y_i(h)$ и $y_{2i}\left({h \over 2}\right)$. Для очередного значения $y_{i+1}$ вычисляется поправка Ричардсона:

$$
R_i \left({h \over 2}\right) = {
    y_{2i + 2} \left({h \over 2}\right) - y_{i+1}(h) \over 2^p - 1
},
$$

где $p$ — порядок метода.

Задаём погрешность $\varepsilon > 0$.

* Если $\left|R_i \left({h \over 2}\right)\right| \le \varepsilon$, то считаем, что
  $$
  y(x_{i+1}) \approx y_{2i+2}\left({h \over 2}\right).
  $$

* Если $\left|R_i \left({h \over 2}\right)\right| \> \varepsilon$, то $h := {h \over 2}$ и возвращаемся к $y_i$ (т. е. продолжаем счёт с меньшим шагом).

* Если $\left|R_i \left({h \over 2}\right)\right| \ll \varepsilon$, то $h := 2h$ и двигаемся дальше с бо́льшим шагом.

Наиболее экономным вариантом такой технологии является метод Кутта-Мерсона. Введём

$$
\mu_{1i} = f(x_i, y_i),
$$

$$
\mu_{2i} = f\left(
    x_i + {h \over 3},
    y_i + {h \over 3} \cdot \mu_{1i}
\right),
$$

$$
\mu_{3i} = f\left(
    x_i + {h \over 3},
    y_i + {h \over 6} \cdot \mu_{1i} + {h \over 6} \cdot \mu_{2i}
\right),
$$

$$
\mu_{4i} = f \left(
    x_i + {h \over 2},
    y_i + {h \over 8} \cdot \mu_{1i} + {3h \over 8} \cdot \mu_{2i}
\right),
$$

$$
\mu_{5i} = f \left(
    x_i + h,
    y_i + {h \over 2} \cdot \mu_{1i} - {3h \over 2} \cdot \mu_{3i} + 2h \cdot \mu_{4i}
\right),
$$

$$
\tilde{y}_{i+1} y_i + {h \over 2} \left(
    \mu_{1i} - 3 \mu_{3i} + 4 \mu_{4i}
\right),
$$

$$
y_{i+1} = y_i + {h \over 6} \left(
    \mu_{1i} + 4 \mu_{4i} + \mu_{5i}
\right).
$$

В качестве поправки Ричардсона используется:

$$
R_i = 0,2 \cdot \left|
    y_{i+1} - \tilde{y}_{i+1}
\right|.
$$

* Если $|R_i| \le \varepsilon$, то счёт продолжается с тем же шагом.
* Если $|R_i| > \varepsilon$, то $h := {h \over 2}$ и возвращаются к предыдущему узлу.
* Если $|R_i \ll \varepsilon$, то шаг увеличивают.