---
prev:
    text: § 50. Метод Эйлера
    link: ../01
next:
    text: § 52. Пошаговый контроль точности методов Рунге-Кутта
    link: ../03
---

**Тема 9. Приближённое решение задачи Коши для обыкновенных дифференциальных уравнений**

# § 51. Методы Рунге-Кутта

В исправленном методе Эйлера присутствуют частные производные правой части уравнения. Это вызывает проблему, если, например, $f(x,y)$ не дифференцируема или вообще не является аналитическим выражением (например, получается в результате работы некоторого алгоритма).

Идея методов Рунге-Кутта $p$-го порядка заключается в вычислении по формулам

$$
y_{i+1} = y_i + h \cdot \varphi(x_i, y_i, h),
\tag{∗}
$$

где $\varphi$ — некоторая функция, приближающая отрезок ряда Тейлора до $p$-го порядка и не содержащая частных производных от $f(x,y)$.

Пусть $p = 2$. Будем искать функцию $\varphi$ в виде

$$
\varphi(x,y) = C_1 \cdot f(x,y) + C_2 \cdot f(x + ah, y + bh \cdot f(x,y)),
$$

где константы $C_1$, $C_2$, $a$, $b$ будем подбирать из условий, чтобы формула $(∗)$ определяла метод второго порядка.

Разложим второе слагаемое по формуле Тейлора, ограничиваясь линейными членами:

$$
~ f(x + ah, y + bh \cdot f(x,y)) = f(x,y) + f'_x(x,y) \cdot ah + ~
$$

$$
~ + f'_y(x,y) \cdot bh \cdot y' + O(h^2). ~
$$

Тогда в формуле $(∗)$ получим (учитывая, что $y' = f(x,y)$):

$$
~ y_{i+1} = y_i + h \left[
    (C_1 + C_2) \cdot f(x_i, y_i) + h \left(
        C_2 a \cdot f'_x(x_i, y_i) + ~
    \right.
\right.
$$

$$
\left.
    \left.
        ~ + C_2 b \cdot f'_y(x_i, y_i) \cdot f(x_i, y_i)
    \right)
\right] + O(h^3). ~
$$

Сравним это выражение с выражением для исправленного метода Эйлера: приравняем коэффициенты при одинаковых членах. Получим систему:

$$
\begin{cases}
C_1 + C_2 = 1, \\
C_2 \cdot a = 0,5, \\
C_2 \cdot b = 0,5.
\end{cases}
$$

Обозначим $C_2 = \alpha \ne 0$, откуда

$$
C_1 = 1 - \alpha,
~~~~
a = {1 \over 2 \alpha},
~ ~ ~ ~
b = {1 \over 2 \alpha}.
$$

В результате получаем однопараметрическое семейство методов Рунге-Кутта второго порядка:

$$
y_{i+1} = y_i + h \left[
    (1 - \alpha) \cdot f(x_i, y_i) + \alpha \cdot f\left(
        x_i + {h \over 2\alpha}, y_i + {h \over 2\alpha} \cdot f(x_i, y_i)
    \right)
\right].
$$

Параметр $\alpha$ можно выбрать из дополнительных условий, наложенных на функцию $f(x,y)$. Наиболее часто используются случаи:

* $\alpha = {1 \over 2}$, тогда **метод Хойна:**

  $$
  y_{i+1} = y_i + {h \over 2} \left[
    f(x_i, y_i) + f(x_i + h, y_i + h \cdot f(x_i, y_i))
  \right];
  $$
* $\alpha = 1$, тогда **метод средней точки:**

  $$
  y_{i+1} = y_i + h \cdot f\left(
    x_i + {h \over 2}, y_i + {h \over 2} \cdot f(x_i, y_i)
  \right).
  $$

Аналогичным образом можно получить формулы Рунге-Кутта других порядков точности. Наиболее распространённым из них является метод Рунге-Кутта четвёртого порядка, опрделяемый следующими формулами: обозначим

$$
\mu_{1i} = f(x_i, y_i),
$$

$$
\mu_{2i} = f\left(
    x_i + {h \over 2}, y_i + {h \over 2} \cdot \mu_{1i}
\right),
$$

$$
\mu_{3i} = f\left(
    x_i + {h \over 2}, y_i + {h \over 2} \cdot \mu_{2i}
\right),
$$

$$
\mu_{4i} = f\left(
    x_i + {h \over 2}, y_i + {h \over 2} \cdot \mu_{3i}
\right),
$$

тогда

$$
\Delta y_i = {h \over 6} \left(
    \mu_{1i} + 2 \mu_{2i} + 2 \mu_{3i} + \mu_{4i}
\right)
$$

и окончательно

$$
y_{i+1} = y_i + \Delta_i.
$$

Т. к. промежуточные значения $f(x,y)$ вычисляются в четырёх точках, то метод называется **четырёхэтапным**.

**Замечание.** Сказанное в этих двух параграфах относилось к одному уравнению:

$$
\begin{cases}
y' = f(x,y), \\
y(x_0) = y_0.
\end{cases}
$$

Можно показать, что ничего не меняется при переходе к систме, где переменными являются векторы:

$$
\begin{cases}
\bar{y}' = f(x, \bar{y}), \\
\bar{y}(x_0) = \bar{y}_0.
\end{cases}
$$

Соответствующим образом преобразуются формулы для приближённых методов.