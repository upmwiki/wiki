---
prev:
    text: § 54. Аппроксимация, устойчивость и сходимость разностных схем
    link: ../02
next:
    text: § 56. Метод сеток решения уравнений в частных производных гиперболического типа
    link: ../04
---

**Тема 10. Метод сеток решения краевых задач**

# § 55. Метод конечных разностей решения ОДУ второго порядка

Рассмотрим краевую задачу

$$
y'' + p(x) \cdot y' + q(x) \cdot y = f(x), ~ ~ ~ ~ x \in [a, b]
$$

с граничными условиями

$$
\begin{cases}
\alpha_1 \cdot y(a) + \beta_1 \cdot y'(a) = A, \\
\alpha_2 \cdot y(b) + \beta_2 \cdot y'(b) = B.
\end{cases}
$$

Это так называемая *смешанная задача*.

* Если $\beta_1 = \beta_2 = 0$, то это задача Дирихле.
* Если $\alpha_1 = \alpha_2 = 0$, то это задача Неймана.

Введём сетку $x_i = a + ih$, где $i = \overline{0, N}$, $h = {b - a \over N}$ — шаг сетки. Также введём обозначения:

$$
p_i = p(x_i), ~ ~ ~ ~ q_i = q(x_i), ~ ~ ~ ~ f_i = f(x_i).
$$

Будем приближённо считать, что $y_i \approx y(x_i)$.

Произведём замену входящих в задачу производных на их конечно-разностные аппроксимации:

$$
y'(x_i)
= {y(x_{i+1}) - y(x_{i-1}) \over 2h} + O(h^2) \approx
{y_{i+1} - y_{i-1} \over 2h};
$$

$$
y''(x_i)
= { y(x_{i+1}) - 2 y(x_i) + y(x_{i-1}) \over h^2 } + O(h^2) \approx
$$

$$
\approx { y_{i+1} - 2 y_i + y_{i-1} \over h^2 }.
$$

В результате замены получим конечно-разностное уравнение:

$$
{ y_{i+1} - 2y_i + y_{i-1} \over h^2 } + p_i \cdot { y_{i+1} - y_{i-1} \over 2h } + q_i \cdot y_i = f_i.
$$

Домножив на знаменатель и перегруппировав, получим уравнение следующего вида:

$$
\left(
    1 + {h \over 2} \cdot p_i
\right) \cdot y_{i+1}
- \left(
    2 - h^2 q_i
\right) \cdot y_i
+ \left(
    1 - {h \over 2} \cdot p_i
\right) \cdot y_{i-1} = f_i \cdot h^2,
$$

где $i = \overline{1, N-1}$.

Таким образом, аппроксимация данного уравнения имеет порядок $O(h^2)$. Кроме того, необходимо аппроксимировать граничные условия.

В данном случае производная не допускает центральной аппроксимации, так как вычисляется в граничных точках интервала. Поэтому имеем

$$
\begin{cases}
\displaystyle \alpha_1 \cdot y_0 + \beta_1 \cdot {y_1 - y_0 \over h} = A, \\
\displaystyle \alpha_2 \cdot y_N + \beta_2 \cdot {y_N - y_{N-1} \over h} = B
\end{cases}
$$

или

$$
\begin{cases}
\beta_1 y_1 + (\alpha_1 h - \beta_1) \cdot y_0 = Ah, \\
(\beta_2 + \alpha_2 h) \cdot y_N - \beta_2 y_{N-1} = Bh,
\end{cases}
$$

при этом граничные условия имеют порядок аппроксимации $O(h)$, а значит, этот порядок имеет вся задача. Это приводит к замедлению сходимости.

Воспользуемся несимметричными аппроксимациями производной второго порядка:

$$
\begin{cases}
\displaystyle \alpha_1 y_0 + \beta_1 \cdot { -3y_0 + 4y_1 - y_2 \over 2h } = A, \\
\displaystyle \alpha_2 y_N + \beta_2 \cdot { y_{N-2} - 4y_{N-1} + 3y_N \over 2h } = B.
\end{cases}
$$

В результате получим

$$
\begin{cases}
-\beta_1 y_2 + 4 \beta_1 y_1 + (2 \alpha_1 h - 3 \beta_1) \cdot y_0 = 2Ah, \\
(2 \alpha_2 h + 3 \beta_2) \cdot y_N - 4 \beta_2 y_{N-1} + \beta_2 y_{N-2} = 2Bh.
\end{cases}
$$

Данная аппроксимация граничных условий имеет порядок $O(h^2)$. Этот же порядок имеет вся задача.

В обоих случаях задача сводится к решению [конечно-разностного уравнения второго порядка](../../05/intro/). Оно осуществляется [методом прогонки](../../05/03/), который должен быть устойчивым.

Рассмотрим устойчивость метода прогонки для данной задачи. В данном случае устойчивость разностной системы есть устойчивость метода прогонки.

Достаточным условием устойчивости метода является условие диагонального преобладания:

$$
\left| 2 - h^2 q_i \right| >
\left| 1 + {h \over 2} \cdot p_i \right| +
\left| 1 - {h \over 2} \cdot p_i \right|,
\tag{∗}
$$

где $i = \overline{1, N-1}$.

Рассмотрим сумму в правой части:

$$
\left| 1 + {h \over 2} \cdot p_i \right| +
\left| 1 - {h \over 2} \cdot p_i \right| =
\begin{cases}
- h p_i, & h p_i < -2, \\
2, & |hp_i| < 2, \\
hp_i, & hp_i > 2.
\end{cases}
$$

<figure>
    <img src="/media/images/IMG_20250926_023314_719.jpg" width="60%" />
</figure>

Очевидно, что данное неравенство может выполняться только если $q(x) < 0 ~ ~ \forall x$. Тогда

$$
\left| 2 - h^2 q_i \right| = 2 - h^2 q_i > 2 ~ ~ ~ ~ \forall h.
$$

В результате неравенство $(∗)$ будет выполнено при любых $h$, если $|h p_i| \le 2 ~ ~  \forall i = \overline{1, N-1}$.

$$
|h p_i| \le 2 \iff h \le {2 \over |p_i|} ~ ~ ~ ~ \forall i = \overline{1, N - 1}.
$$

Таким образом, достаточным условием устойчивости разностной схемы, а следовательно, её сходимости будет требование

$$
q(x) < 0 ~ ~ \forall x \in [a,b] ~~~~~~ \text{и} ~~~~~~ h \le {2 \over \max\limits_{x \in [a,b]} |p(x)|}.
$$