---
prev:
    text: § 37. Сплайны 1-го и 3-го порядка
    link: ../16/
next:
    text: § 39. Дискретное преобразование Фурье для периодической функции
    link: ../18/
---

**Тема 6. Аппроксимация функций**

# § 17. Базисные сплайны

В случае предыдущих способов аппроксимации функции рассматривалось их приближение некоторым обобщённым многочленом. Сплайн же вроде бы представляет принципиально другую схему приближения. Тем не менее оказывается, что и сплайн любого порядка может быть представлен таким же образом.

Рассмотрим линейный сплайн на отрезке $x \in [a; b]$,

$$
a = x_0 < x_1 < \cdots < x_{n-1} < x_n = b,
$$

$$
y_i = f(x_i), ~ ~ i = \overline{0, n}.
$$

Как было показано, сплайн 1-го порядка на элементарном участке $x \in [x_i; x_{i+1}]$ представляется линейной функцией следующего вида:

$$
s(x) = s_i(x) = { x_{i+1} - x \over x_{i+1} - x_i } y_i + { x - x_i \over x_{i+1} - x_i } y_{i+1},
$$

где $i = \overline{0, n - 1}$.

Рассмотрим отдельно две функции:

$$
w_i^{(1)} = { x_{i+1} - x \over x_{i+1} - x_i }, ~ ~ ~ ~
w_i^{(2)} = { x - x_i \over x_{i+1} - x_i }.
$$

Легко показать, что $w_i^{(1)} (x_i) = 1 = w_{i+1}^{(2)} (x_{i+1})$; $w_i^{(1)} (x_{i+1}) = 0 = w_{i+1}^{(2)} (x_i)$.

[image]

С другой стороны, сплайн на $[a;b]$ представляет собой звено ломаной линии.

[image]

Построим по такой системе функций базис в соответствующем пространстве.

Возьмём функцию

$$
\varphi_0 (x) =
\begin{cases}
{x_1 - x \over x_1 - x_0} = \omega_0^{(1)} (x), & x_0 \le x \le x_1, \\
0, & x_1 \le x \le x_n.
\end{cases}
$$

[image]

В общем случае

$$
\varphi_i (x) =
\begin{cases}
0, & x_0 \le x \le x_{i-1}, \\
{x - x_{i-1} \over x_i - x_{i-1}} = \omega_i^{(2)} (x), & x_{i-1} \le x \le x_i, \\
{x_{i-1} - x \over x_{i-1} - x_i} = \omega_i^{(1)} (x), & x_i \le x \le x_{i+1}, \\
0, & x_{i+1} \le x \le x_n.
\end{cases}
$$

[image]

$$
\varphi_n(x) =
\begin{cases}
0, & x_0 \le x \le x_{n-1}, \\
{x - x_{n-1} \over x_n - x_{n-1}} = \omega_n^{(2)} (x), & x_{n-1} \le x \le x_n.
\end{cases}
$$

[image]

Как видно из построения, обобщённый многочлен по данной функции будет полностью совпадать со сплайном 1-го порядка:

$$
\Phi(x) = \sum_{i=1}^n a_i \varphi_i(x),
$$

причём если $\Phi(x_i) = y_i$, то $a_i = y_i$.

## Базисные сплайны

В случае, когда система узлов представляет из себя сетку с постоянным шагом (т. е. $x_i = a + ih$), можно использовать в качестве сплайна функции единой структуры, которые называются **базисными сплайнами** или **B-spline**.

Как для сплайна 1-го порядка, используются функции $B_i$ вида

$$
B_1(x) =
\begin{cases}
1 - |x|, & |x| \le 1, \\
0, & |x| \ge 1.
\end{cases}
$$

[image]

$$
\Phi(x) = \sum_{i=0}^n a_i B_i \left( {x - x_i \over h} \right).
$$

Если $\Phi(x_i) = y_i$, то $a_i = y_i$.

Аналогично строится B-сплайн 3-го порядка по базисным функциям следующего вида:

$$
B_3(x) =
\begin{cases}
{ (2 - |x|)^3 \over 6 }, & 1 \le |x| \le 2, \\
{2 \over 3} - x^2 + {|x|^3 \over 2}, & |x| \le 1, \\
0, & |x| \ge 2.
\end{cases}
$$

[image]

Два соседних сплайна отличны от нуля в трёх общих интервалах, поэтому они используют дополнительные узлы, в которых он доопределяется из граничных условий.

Для определения коэффициентов сплайна требуется решить СЛАУ с ленточной матрицей.