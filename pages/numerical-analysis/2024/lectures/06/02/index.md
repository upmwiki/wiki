---
prev:
    text: § 22. Постановка задачи интерполяции
    link: ../01/
next:
    text: § 24. Интерполяционный многочлен Ньютона
    link: ../03/
---

**Тема 6. Аппроксимация функций**

# § 23. Интерполяционный многочлен Лагранжа

Пусть имеется функция $y = f(x)$, $x \in [a; b]$. Возьмём систему узлов $\set{x_i}$ из этого же интервала (узлы не совпадают, т. е. $x_i \ne x_j ~ ~ \forall i \ne j$).

$$
\varphi_i(x) = x^i, ~ ~ ~ i = \overline{0, n} \implies
$$

$$
\implies \varphi(x) = a_0 + a_1 x + a_2 x^2 + \dots + a_n x^n.
$$

Как было показано, эта система функций является системой Чебышева, следовательно, интерполяционный многочлен существует и единственен. Попробуем подобрать его по внешним признакам. Будем искать $\varphi(x)$ в виде

$$
\varphi(x) = \sum_{i=0}^n f(x_i) \Phi_i(x),
$$

где $\Phi_i(x)$ — многочлены степени $n$, удовлетворяющие следующим требованиям:

$$
\Phi_i (x_j) = \begin{cases}
0, & i \ne j, \\
1, & i = j.
\end{cases}
$$

Тогда очевидно, что $\forall j ~ ~ ~ \varphi(x_j) = f(x_j)$. Но тогда

$$
\Phi_i(x) = A_i \cdot (x-x_0) (x-x_1) \dots (x - x_{i-1}) (x-x_{i+1}) \dots (x - x_n).
$$

Подставим $x = x_i$:

$$
\Phi_i(x_i) = A_i \cdot (x_i-x_0) (x_i - x_1) \dots (x_i - x_{i-1}) (x - x_{i+1}) \dots (x_i - x_n) = 1.
$$

Т. к. $A_i = {1 \over (x_i-x_0) (x_i - x_1) \dots (x_i - x_{i-1}) (x - x_{i+1}) \dots (x_i - x_n)}$, окончательно получим

$$
\varphi(x) = L_n(x) =
$$

$$
= \sum_{i=0}^n f(x_i) { (x-x_0) (x-x_1) \dots (x - x_{i-1}) (x-x_{i+1}) \dots (x - x_n) \over (x_i-x_0) (x_i - x_1) \dots (x_i - x_{i-1}) (x - x_{i+1}) \dots (x_i - x_n) }.
$$

Данный многочлен называется **интерполяционным многочленом в форме Лагранжа**.

::: info Пример
Построим параболу по трём узлам. Например, выберем три следующих:

| $x_i$ | $-1$ | $0$ | $1$ |
|-|-|-|-|
| $y_i$ | $0$ | $1$ | $4$ |

Тогда

$$
L_2(x) = \underbrace{0}_{y_1} \cdot { (x-0)(x-1) \over (-1-0)(-1-1) } - \underbrace{1}_{y_2} \cdot { (x-(-1))(x-1) \over (0-(-1))(0-1) } +
$$

$$
+ 4 \cdot { (x-(-1))(x-0) \over (1-(-1)) (1-0) } =
{ (x+1)(x-1) \over 1 \cdot (-1) } + 4 \cdot { (x+1)x \over 2 \cdot 1 } = 
$$

$$
= -(x+1)(x-1) + 2x(x+1) = -(x^2-1) + 2(x^2 + x) =
$$

$$
= x^2 + 2x + 1 = (x+1)^2.
$$

Проверка:
* $x = 0$: $(0 + 1)^2 = 1^2 = 1$;
* $x = -1$: $(-1 + 1)^2 = 0^2 = 0$;
* $x = 1$: $(1 + 1)^2 = 2^2 = 4$.
:::

## Формула остаточного члена

Очевидно, что если интерполяционный многочлен строится по данному набору узлов, то в некоторой их окрестности функции и многочлены будут близки. Однако сказать, как сильно отличаются функции и многочлены в других точках, заранее нельзя.

<figure>
    <img src="/media/images/IMG_20250521_222649_219.jpg" width="75%" />
</figure>

($L_n(x)$ — многочлен Лагранжа)

Чтобы оценить поведение многочлена между узлами, рассмотрим разность

$$
R_n(x) = f(x) - L_n(x),
$$

которую назовём **остаточным членом интерполирования**.

Попробуем получить для неё аналитическое выражение. Пусть $f(x)$ непрерывна и $n+1$ раз дифференцируема на отрезке $[a;b]$. Введём следующую функцию:

$$
\varphi(z) = f(z) - L_n(z) = K(z - x_0)(z - x_1) \dots (z - x_n),
$$

где $x_0, ..., x_n$ — узлы интерполирования, $K$ — константа (по переменной $z$), $z$ — некоторая переменная, $z \in [a; b]$.

Значение $K$ выберем из условия $\varphi(x) = 0$. Следовательно,

$$
f(x) - L_n(x) - K(x - x_0)(x - x_1)\dots(x - x_n) = 0.
$$

Тогда $K$ равняется

$$
K = {f(x) - L_n(x) \over w(x)},
$$

где $w(x) = (x-x_0)\dots(x-x_n)$.

Тогда $\varphi(z) = 0$ при $z=x$ и $z = x_i$, $i = \overline{0,n}$.

Следовательно, $\varphi(z)$ имеет по крайней мере $n+2$ нуля на $[a;b]$.

Из первого семестра математического анализа известна *теорема Ролля*:

::: info ТЕОРЕМА РОЛЛЯ
Пусть функция $f(x)$ непрерывна на отрезке $[a;b]$ и дифференцируема внутри него. Если она принимает на краях отрезка одинаковые значения (т. е. $f(a) = f(b)$), то внутри отрезка всегда существует точка $\xi$ такая, что $f(\xi) = 0$.
:::

В нашем случае $\varphi'(z)$ имеет $n+1$ нуль. Соответственно, $\varphi''(z)$ имеет $n$ нулей, и т. д. Таким образом, $\varphi^{(n+1)}(z)$ имеет 1 нуль, т. е.
$$
\exists z = \xi: ~ \varphi^{(n+1)}(\xi) = 0, ~ ~ ~ \xi \in [a;b].
$$

$$
\varphi(z) = f(z) - L_n(z) - K(z-x_0)(z-x_1)\dots(z-x_n)
$$

$$
\implies \varphi^{(n+1)}(z) = f^{(n+1)}(z) + 0 - K(n+1)! = f^{(n+1)} - K(n+1)!.
$$

Т. к. $\varphi^{(n+1)}(\xi) = 0$, то $f^{(n+1)}(\xi) - K(n+1)! = 0$, откуда
$$
K = { f^{(n+1)}(\xi) \over (n+1)! }.
$$

Мы уже получили, что, с другой стороны,

$$
K = {f(x) - L_n(x) \over w(x)},
$$

следовательно,

$$
R_n(x) = f(x) - L_n(x) = { f^{(n+1)}(\xi) \over (n+1)! } (x-x_0)(x-x_1)\dots(x-x_n),
$$

где $\xi \in [a;b]$.

Последнее выражение называется **формулой остаточного члена для интерполяционного многочлена Лагранжа**.

::: info ЗАМЕЧАНИЕ
Напрямую данной формулой пользоваться нельзя, поэтому вместо неё используют оценку

$$
|R_n(x)| \le { M_{n+1} \over (n+1)! } |(x-x_0)\dots(x-x_n)|,
$$

где $M_{n+1} = \max |f^{(n+1)}(x)|$ на $x \in [a;b]$.
:::

::: info ПРИМЕР
Построить многочлен Лагранжа второго порядка для функции $f(x) = \sin x$ по следующщим узлам:
| $\boldsymbol{x_i}$ | $\boldsymbol{0}$ | $\boldsymbol{\pi/6}$ | $\boldsymbol{\pi/2}$ |
|-|-|-|-|
| $\boldsymbol{y_i}$ | $0$ | $1/2$ | $1$ |

Найти $L_2(\pi/3)$, оценить погрешность интегрирования.

*Решение.* Сначала посчитаем сам многочлен по формуле
$$
L_n(x) = \sum_{i=1}^n f(x_i) { (x-x_0)(x-x_1)\dots(x-x_{i-1})(x-x_{i+1})\dots(x-x_n) \over (x_i-x_0)(x_i-x_1)\dots(x_i-x_{i-1})(x_i-x_{i+1})\dots(x_i-x_n) }.
$$

Поскольку $n=2$, получаем
$$
L_2(x) = 0 \cdot { (x-\pi/6)(x-\pi/2) \over (0-\pi/6)(0-\pi/2) } + {1 \over 2} \cdot { (x-0)(x-\pi/2) \over (\pi/6-0)(\pi/6-\pi/2) } +
$$
$$
+ 1 \cdot { (x-0)(x-\pi/6) \over (\pi/2-0)(\pi/2-\pi/6) } = {1 \over 2} { x(x-\pi/2) \over \pi/6(\pi/6-\pi/2) } + { x(x-\pi/6) \over \pi/2 (\pi/2-\pi/6) } =
$$
$$
= \dots = {x \over \pi^2} \left(-3 + {7 \over 2}\pi\right).
$$

Найдём $L_2(\pi/2)$:

$$
L_2(\pi/3) = {1 \over 3\pi}\left( -\pi + {7 \over 2} \pi \right) = {1 \over 3\pi} \cdot {5 \over 2}\pi = {5 \over 6} = 8,833...
$$

Мы знаем, что $\sin {\pi/3} = \sqrt{3}/2 \approx 8,666$.

Видно, что $R_2(x) \approx 0,03$.

Попробуем посчитать остаточный член $R_2(x)$ через оценку:

$$
|R_2(x)| \le { \max\limits_{x \in [0; \pi/2]} |f'''(x)| \over 3! } \cdot \left| x(x-\pi/6)(x-\pi/2) \right| =
$$
$$
= { \max\limits_{x\in[0;\pi/2]} |-\cos x| \over 6 } \cdot |x(x-\pi/6)(x-\pi/2)|.
$$

$$
\left|R_2\left({\pi \over 3}\right)\right| \le {1 \over 6} \cdot \left| {\pi \over 3} \left({\pi \over 3}-{\pi \over 6}\right) \left( {\pi \over 3} - {\pi \over 2} \right) \right| = {\pi^3 \over 640} \approx 0,048.
$$
:::

**Замечание:** можно показать, что рост числа узлов не всегда повышает точность интерполирования.