---
prev:
    text: § 14. Системы ортогональных многочленов
    link: ../14/
next:
    text: § 16. Сплайны 1-го и 3-го порядка
    link: ../16/
---

**Тема 6. Аппроксимация функций**

# § 15. Сплайны. Происхождение и общая постановка задач

С давних пор перед чертёжниками стояла задача: как провести через набор заданных точек достаточно плавную кривую? На практике обычно поступали так: в заданной точке забивались гвозди, на которые клали длинную упругую планку (рейку). Под влиянием упругих сил она принимала нужную форму, обеспечивающую минимум потенциальной энергии деформации. Отсюда в математику пришло название **сплайн** (spline), т. е. "упругая планка".

Рассмотрим систему узлов на отрезке $[a; b]$:

$$
a < x_0 < x_1 < \cdots < x_{n-1} < x_n = b
$$

и заданную на нём функцию

$$
y = f(x) \implies y_k = f(x_k) ~ ~ ~ k = \overline{0, n}
$$

Пусть функция $s(x)$ удовлетворяет следующим условиям:

1. На каждом элементарном участке она является многочленом третьего порядка, т. е.
   
   $$
   s(x) = s_k(x) = a_k + b_k (x - x_k) + c_k (x - x_k)^2 + d_k (x - x_k)^3
   $$

   при $x \in [x_{k-1}, x_k]$, $k = \overline{1,n}$.

2. $s(x_k) = y_k$, т. е. совпадение с функцией в узлах.

3. $s(x) \in C^2 [a;b]$ (функция непрерывна и дважды дифференцируема на $[a;b]$).

4. $s''(a) = s''(b) = 0$ $-$ граничное условие.

![](/media/images/numerical_analysis_2_15.jpg)

Можно показать, что такая функция на самом деле представляет чертёжный сплайн, т. к. на ней достигается мнимум потенциальной энергии

$$
J(s) = \int_a^b \left(s''(x)\right)^2 ~ \text{d}x.
$$

Рассмотрим функционал $J(f-s)$:

$$
J(f - s) = \int_a^b \left( f''(x) - s''(x) \right)^2 ~ \text{d}x =
$$

$$
= J(f) + J(s) - 2 \int_a^b f''(x) s''(x) ~ \text{d}x = (∗)
$$

Если прибавим и вычтем $2J(s)$, то получим

$$
(∗) = J(f) - J(s) - 2 \int_a^b \left( f''(x) - s''(x) \right) s''(x) ~ \text{d}x = (∗∗)
$$

Возьмём данный интеграл по частям:

$$
(∗∗) = J(f) - J(s) - 2 \underbrace{ \left. \left( f'(x) - s'(x) \right) s''(x) \right|_a^b }_{=0} +
$$

$$
+ 2 \int_a^b \left( f'(x) - s'(x) \right) s'''(x) ~ \text{d}x =
$$

$$
= J(f) - J(s) + 2 \sum_{k=1}^n \int_{x_{k-1}}^{x_k} \left( f'(x) - s'(x) \right) \underbrace{s'''(x)}_{=b} ~ \text{d}x =
$$

$$
= J(f) - J(s) + 12 \sum_{k=1}^n \underbrace{\left( f(x_k) - s(x_k) \right)}_{=0} = J(f) - J(s).
$$

Таким образом,

$$
J(f - s) = J(f) - J(s) \implies J(s) = J(f) - \underbrace{J(f-s)}_{\ge 0} \implies
$$

$\implies J(s) \le J(f)$, т. е. на сплайне действительно достигается минимум функционала.

*Вывод:* этот пример показывает возможный способ аппроксимации функций функциями специального вида.

---

Пусть функция $y = f(x)$ на отрезке $x \in [a;b]$ задана системой узлов:

$$
a = x_0 < x_1 < \cdots < x_{n-1} < x_n = b,
$$

$y_i = f(x_i)$.

::: info Определение
**Сплайном порядка $\boldsymbol{k}$** на сетке $\set{x_i}_{i = \overline{0,n}}$ называется функция $s_k(x)$, обалдающая свойствами:

1. на каждом элементарном интервале $[x_{i-1};x_i]$ $s_k$ совпадает с многочленом порядка $k$ (обозначим $s_{k,i}(x)$).
2. $s_k(x) \in C^{k-1} [a;b]$, т. е. непрерывна вместе с производными до $(k-1)$-го порядка включительно.
3. $s_k(x_i) = y_i$, $i = \overline{0,n}$.
:::

Таким образом, имеется $n$ интервалов, в которых каждый многочлен имеет $k + 1$ неизвестных коэффициентов, т. е. всего неизвестных $n (k + 1)$.

Условие 2 задаёт систему уравнений вида

$$
s^{(l)}_{k,i} (x_i) = s^{(l)}_{k,i+1} (x-i),
$$

где $i = \overline{1,n-1}$, $l = \overline{0, k-1}$. Следовательно, имеем $(n-1)k$ уравнений.

Из пункта 3 получается $(n+1)$ уравнений.

$$
n(k+1) - (n-1)k - (n+1) = nk + n - nk + k - n - 1 = k - 1.
$$

То есть для полного определения параметров сплайна необходимо ещё $k - 1$ дополнительное условие. Поэтому систему обычно дополняют граничными условиями (в предыдущем примере их два).

В общем случае задача отыскания сплайна тесно связана с теорией пространств Соболева и следующей задачей, которую можно назвать **основной задачей теории сплайнов**.

Пусть задана система узлов $a = x_0 < x_1 < \cdots x_{n-1} < x_n = b$ и требуется найти функцию $s(x)$ такую, что $s(x_i) = y_i$, $i = \overline{0,n}$, и $\int_a^b \left( s^{(l-1)}(x) \right)^2 ~ \text{d}x$ достигает минимального значения. Оказывается, что решением этой задачи является сплайн, о чём говорят следующие теоремы.

::: info Теорема 1
При $n \ge l - 2$ решение задачи существует и единственно.
:::

::: info Теорема 2
На каждом элементарном интервале $[x_{i-1}, x_i]$, $i = \overline{1,n}$ решение задачи совпадает с полиномом порядка $2l - 3$.
:::

::: info Теорема 3
$s(x)$ непрерывна и имеет непрерывные производные до порядка $2l - 4$ включительно.
:::

::: info Теорема 4
$s(x)$ удовлетворяет граничным условиям

$$
s^{(l - 2 + m)}(a) = s^{(l - 2 + m)}(b) = 0,
$$

$m = \overline{1, l-2}$.
:::