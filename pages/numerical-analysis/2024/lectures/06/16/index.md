---
prev:
    text: § 15. § 15. Сплайны. Происхождение и общая постановка задач
    link: ../15/
next:
    text: § 17. Базисные сплайны
    link: ../17/
---

**Тема 6. Аппроксимация функций**

# § 16. Сплайны 1-го и 3-го порядка

Согласно представленным в прошлом параграфе теоремам, получим:

## Сплайны 1-го порядка

Есть параметр $l$, определяемый из уравнения

$$
2l - 3 = 1 \implies l = 2 \implies \int_a^b \left( s'(x) \right)^2 ~ \text{d}x \to \min
$$

Ещё одна теорема говорит о гладкости функционала: $2l - 4 = 0 \implies$ сплайн только непрерывен.

На каждом элементарном участке он совпадает с многочленом первого порядка и дополнительных граничных условий не имеет.

Таким образом, графиком сплайна является ломаная линия

<div style="margin: 0 auto; width: 75%">

![](/media/images/numerical_analysis_2_16.jpg)

</div>

где

$$
s(x) = s_{i+1}(x) = {y_{i+1} - y_i \over x_{i+1} - x_i} (x - x_i) + y_i,
$$

$i = \overline{0, n-1}$.

Такой сплайн легко построить, но он недостаточно гладкий.

## Сплайны 3-го порядка

Согласно теоремам,

$$
2l - 3 = 3 \implies l = 3 \implies \int_a^b \left( s''(x) \right)^2 ~ \text{d}x \to \min
$$

На каждом элементарном интервале сплайн совпадает с многочленом третьего порядка (кубическая парабола).

Граничные условия:

$$
k = l - 2 = 1 \implies s^{(3 - 2 + 1)} = s'' \implies
$$

$$
\implies s''(x_0) = s''(x_n) = 0,
$$

где $x_0 = a$, $x_n = b$.

Обозначим $s''(x_i) = M_i$, $i = \overline{0,n}$.

**Замечание.** Очевидно, что $s''(x)$ на каждом элементарном участке есть многочлен первого порядка. $s''(x)$ дважды дифференцируем, следовательно, $s(x)$ непрерывен. Таким образом, $s''(x)$ является сплайном 1-го порядка, принимающим в узлах заданные значения. Следовательно,

$$
s''(x) = { M_{i+1} - M_i \over x_{i+1} - x_i } (x - x_i) + M_i,
$$

где $x \in [x_i; x_{i+1}]$, $i = \overline{0, n - 1}$.

Проинтегрируем обе части равенства:

$$
s'(x) = {M_{i+1} - M_i \over h_i} \cdot {(x - x_i)^2 \over 2} + M_i (x - x_i) + A_i,
$$

где $h_i = x_{i+1} - x_i$, $A_i$ — константа интегрирования.

Проинтегрируем ещё раз:

$$
s(x) = {M_{i+1} - M_i \over h_i} \cdot {(x - x_i)^3 \over 6} + M_i { (x - x_i)^2 \over 2 } + A_i (x - x_i) + y_i.
$$

Определим параметры $M_i$, $A_i$, исходя из свойств сплайна.

$$
s(x_{i+1}) = y_{i+1} = {M_{i+1} - M_i \over h_i} \cdot {h_i^3 \over 6} + M_i {h_i^2 \over 2} + A_i h_i + y_i \implies
$$

$$
\implies {y_{i+1} - y_i \over h_i} = { M_{i+1} - M_i \over 6 } h_i + {M_i h_i \over 2} + A_i. \tag{∗}
$$

С другой стороны, в каждом узле $x_i$ производные должны быть непрерывными:

$$
s'_i (x_i) = s'_{i+1} (x_i),
$$

следовательно,

$$
{ M_i - M_{i-1} \over h_{i-1} } \cdot { (x_i - x_{i-1})^2 \over 2 } + M_{i-1} (x_i - x_{i-1}) + A_{i-1} = A_i
$$

или

$$
{M_i - M_{i-1} \over 2} h_i + M_{i-1} h_i + A_{i-1} = A_i. \tag{∗∗}
$$

С другой стороны, из $(∗)$ следует, что

$$
{y_i - y_{i-1} \over h_{i-1}} = {M_i - M_{i-1} \over 6} h_{i-1} + {M_{i-1} h_{i-1} \over 2} + A_{i-1}. \tag{∗∗∗}
$$

Выражаем из $(∗)$ и $(∗∗∗)$ разность $A_i - A_{i-1}$ и подставляем в $(∗∗)$. Приводим подобные слагаемые. В результате получим

$$
M_{i+1} {h_i \over 6} + M_i {h_i - h_{i-1} \over 3} + M_{i-1} {h_{i-1} \over 6} = {y_{i+1} - y_i \over h_i} - {y_i - y_{i-1} \over h_{i-1}}.
$$

Граничные условия: $M_0 = M_n = 0$ (производные второго порядка на границах должны равняться нулю).

Данное уравнение с граничными условиями является краевой задачей для конечноразностного линейного уравнения второго порядка, которое эффективно решается методом прогонки *(см. прошлый семестр)*.

Данное уравнение всегда устойчиво к вычислительной погрешности, т. к. в нём выполняется условие преобладания главной диагонали.

Таким образом, $M_i$ определяется однозначно, а через них определяется $A_i$ из уравнения $(∗)$.

В результате параметры сплайна определяются для всех элементарных участков.