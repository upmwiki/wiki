---
prev: false
next: false
---

**Практическое занятие**

# NPU-разложение

Часто бывает, что метод Гаусса с выбором главного элемента использует только перестановки строк. В этом случае на $k$-ом шаге алгоритма ищется наибольший по модулю элемент в каждом столбце в оставшейся подматрице. Тогда перестановке будет соответствовать умножение на соответствующую перестановочную матрицу слева.

::: info ПРИМЕР
Провести NPU-разложение системы

$$
\begin{cases}
    x_1 + 2x_2 - x_3 = 2, \\
    2x_1 + 5x_2 - x_3 = 6, \\
    -x_1 - x_2 + 3x_3 = 1.
\end{cases}
$$

*Решение.* Представим систему в виде расширенной матрицы:

$$
\left(
\begin{array}{ccc|c}
    1 & 2 & -1 & 2 \\
    2 & 5 & -1 & 6 \\
    -1 & -1 & 3 & 1
\end{array}
\right)
$$

Рассмотрим первый столбец. Найдём в нём наибольший по модулю элемент, чтобы затем его сделать главным. Таковым является $\max\set{ |1|, |2|, |-1| } = 2$, который находится во второй строке. Таким образом, поменяем первую и вторую строки местами, чтобы элемент $2$ стал главным:

$$
\left(
\begin{array}{ccc|c}
    2 & 5 & -1 & 6 \\
    1 & 2 & -1 & 2 \\
    -1 & -1 & 3 & 1
\end{array}
\right)
$$

Поделим первую строку на $2$:
$$
\left(
\begin{array}{ccc|c}
    1 & 2.5 & -0.5 & 3 \\
    1 & 2 & -1 & 2 \\
    -1 & -1 & 3 & 1
\end{array}
\right)
$$

Прибавим ко второй строке первую, умноженную на $-1$, и к третьей строке, умноженную на $1$:

$$
\left(
\begin{array}{ccc|c}
    1 & 2.5 & -0.5 & 3 \\
    0 & -0.5 & -0.5 & -1 \\
    0 & 1.5 & 2.5 & 4
\end{array}
\right)
$$

Рассмотрим второй столбец. Как и на предыдущем шаге, найдём максимальный по модулю элемент из столбца (не включая элемент первой строки). Таковым является $1,5$. Поменяем вторую и третью строки местами:

$$
\left(
\begin{array}{ccc|c}
    1 & 2.5 & -0.5 & 3 \\
    0 & 1.5 & 2.5 & 4 \\
    0 & -0.5 & -0.5 & -1
\end{array}
\right)
$$

Поделим вторую строку на $1,5$:

$$
\left(
\begin{array}{ccc|c}
    1 & 2.5 & -0.5 & 3 \\
    0 & 1 & {5 \over 3} & {8 \over 3} \\
    0 & -0.5 & -0.5 & -1
\end{array}
\right)
$$

Прибавим к третьей строке вторую, умноженную на $0,5$:

$$
\left(
\begin{array}{ccc|c}
    1 & 2.5 & -0.5 & 3 \\
    0 & 1 & {5 \over 3} & {8 \over 3} \\
    0 & 0 & {1 \over 3} & -1
\end{array}
\right)
$$

Последний шаг прямого хода. Поделим последнюю строку на ${1 \over 3}$:

$$
\left(
\begin{array}{ccc|c}
    1 & 2.5 & -0.5 & 3 \\
    0 & 1 & {5 \over 3} & {8 \over 3} \\
    0 & 0 & 1 & {1 \over 3}
\end{array}
\right)
$$

В результате исходная матрица $A$ системы заменяемся на произведение

$$
A = \underbrace{\left(\begin{matrix}
    0 & 1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & 1
\end{matrix}\right)}_{P_{1,2}} \cdot \underbrace{\left(\begin{matrix}
    2 & 0 & 0 \\ 1 & 1 & 0 \\ -1 & 0 & 1
\end{matrix}\right)}_{N_1} \cdot 
\underbrace{\left(\begin{matrix}
    1 & 0 & 0 \\ 0 & 0 & 1 \\ 0 & 1 & 0
\end{matrix}\right)}_{P_{2,3}} \cdot \underbrace{\left(\begin{matrix}
    1 & 0 & 0 \\ 0 & 1,5 & 0 \\ 0 & -0,5 & 1
\end{matrix}\right)}_{N_2} \cdot
$$
$$
\cdot \underbrace{\left(\begin{matrix}
    1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & {1 \over 3}
\end{matrix}\right)}_{N_3} = \underbrace{\left(\begin{matrix}
    1 & {2 \over 5} & -0,5 \\
    0 & 1 & {5 \over 3} \\
    0 & 0 & 1
\end{matrix}\right)}_{U}
$$

---

> *Замечание.* Таким разложением мы записали произведённые нами шаги:
> * матрица $P_{1,2}$ описывает то, что мы поменяли первую и вторую строки местами;
> * матрица $N_1$ описывает первый столбец в конце первого шага;
> * матрица $P_{2,3}$ описывает то, что мы поменяли вторую и третью строки местами;
> * матрица $N_2$ описывает второй столбец в конце второго шага;
> * матрица $N_3$ описывает третий столбец в конце третьего шага.

:::

Не стоит забывать, что матрицы перестановок обладают следующим свойством:
$$ P_{i,j} = P_{i,j}^{-1}. $$