---
prev:
    link: ../theme-03
    text: Тема 3. Точные методы решения СЛАУ
next:
    link: ../theme-05
    text: Тема 5. Конечно-разностные уравнения
---

**Тема 4**

# Методы ортогонализации решения СЛАУ

Как известно, если $Q$ — матрица с ортогональными столбцами, то произведение $Q^TQ = D$, где $D$ — диагональная матрицу.

Тогда обратная матрица
$$Q^{-1}(Q^T)^{-1} = D^{-1}$$
выражается в виде
$$ Q^{-1} = D^{-1}Q^T, $$
т. е. операция обращения сводится к простой операции транспонирования.

Все методы ортогонализации преобразуют матрицу системы $A\bar{x} = \bar{b}$ в произведение $A = QR$, где $Q$ — ортогональная матрица, $R$ — верхняя треугольная матрица.

В итоге исходная матрица преобразуется к виду
$$ R\bar{x} = Q^{-1}\bar{b}. $$

## § 16. Метод ортогонализации Грамма-Шмидта {#16}

Рассмотрим матрицу $A$ системы $A\bar{x} = \bar{b}$ как множество вектор-столбцов:
$$ A = \left( \bar{a}^{(1)}, \bar{a}^{(2)}, ..., \bar{a}^{(n)} \right), $$
где $\bar{a}^{(j)} = \left(\begin{matrix} a_{1j} \\ a_{2j} \\ \vdots \\ a_{nj} \end{matrix}\right)$.

Построим теперь последовательность ортогональных векторов $\bar{q}^{(1)}, \bar{q}^{(2)}, ..., \bar{q}^{(n)}$ по правилу:

$\bar{q}^{(1)} = \bar{a}^{(1)}$;<br>
$\bar{q}^{(2)} = \bar{a}^{(2)} - r_{12}\bar{q}^{(1)}$;<br>
$\bar{q}^{(3)} = \bar{a}^{(3)} - r_{13}\bar{q}^{(1)} - r_{23}\bar{q}^{(2)}$;<br>
$\dots$<br>
$\bar{q}^{(n)} = \bar{a}^{(n)} - r_{1n}\bar{q}^{(1)} - \dots - r_{n-1,n}\bar{q}^{(n)}$.

Коэффициенты $r_{ij}$ будем рассматривать как элементы матрицы $R$ вида
$$
R = \left(\begin{matrix}
1 & r_{12} & r_{13} & \dots & r_{1,n-1} & r_{1n}, \\
0 & 1 & r_{23} & \dots & r_{2,n-1} & r_{2n}, \\
0 & 0  & 1 & \dots & r_{3,n-1} & r_{3n}, \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \dots & 1 & r_{n-1,n} \\
0 & 0 & 0 & \dots & 0 & 1
\end{matrix}\right)
$$
и определять из условия ортогональности векторов $\bar{q}^{(1)}, \bar{q}^{(2)}, ..., \bar{q}^{(n)}$.

Вспомним определения скалярного произведения и ортогональности:
* скалярное произведение: $\left(\bar{q}^{(i)}, \bar{q}^{(j)}\right) = \sum_{k=1}^n q_k^{(i)} \cdot q_k^{(j)}$;
* ортогональность: $\left(\bar{q}^{(i)}, \bar{q}^{(j)}\right) = 0 ~ ~ ~ \forall i \ne j$.

Тогда $\left(\bar{q}^{(i)}, \bar{q}^{(j)}\right) = 0$, откуда следует, что
$$
r_{12} = { \left(\bar{a}^{(2)}, \bar{q}^{(1)}\right) \over \left(\bar{q}^{(1)}, \bar{q}^{(1)}\right) }.
$$

Аналогично можно потребовать, чтобы $\left(\bar{q}^{(3)}, \bar{q}^{(1)}\right) = 0$ и $\left(\bar{q}^{(3)}, \bar{q}^{(2)}\right) = 0$. Отсюда получим

$$
r_{13} = { \left(\bar{a}^{(3)}, \bar{q}^{(1)}\right) \over \left(\bar{q}^{(1)}, \bar{q}^{(1)}\right) }, ~ ~ ~ ~
r_{23} = { \left(\bar{a}^{(3)}, \bar{q}^{(2)}\right) \over \left(\bar{q}^{(2)}, \bar{q}^{(2)}\right) },
$$
и т. д.

$$
(\bar{q}^{(1)}, \bar{q}^{(n)}) = 0, ~ ~ (\bar{q}^{(n-1)}, \bar{q}^{(n)}) = 0, ... \implies
$$

$$
\implies r_{1n} = { (\bar{a}^{(n)}), \bar{q}^{(1)} \over (\bar{q}^{(1)}, \bar{q}^{(1)}) }, ~ ~ ..., ~ ~ r_{n-1,n} = { (\bar{a}^{(n)}, \bar{q}^{(n-1)}) \over (\bar{q}^{(n-1)}, \bar{q}^{(n-1)}) }.
$$

Тогда между векторами $\bar{a}^{(j)}$ и $\bar{q}^{(j)}$ выполняются соотношения:

$$
\bar{a}^{(j)} = \bar{q}^{(j)} + \sum_{k=1}^{j-1} r_{kj}\bar{q}^{(k)}.
$$

Если теперь рассмотреть систему векторов $(\bar{q}^{(1)}, \bar{q}^{(2)}, ..., \bar{q}^{(n)})$ как столбцы матрицы $Q$, то это выражение примет вид

$$
a_{ij} = q_{ij} \cdot 1 + \sum_{j=1}^{j-1} q_{ik}r_{kj},
$$

что, по правилам умножения матриц, соответствует равенству

$$
A = QR,
$$

где $Q$ — ортогональная матрица, $R$ — верхняя треугольная матрица.


:::: info ПРИМЕР
С помощью метода ортогонализации Грамма-Шмидта решить СЛАУ $A\bar{x} = \bar{b}$, где

$$
A = \left(\begin{matrix}
3 & 2 & 1 \\
4 & 1 & -2 \\
5 & -2 & -3
\end{matrix}\right), ~ ~ ~ ~
\bar{b} = \left(\begin{matrix}
6 \\ 8 \\ 4
\end{matrix}\right),
$$

и найти обратную матрицу $A^{-1}$.

*Решение.*

$$
\bar{q}^{(1)} = \bar{a}^{(1)} = \left(\begin{matrix} 3 \\ 4 \\ 5 \end{matrix}\right);
$$
$$
r_{12} = { ( \bar{a}^{(2)}, \bar{q}^{(1)} ) \over (\bar{q}^{(1)}, \bar{q}^{(1)}) } = { 2 \cdot 3 + 1 \cdot 4 - 2 \cdot 5 \over 9 \cdot 16 \cdot 25 } = {0 \over 50} = 0;
$$

$$
\implies \bar{q}^{(2)} = \bar{a}^{(2)} - 0 \cdot \bar{q}^{(1)} = \left(\begin{matrix} 2 \\ 1 \\ -2 \end{matrix}\right).
$$

$$
r_{13} = { ( \bar{a}^{(3)}, \bar{q}^{(1)} ) \over (\bar{q}^{(1)}, \bar{q}^{(1)}) } = { 3 - 8 - 15 \over 9 + 16 + 25 } = -{2 \over 5};
$$

$$
r_{23} = { ( \bar{a}^{(3)}, \bar{q}^{(2)} ) \over (\bar{q}^{(2)}, \bar{q}^{(2)}) } = { 2 - 2 + 6 \over 4 + 1 + 4 } = {6 \over 9} = {2 \over 3}.
$$

$$
\bar{q}^{(3)} = \bar{a}^{(3)} - r_{13} \cdot \bar{q}^{(1)} - r_{23} \cdot \bar{q}^{(2)} =
$$
$$ = \left(\begin{matrix} 1 \\ -2 \\ -3 \end{matrix}\right) - \left(-{2 \over 5}\right) \cdot \left(\begin{matrix} 3 \\ 4 \\ 5 \end{matrix}\right) - {2 \over 3} \cdot \left(\begin{matrix} 2 \\ 1 \\ -2 \end{matrix}\right) = \left(\begin{matrix} {13 \over 15} \\ -{16 \over 15} \\ {1 \over 3} \end{matrix}\right).
$$

В итоге получаем матрицу $Q$:

$$
Q = \left(\begin{matrix}
3 & 2 & {13 \over 15} \\
4 & 1 & -{16 \over 15} \\
5 & -2 & {1 \over 3}
\end{matrix}\right)
$$

и матрицу $R$:

$$
R = \left(\begin{matrix}
1 & 0 & -{2 \over 5} \\
0 & 1 & {2 \over 3} \\
0 & 0 & 1
\end{matrix}\right).
$$

Таким образом, мы получили QR-разложение.

Матрица $D$:

$$
D = Q^T \cdot Q^T Q = \left(\begin{matrix}
50 & 0 & 0 \\
0 & 9 & 0 \\
0 & 0 & 2
\end{matrix}\right)
$$

(по диагонали стоят суммы квадратов элементов столбцов, например $3^2 + 4^2 + 5^2 = 50$).

$$
R\bar{x} = D^{-1}Q^T \bar{b} = \left(\begin{matrix}
{1 \over 50} & 0 & 0 \\
0 & {1 \over 9} & 0 \\
0 & 0 & {1 \over 2}
\end{matrix}\right) \left(\begin{matrix}
3 & 4 & 5 \\
2 & 1 & -2 \\
{13 \over 15} & -{16 \over 15} & {1 \over 3}
\end{matrix}\right) \left(\begin{matrix}
6 \\ 8 \\ 4
\end{matrix}\right) = \left(\begin{matrix}
{7 \over 5} \\ {4 \over 3} \\ -1
\end{matrix}\right).
$$

Таким образом,
$$
\begin{cases}
x_1 - {2 \over 5}x_3 = {7 \over 5}, \\
x_2 + {2 \over 3}x_3 = {4 \over 3}, \\
x_3 = -1,
\end{cases}
$$

откуда получаем

$$
\begin{cases}
x_1 = 1, \\
x_2 = 2, \\
x_3 = -1.
\end{cases}
$$

**Ответ:** $\bar{x} = \left(\begin{matrix} 1 \\ 2 \\ -1 \end{matrix}\right)$.

---

::: info Домашнее задание
Проверить самостоятельно, что
$$
A^{-1} = R^{-1}D^{-1}Q^T = \left(\begin{matrix}
{7 \over 30} & -{2 \over 15} & {1 \over 6} \\
-{1 \over 15} & {7 \over 15} & -{1 \over 3} \\
{13 \over 30} & -{8 \over 15} & {1 \over 6}
\end{matrix}\right).
$$
:::

::::


## § 17. Метод вращений (Гивенса) {#17}

Пусть задана СЛАУ $A\bar{x} = \bar{b}$. Предположим, что на $k$-ом шаге некоторого алгоритма матрица системы приведена к ступенчатой форме.

Будем считать, что на каждом шаге алгоритма обе части СЛАУ умножаются на последовательность матриц простейших поворотов, выбранных так, чтобы обнулялись элементы под главной диагональю.

Тогда, если выбрать

$$
\cos \alpha = { a_{ii} \over \sqrt{ a^2_{ii} + a^2_{ji} } }, ~ ~ ~
\sin \alpha = { -a_{ji} \over \sqrt{ a^2_{ii} + a^2_{ji} } },
$$

то после такого умножения элемент $a^{(i)}_{ji} = 0$ для всех элементов, лежащих ниже главной диагонали.

Таким образом, матрица $A$ последовательно умножается на серию обратных матриц простейшего поворота.

$$
T^{-1}_{ij}(\alpha) = T_{ij}(-\alpha).
$$

В результате получаем

$$
T^{-1}_{n-1,n} \dots T^{-1}_{12}A = R,
$$

где $R$ — верхняя треугольная матрица. Следовательно,

$$
A = \underbrace{T_{12} \cdot ... \cdot T_{1n} \cdot T_{23} \cdot ... \cdot T_{2n} \cdot ... \cdot T_{n-1,n}}_{Q} \cdot R,
$$

где $Q$ — ортогональная матрица, т. к. $T^{-1}_{ij} = T^T_{ij}$ — ортогональная.

Этот метод обладает тем замчательным свойством, что в результате прямого хода не растут абсолютные значения элементов матрицы $A$.

Действительно, после каждого умножения на матрицу простейшего поворота в матрице изменяются только $i$-ая и $j$-ая строка, причём сумма квадратов их элементов остаётся постоянной.

$$
\left(a^{(k)}_{ik}\right)^2 + \left(a^{(k)}_{kj}\right)^2 = \cos^2\alpha \cdot \left(a^{(k-1)}_{ik}\right)^2 +
$$
$$
+ 2\cos\alpha\sin\alpha \cdot a^{(k-1)}_{ik} \cdot a^{(k-1)}_{jk} + \sin^2\alpha \cdot \left(a^{(k-1)}_{jk}\right)^2 -
$$
$$
- 2\cos\alpha\sin\alpha \cdot a^{(k-1)}_{ik} \cdot a^{(k-1)}_{jk}  + \cos^2\alpha \cdot \left(a^{(k-1)}_{jk}\right)^2 +
$$
$$
+ \sin^2\alpha \cdot \left(a^{(k-1)}_{ik}\right)^2 =
$$

$$
= (\cos^2 \alpha + \sin^2\alpha) \cdot \left( \left(a^{(k-1)}_{ik}\right)^2 + \left(a^{(k-1)}_{jk}\right)^2 \right) =
$$
$$
= \left(a^{(k-1)}_{ik}\right)^2 + \left(a^{(k-1)}_{jk}\right)^2.
$$

В результате требуется вычислить ${(n-1)n \over 2}$ квадратных корней, что замедляет вычисления, но это искупается малым ростом вычислительной погрешности.


## § 18. Метод отражений (Хаусхолдера) {#18}

Данный метод также приводит матрицу к треугольному виду с помощью последовательного умножения на обобщённые матрицы отражения. *(см. [лекцию о матрицах специального вида](../theme-02/#10))*

Элементы матрицы отражения вычисляются так, чтобы отражённый вектор был коллинеарен вектору со всеми нулями ниже заданной координаты. В результате матрица, полученная из таких вектор-столбцов, будет треугольной.

Матрица отражения определяется формулой

$$ U = E - 2\Omega, $$

где $(\Omega)_{ij} = \omega_i \cdot \omega_j$, а $\bar{\omega}$ — единичная нормаль к гиперплоскости, относительно которой производится отражение.

В общем случае, если требуется преобразовать вектор $\bar{b}$ относительно гиперплоскости с единичной нормалью $\bar{\omega}$, в вектор, коллинеарный вектору $\bar{c}$, то $\bar{\omega}$ определяется по формуле

$$
\bar{\omega} = { \bar{b} - \alpha \bar{c} \over \sqrt{ 2\bar{b}\cdot\left( \bar{b} - \alpha \bar{c} \right) } },
$$

где $\alpha = { |\bar{b}| \over |\bar{c}| }$ (отношение длин векторов).

В методе отражений в качестве вектора $\bar{c}$ на $i$-ом шаге алгоритма выбирается единичный координатный вектор размерности $n - i + 1$, а вместо вектора $\bar{b}$ — вектор той же размерности, состоящий из элементов матрица $A$ на главной диагонали и под ней. После этого строится обобщённая матрица отражений по формуле

![](/media/images/num%20theory%2018%201.jpg)

В результате имеем

$$
\underbrace{U^{-1}_{n-1}\cdot U^{-1}_{n-2} \cdot ... \cdot U^{-1}_{1} \cdot A}_{R} = U^{-1}_{n-1} \cdot ... \cdot U^{-1}_1 \cdot \bar{b},
$$

где $R$ — верхняя треугольная матрица.

Получаем, что

$$
A = \underbrace{ U_1 \cdot ... \cdot U_{n-1} }_{Q} R,
$$

где $Q$ — ортогональная матрица.

Таким образом, мы пришли к QR-разложению.

::: info ПРИМЕР
Решить систему методом отражений:
$$
\begin{cases}
x_1 + x_2 + x_3 = 1, \\
-2x_1 - x_2 + x_3 = -1, \\
2x_1 + 2x_2 - x_3 = 2.
\end{cases}
$$
:::