---
prev:
    link: ../theme-05
    text: Тема 5. Конечно-разностные уравнения
next: false
---

**Тема 6**

# Аппроксимация функций

Само понятие *аппроксимации* означает приближение некоей функции $y = f(x)$ на заданном множестве $F$ и относящееся к определённому типу функционального пространства. Это приближение осуществляется функцией из некоторого подпространства данного пространства (обычно конечномерного).

Для этого требуется:
1. определить множество $F$ и пространство;
2. определить подпространство;
3. указать способ приближения;
4. доказать существование и единственность решения поставленной задачи;
5. определить и оценить погрешность приближения.


## § 1. Постановка задачи интерполяции {#1}

Рассмотрим множество функций, принадлежащих линейному пространству $L$ и непрерывных на отрезке $[a;b]$ (обозначим $L_{[a;b]}$).

::: info ОПРЕДЕЛЕНИЕ
Назовём функцию $\varphi(x) = \sum_{i=0}^n a_i \varphi_i(x)$ **обобщённым многочленом** по системе функций $\set{ \varphi_i(x) }_{i = \overline{0,n}}$ на $[a,b]$, где $a_i$ — некоторые константы-коэффициенты многочлена.
:::

Таким образом, можно считать, что $\varphi(x)$ — это линейная оболочка на базисе $\varphi_i(x)$, принадлежащая линейному $(n+1)$-мерному подпространству $L_{n+1}$, входящему в состав $L_{[a;b]}$ ($L_{n+1} \subset L_{[a;b]}$).

Пусть задана система точек $x_i \in [a,b]$, $i = \overline{0,n}$, таких, что $x_i \ne x_j ~ ~ ~ \forall i \ne j$.

Обозначим $y_i = f(x_i)$ — значение функции.

Каждой функции $f(x) \in L_{[a;b]}$ поставим в соответствие обобщённый многочлен $\varphi(x) \in L_{n+1}$ такой, что

$$
\varphi(x_i) = f(x_i) ~ ~ ~ \forall i = \overline{0, n}. \tag{∗}
$$

*(другими словами, мы выбираем способ приближения, который требует, чтобы в заданных точках функция и многочлен совпадают)*

[рисунок]

При этом $\varphi(x)$ называется **обобщённым интерполяционным многочленом** по системе $\set{\varphi_i(x)}$ и узлам интерполирования $\set{x_i}$, $i = \overline{0,n}$, для функции $y = f(x)$ на отрезке $[a;b]$.

Определение $\varphi(x)$ называется **задачей интерполирования**.

Рассмотрим вопрос существования и единственности решения этой задачи.

Очевидно, что этот вопрос совпадает с вопросом о существовании и единственности решения системы уравнений $(∗)$.

В развернутом виде получим

$$
\begin{cases}
a_0 \varphi_0(x_0) + a_i \varphi_1(x_0) + \dots + a_n \varphi_n(x_0) = f(x_0), \\
a_0 \varphi_0(x_1) + a_i \varphi_1(x_1) + \dots + a_n \varphi_n(x_1) = f(x_1), \\
\dots \\
a_0 \varphi_0(x_n) + a_i \varphi_1(x_n) + \dots + a_n \varphi_n(x_n) = f(x_n).
\end{cases}
$$

Коэффициенты обобщённого многочлена являются решениями данной СЛАУ.

Необходимым и достаточным условием единственности решения является требование отличие от нуля определителя

$$
\Delta = \left|\begin{matrix}
\varphi_0(x_0) & \dots & \varphi_n(x_0) \\
\vdots & \ddots & \vdots \\
\varphi_n(x_0) & \dots & \varphi_n(x_n)
\end{matrix}\right| \ne 0.
$$

Очевидно, что необходимым условием этого является линейная независимость системы функций $\set{ \varphi_i(x) }$. Это следует из того, что если бы функции в системе были линейно зависимые, то у определителя были линейно зависимые столбцы, а значит, он равнялся бы нулю.

Однако, можно показать, что требование линейной независимости функций не является достаточным. Предположим, что обобщённый многочлен по данной системе функций имеет $n+1$ различных нулей (корней на отрезке $[a;b]$).

Возьмём эти нули в качестве узлов интерполирования $\set{x_i}$ и опять получим, что определитель равен нулю, поэтому система функций $\set{\varphi_i(x)}$ должна обладать специальным дополнительным свойством.

::: info ОПРЕДЕЛЕНИЕ
Система линейно независимых функций $\set{\varphi_i(x)}_{i = \overline{0,n}}$ на отрезке $[a;b]$ называется **системой Чебышева**, если любой обобщённый многочлен $\varphi(x)$ по этой системе функций на $[a;b]$ имеет не более $n$ различных нулей.
:::

Можно доказать следующую теорему.

::: info ТЕОРЕМА
Для того чтобы задача интерполирования имела единственное решение ($\Delta \ne 0$), необходимо и достаточно, чтобы система функций, по которой построен этот обобщённый многочлен, была системой Чебышева.
:::

Можно доказать, что следующие системы функций являются системами Чебышева:
1. $1, x, x^2, ..., x^n$, $~~ x \in (-\infty, \infty)$;
2. $1, e^x, e^{2x}, ..., e^{nx}$, $~~ x \in (-\infty, \infty)$;
3. $1, \cos x, \cos 2x, ..., \cos nx$, $~~ x \in [0; \pi]$.

## § 2. Интерполяционный многочлен Лагранжа {#2}

Пусть имеется функция $y = f(x)$, $x \in [a; b]$. Возьмём систему узлов $\set{x_i}$ из этого же интервала (узлы не совпадают, т. е. $x_i \ne x_j ~ ~ \forall i \ne j$).

$$
\varphi_i(x) = x^i ~ ~ ~ i = \overline{0, n}
$$

$$
\implies \varphi(x) = a_0 + a_1 x + a_2 x^2 + \dots + a_n x^n.
$$

Как было показано, эта система функций является системой Чебышева, следовательно, интерполяционный многочлен существует и единственен.

Попробуем подобрать его по внешним признакам. Будем искать $\varphi(x)$ в виде

$$
\varphi(x) = \sum_{i=0}^n f(x_i) \Phi_i(x),
$$

где $\Phi_i(x)$ — многочлены степени $n$, удовлетворяющие следующим требованиям:

$$
\Phi_i (x_j) = \begin{cases}
0, & i \ne j, \\
1, & i = j.
\end{cases}
$$

Тогда очевидно, что $\forall j ~ ~ ~ \varphi(x_j) = f(x_j)$.

Но тогда

$$
\Phi_i(x) = A_i \cdot (x-x_0) (x-x_1) \dots (x - x_{i-1}) (x-x_{i+1}) \dots (x - x_n).
$$

Подставим $x = x_i$:

$$
\Phi_i(x_i) = A_i \cdot (x_i-x_0) (x_i - x_1) \dots (x_i - x_{i-1}) (x - x_{i+1}) \dots (x_i - x_n) = 1.
$$

Т. к. $A_i = {1 \over (x_i-x_0) (x_i - x_1) \dots (x_i - x_{i-1}) (x - x_{i+1}) \dots (x_i - x_n)}$, окончательно получим

$$
\varphi(x) = L_n(x) =
$$
$$
= \sum_{i=0}^n f(x_i) { (x-x_0) (x-x_1) \dots (x - x_{i-1}) (x-x_{i+1}) \dots (x - x_n) \over (x_i-x_0) (x_i - x_1) \dots (x_i - x_{i-1}) (x - x_{i+1}) \dots (x_i - x_n) }.
$$

Данный многочлен называется **интерполяционным многочленом в форме Лагранжа**.

::: info ПРИМЕР
Построим параболу по трём узлам. Например, выберем три следующих:

| $x_i$ | $-1$ | $0$ | $1$ |
|-|-|-|-|
| $y_i$ | $0$ | $1$ | $4$ |

Тогда

$$
L_2(x) = \underbrace{0}_{y_1} \cdot { (x-0)(x-1) \over (-1-0)(-1-1) } - \underbrace{1}_{y_2} \cdot { (x-(-1))(x-1) \over (0-(-1))(0-1) } +
$$

$$
+ 4 \cdot { (x-(-1))(x-0) \over (1-(-1)) (1-0) } =
{ (x+1)(x-1) \over 1 \cdot (-1) } + 4 \cdot { (x+1)x \over 2 \cdot 1 } = 
$$

$$
= -(x+1)(x-1) + 2x(x+1) = -(x^2-1) + 2(x^2 + x) =
$$

$$
= x^2 + 2x + 1 = (x+1)^2.
$$

Проверка:
* $x = 0$: $(0 + 1)^2 = 1^2 = 1$;
* $x = -1$: $(-1 + 1)^2 = 0^2 = 0$;
* $x = 1$: $(1 + 1)^2 = 2^2 = 4$.
:::

### Формула остаточного члена

Очевидно, что если интерполяционный многочлен строится по данному набору узлов, то в некоторой их окрестности функции и многочлены будут близки. Однако сказать, как сильно отличаются функции и многочлены в других точках, заранее нельзя.

[image]

Чтобы оценить поведение многочлена между узлами, рассмотрим разность

$$
R_n(x) = f(x) - L_n(x),
$$

которую назовём **остаточным членом интерполирования**.

Попробуем получить для неё аналитическое выражение. Пусть $f(x)$ непрерывна и $n+1$ раз дифференцируема на отрезке $[a;b]$. Введём следующую функцию:

$$
\varphi(z) = f(z) - L_n(z) = K(z - x_0)(z - x_1) \dots (z - x_n),
$$

где $x_0, ..., x_n$ — узлы интерполирования, $K$ — константа (по переменной $z$), $z$ — некоторая переменная, $z \in [a; b]$.

Значение $K$ выберем из условия $\varphi(x) = 0$. Следовательно,

$$
f(x) - L_n(x) - K(x - x_0)(x - x_1)\dots(x - x_n) = 0.
$$

Тогда $K$ равняется

$$
K = {f(x) - L_n(x) \over w(x)},
$$

где $w(x) = (x-x_0)\dots(x-x_n)$.

Тогда $\varphi(z) = 0$ при $z=x$ и $z = x_i$, $i = \overline{0,n}$.

Следовательно, $\varphi(z)$ имеет по крайней мере $n+2$ нуля на $[a;b]$.

Из первого семестра математического анализа известна *теорема Ролля*:

::: info ТЕОРЕМА РОЛЛЯ
Пусть функция $f(x)$ непрерывна на отрезке $[a;b]$ и дифференцируема внутри него. Если она принимает на краях отрезка одинаковые значения (т. е. $f(a) = f(b)$), то внутри отрезка всегда существует точка $\xi$ такая, что $f(\xi) = 0$.
:::

В нашем случае $\varphi'(z)$ имеет $n+1$ нуль. Соответственно, $\varphi''(z)$ имеет $n$ нулей, и т. д. Таким образом, $\varphi^{(n+1)}(z)$ имеет 1 нуль, т. е.
$$
\exists z = \xi: ~ \varphi^{(n+1)}(\xi) = 0, ~ ~ ~ \xi \in [a;b].
$$

$$
\varphi(z) = f(z) - L_n(z) - K(z-x_0)(z-x_1)\dots(z-x_n)
$$

$$
\implies \varphi^{(n+1)}(z) = f^{(n+1)}(z) + 0 - K(n+1)! = f^{(n+1)} - K(n+1)!.
$$

Т. к. $\varphi^{(n+1)}(\xi) = 0$, то $f^{(n+1)}(\xi) - K(n+1)! = 0$, откуда
$$
K = { f^{(n+1)}(\xi) \over (n+1)! }.
$$

Мы уже получили, что, с другой стороны,

$$
K = {f(x) - L_n(x) \over w(x)},
$$

следовательно,

$$
R_n(x) = f(x) - L_n(x) = { f^{(n+1)}(\xi) \over (n+1)! } (x-x_0)(x-x_1)\dots(x-x_n),
$$

где $\xi \in [a;b]$.

Последнее выражение называется **формулой остаточного члена для интерполяционного многочлена Лагранжа**.

::: info ЗАМЕЧАНИЕ
Напрямую данной формулой пользоваться нельзя, поэтому вместо неё используют оценку

$$
|R_n(x)| \le { M_{n+1} \over (n+1)! } |(x-x_0)\dots(x-x_n)|,
$$

где $M_{n+1} = \max |f^{(n+1)}(x)|$ на $x \in [a;b]$.
:::

::: info ПРИМЕР
Построить многочлен Лагранжа второго порядка для функции $f(x) = \sin x$ по следующщим узлам:
| $\boldsymbol{x_i}$ | $\boldsymbol{0}$ | $\boldsymbol{\pi/6}$ | $\boldsymbol{\pi/2}$ |
|-|-|-|-|
| $\boldsymbol{y_i}$ | $0$ | $1/2$ | $1$ |

Найти $L_2(\pi/3)$, оценить погрешность интегрирования.

*Решение.* Сначала посчитаем сам многочлен по формуле
$$
L_n(x) = \sum_{i=1}^n f(x_i) { (x-x_0)(x-x_1)\dots(x-x_{i-1})(x-x_{i+1})\dots(x-x_n) \over (x_i-x_0)(x_i-x_1)\dots(x_i-x_{i-1})(x_i-x_{i+1})\dots(x_i-x_n) }.
$$

Поскольку $n=2$, получаем
$$
L_2(x) = 0 \cdot { (x-\pi/6)(x-\pi/2) \over (0-\pi/6)(0-\pi/2) } + {1 \over 2} \cdot { (x-0)(x-\pi/2) \over (\pi/6-0)(\pi/6-\pi/2) } +
$$
$$
+ 1 \cdot { (x-0)(x-\pi/6) \over (\pi/2-0)(\pi/2-\pi/6) } = {1 \over 2} { x(x-\pi/2) \over \pi/6(\pi/6-\pi/2) } + { x(x-\pi/6) \over \pi/2 (\pi/2-\pi/6) } =
$$
$$
= \dots = {x \over \pi^2} \left(-3 + {7 \over 2}\pi\right).
$$

Найдём $L_2(\pi/2)$:

$$
L_2(\pi/3) = {1 \over 3\pi}\left( -\pi + {7 \over 2} \pi \right) = {1 \over 3\pi} \cdot {5 \over 2}\pi = {5 \over 6} = 8,833...
$$

Мы знаем, что $\sin {\pi/3} = \sqrt{3}/2 \approx 8,666$.

Видно, что $R_2(x) \approx 0,03$.

Попробуем посчитать остаточный член $R_2(x)$ через оценку:

$$
|R_2(x)| \le { \max\limits_{x \in [0; \pi/2]} |f'''(x)| \over 3! } \cdot \left| x(x-\pi/6)(x-\pi/2) \right| =
$$
$$
= { \max\limits_{x\in[0;\pi/2]} |-\cos x| \over 6 } \cdot |x(x-\pi/6)(x-\pi/2)|.
$$

$$
\left|R_2\left({\pi \over 3}\right)\right| \le {1 \over 6} \cdot \left| {\pi \over 3} \left({\pi \over 3}-{\pi \over 6}\right) \left( {\pi \over 3} - {\pi \over 2} \right) \right| = {\pi^3 \over 640} \approx 0,048.
$$
:::

**Замечание:** можно показать, что рост числа узлов не всегда повышает точность интерполирования.

## § 3. Интерполяционный многочлен Ньютона {#3}

Многочлен Лагранжа является универсальным, так как может быть использован для любого набора узлов. Однако его недостатком является невозможность оценить влияние на результат добавления нового узла.

Рассмотрим случай, когда множество всех узлов представляет собой сетку, заданную с постоянным шагом:

$$ x_i = x_0 + ih, $$

где $i = ..., -l, -l+1, ..., -1, 0, 1, ..., n, ...$ .

Соответственно, $x_{i+1} - x_i = h > 0$ — шаг сетки.

Пусть задана сеточная функция $y_i = f(x_i)$ , тогда на сетке могут быть заданы конечные разности.

* **Конечная разность 1-го порядка** — величина
  $$ \Delta y_i = y_{i+1} - y_i; $$
* **Конечная разность 2-го порядка** — величина
  $$ \Delta^2 y_i = y_{i+1} - \Delta y_i; $$
* ...
* **Конечная разность $k$-го порядка** — величина
  $$ \Delta^k y_k = y_{i+1} - \Delta^{k-1} y_i. $$

Все конечные разности могут быть собраны в одну таблицу.

[рисунок]

**Свойства конечных разностей:**

1. $\Delta^k \left(y_i^{(1)} + y_i^{(2)}\right) = \Delta^k y_i^{(1)} + \Delta^k y_i^{(2)}$;
2. $\Delta^k \left( \alpha_i y_i \right) = \alpha \cdot \Delta^k y_i$, где $\alpha = \text{const}$;
3. $\Delta^k y_i = \sum_{j=0}^k (-1)^{k-j} C_k^j y_{i+j}$, где $C_k^j$ — биномиальный коэффициент.

Первое и второе свойства очевидны. Третье покажем на примере:

$$ \Delta^2 y_i = \Delta y_{i+1} - \Delta y_i = y_{i+2} - y_{i+1} - (y_{i+1} - y_i) = $$
$$ = y_{i+2} - 2y_{i+1} + y_i; $$

$$ \Delta^3 y_1 = \Delta^2 y_{i+1} - \Delta^2 y_i = y_{i+3} - 2 y_{i+2} + y_{i-1} - $$
$$ - (y_{i+2} - 2y_{i+1} + y_i) = y_{i+1} - 3y_{i+2} + 3y_{i+1} - y_i. $$

Будем считать, что интерполяционный многочлен вычисляется в некоей точке $x$, $x \in (x_0, x_1)$, и узлы в него добавляются в последовательности $x_0, x_1, x_2, ...$ .

Преобразуем многочлен Лагранжа следующим образом:

$$
L_n(x) = L_0 + (L_1 - L_0) + (L_2 - L_1) + \cdots + (L_n - L_{n-1}).
$$

Рассмотрим разность $L_k - L_{k-1}$. Ясно, что это многочлен порядка не выше $k$ и он имеет ровно $k$ нулей при $x \in \set{x_0, x_1, ..., x_{k-1}}$. Следовательно,

$$
L_k - L_{k-1} = A_k \cdot (x-x_0)(x-x_1)\dots(x-x_{k-1}),
$$

где $A_k$ — число, и при этом $L_k(x_k) = f(x_k)$.

Следовательно, если вместо $x$ подставить $x_k$, то получим

$$
f(x_k) - L_{k-1}(x_k) + A_k(x_k - x_0)(x_k - x_1)\cdots(x_k - x_{k-1})
$$

$$
\implies A_k = \frac{ f(x_k) - L_{k-1}(x_k) }{(x_k - x_0) \cdots (x_k - x_{k-1}) } = { f(x_k) \over (x_k - x_0) \cdots (x_k - x_{k-1}) } - 
$$

$$
- { \sum_{j=0}^{k-1} f(x_j) \frac{ (x_k - x_0) \cdots (x_k - x_{j-1})(x_k - x_{j+1}) \cdots (x_k - x_{k-1}) }{ (x_j - x_0) \cdots (x_j - x_{j-1})(x_j - x_{j+1}) \cdots (x_j - x_{k-1}) } \over (x_k - x_0) \cdots (x_k - x_{k-1}) } = (*)
$$

Домножим в сумме числитель и знаменатель на $(x_k - x_j)$:

$$
(*) = { f(x_k) \over (x_k - x_0) \cdots (x_k - x_{k-1}) } +
$$

$$
+ \sum_{j=0}^{k-1} { f(x_j) \over (x_j - x_0) \cdots (x_j - x_{j-1})(x_j - x_{j+1}) \cdots (x_j - x_k) } =
$$

$$
= \sum_{j=0}^{k-1} { f(x_j) \over (x_j - x_0) \cdots (x_j - x_{j-1}) (x_j - x_{j+1}) \cdots (x_j - x_k) } = 
$$

$$
= \sum_{j=0}^k { f(x_j) \over jh \cdot (j-1) \cdot h \cdot ... \cdot 1 \cdot h \cdot (-1) \cdot h \cdot ... \cdot (-(k-j)) h } =
$$

$$
= \sum_{j=0}^k { f(x_j) \over h^k \cdot (-1)^{k-j} \cdot j! \cdot (k-j)! } = (**)
$$

Домножим числитель и знаменатель в сумме на $k!$:

$$
(*) = \sum_{j=0}^k (-1)^{k-j} \cdot C_k^j \cdot { y_j \over h^k \cdot k! } = 
$$
$$
= {1 \over h^k \cdot k!} \sum_{j=0}^k (-1)^{k-j} C_k^j y_k = { \Delta^k y_0 \over h^k \cdot k! }.
$$

Следовательно,

$$
L_k(x) - L_{k-1}(x) =
$$
$$
= { \Delta^k y_0 \over k! \cdot h^k } (x-x_0) (x-x_1) \cdots (x - x_{k-1}).
$$

Заметим переменную по формуле ${x - x_0 \over h} = t$. В результате:

$$
L_n(x) = y_0 + t \cdot \Delta y_0 + { t(t-1) \over 2! } \Delta^2 y_0 + \dots + 
$$

$$
+ { \Delta^ y_0 \over n! } t(t-1) \cdots (t-n+1) \equiv N_n^{(+)}(x),
$$

где $t \in (0, 1)$.

Данный многочлен называется **интерполяционным многочленом Ньютона (вперёд)**.

Если же подключать узлы в обратном порядке ($x_0, x_{-1}, x_{-2}, ...$), то аналогично можно получить **интерполяционный многочлен Ньютона (назад):**

$$
N_n^{(-)} = y_0 + t\Delta y_{-1} + {t(t+1) \over 2!} \Delta^2 y_{-2} + \cdots + 
$$
$$
+ { t(t+1)\cdots(t+n-1) \over n! } \Delta^n y_{-n}.
$$

Если воспользоваться формулой остаточного члена для многочлена Лагранжа, получим

$$
R_n^{(+)}(x) = { h^{n+1} f^{(n+1)}(\xi) \over (n+1)! } t(t-1)\cdots (t-n),
$$

$$
R_n^{(-)}(x) = { h^{n+1} f^{(n+1)}(\xi) \over (n+1)! } t(t+1)\cdots (t+n).
$$

::: info ЗАМЕЧАНИЕ
В многочленах Ньютона добавление нового узла приводит к появлению в сумме нового слагаемого, что позволяет оценить погрешность, возникающую при добавлении нового узла.
:::


## § 4. Схема Эйткена. Вопрос о сходимости интерполяционного процесса {#4}

Рассмотрим общий случай: шаг сетки непостоянный, количество узлов произвольно велико, значения функции заданы точно и вычисления производятся точно.

Будем считать, что интерполяционный процесс **сходится**, если

$$
\lim\limits_{n \to \infty} L_n(x) = f(x). \tag{∗}
$$

Понятно, что данные условия никогда не могут быть выполнены. Всегда количество узлов ограничено, вычисления и данные имеют фиксированную точность.

Вывод: нужен какой-то практически обоснованный процесс построения интерполирования.

Так, например, если условие $(∗)$ выполняется, то и предел $\lim\limits_{n \to \infty} L_{n-1} (x)$ тоже равен $f(x)$. Следовательно,

$$
\lim\limits_{n \to \infty} \left[ L_n(x) - L_{n-1}(x) \right] = 0.
$$

Это и будем считать **условием сходимости**.

То есть если для некоторого $n$ верно

$$
\left| L_n(x) - L_{n-1}(x) \right| < \varepsilon, \tag{∗∗}
$$

то можно считать, что интерполяционный многочлен получен с наперёд заданной точностью $\varepsilon$. Поэтому практическое правило интерполирования состоит в следующем: строится последовательность многочленов, где степень каждого на единицу выше предыдущего. На каждом шаге проверяется условие $(∗∗)$.

Возможны три случая:
1. заданная точность достигнута;
2. выбраны все узлы;
3. на некотором шаге исчезает сходимость, т. е.

   $$
   \left| L_{n-1}(x) - L_n(x) \right| < \left| L_{n+1}(x) - L_n(x) \right|.
   $$

В первых двух случаях в качестве результата берётся последнее значение многочлена, а в третьем — предпоследнее.

В этом и состоит практическое правило интерполирования.

Обычно при вычислениях узлы перенумеровываются по возрастанию модуля разности от точки интерполирования.

Естественным является пожелание, чтобы при такой схеме интерполирования можно было сократить объём вычислений, используя многочлены меньших степеней для пересчёта многочленов бо́льших степеней. Такая схема была разработана (схема Эйткена).

Будем считать, что узлы подключаются в порядке $x_0, x_1, x_2, ...$. Рассмотрим многочлены

$$
P_{01}(x) = {1 \over x_1 - x_0} \begin{vmatrix}
x - x_0 & y_0 \\
x - x_1 & y_1
\end{vmatrix}
$$

и

$$
P_{12}(x) = {1 \over x_2 - x_1} \begin{vmatrix}
x - x_1 & y_1 \\
x - x_2 & y_2
\end{vmatrix}
$$

(оба многочлена имеют первый порядок). При этом $P_{01}(x_0) = y_0$, $P_{01}(x_1) = y_1$, $P_{12}(x_1) = y_1$, $P_{12}(x_2) = y_2$.

То есть первый многочлен есть интерполяционный многочлен, построенный по узлам $x_0$ и $x_1$, а второй — по $x_1$ и $x_2$.

Построим теперь многочлен второго порядка:

$$
P_{012}(x) = {1 \over x_2 - x_0} \begin{vmatrix}
x - x_0 & P_{01}(x) \\
x - x_2 & P_{12}(x)
\end{vmatrix}.
$$

Легко проверить, что $P_{012}(x_0) = y_0$, $P_{012}(x_1) = y_1$, $P_{012}(x_2) = y_2$.

Легко показать, что в общем случае справедливо следующее правило: если обозначить через $P_\overline{i, i+k}$ интерполяционный многочлен, проходящий через узлы $x_i, x_{i+1}, ..., x_{i+k}$:

$$
P_\overline{i, i+k} = L_{i, i+1, ..., i+k} (x),
$$

то

$$
P_\overline{i,i+k}(x) = {1 \over x_{i+k} - x_i} \begin{vmatrix}
x - x_k & P_\overline{i, i+k-1} (x) \\
x - x_{i+k} & P_\overline{i, i+k} (x)
\end{vmatrix}.
$$

Эта рекуррентная формула позволяет пересчитывать зачения многочлена $n$-го порядка через значения многочленов $n-1$-го порядка при подключении нового узла.

Вычисления оформляются в виде следующей таблицы:

[таблица]

Добавление нового узла приводит к появлению новой строки таблицы.

Критерием остановки процесса является значение модуля разности $\left| L_{012...n} - L_{012...n-1} \right|$.