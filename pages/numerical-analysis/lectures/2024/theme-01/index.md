---
prev: false
next:
    link: ../theme-02
    text: Тема 2. Приближённые методы решения СЛАУ
---

**Тема 1**

# Погрешности

В различных сферах народного хозяйства (в инженерном деле, экономике) часто возникают математические задачи, связанные с вычислениями на компьютере. Такая необходимость обуславливается либо невозможностью решения задачи алгоритмически либо её большой размерностью.

Часто компьютерные вычисления связаны с необходимостью достаточной точности приближённого решения задачи. К таким задачам относятся:

* системы линейных алгебраических уравнений большой размерности;
* системы нелинейных уравнений;
* приближённые вычисления значений функций;
* приближённое дифференцирование;
* численное инегрирование;
* решение дифференциальных и интегральных уравнений;
* решение уравнений в частных производных.

При решении этих задач необходимо оценивать точность производимых вычислений, необходимые программные и вычислительные средства, а также применимость для использования конкретных методов решения задач.


## § 1. Абсолютная и относительная погрешность. Классификация погрешностей {#1}

Пусть $x$ — значение величины, полученное без какого-либо приближения, а $x^*$ — значение, полученное с использованием некоего приближения. Тогда разность $\Delta x = x - x^*$ называется **абсолютной погрешностью**, полученной в результате данного приближения.

Часто погрешности возникают на нескольких этапах вычислений либо преобразований. Тогда если $x$ — результат без приближений, $x^*$ — результат с приближением на первом этапе, $x^{**}$ — результат с приближением на втором этапе, то
$$
\Delta x = x - x^{**} = \underbrace{x-x^*}_{\Delta_1x} + \underbrace{x^* - x^{**}}_{\Delta_2x} \implies \Delta x = \Delta_1x + \Delta_2x,
$$
т. е. погрешности складываются в результате их прибавления.

Величина $\delta = {\Delta x \over |x^*|}$ называется **относительной погрешностью** (иногда измеряется в процентах).

::: info ЗАМЕЧАНИЕ
Обычно абсолютная и относительная погрешности неизвестны, как неизвестно и точное значение измеряемой величины, поэтому вводится понятие **предельных абсолютной и относительной погрешностей**.
:::

Предположим, что известны числа $\Delta_x > 0$ и $\delta_x > 0$ такие, что $|\Delta_x| \le \Delta_x$, $|\delta_x| \le \delta_x$. Эти величины в дальнейшем будем называть **оценками** или **предельными абсолютными и относительными погрешностями** соответственно.

::: info ЗАМЕЧАНИЕ
В дальнейшем слово «предельные» будем опускать, подразумевая под всеми погрешностями их предельные значения.
:::

По своему прохождению погрешности делятся на три группы:
* **неустранимые (погрешность исходных данных):** связана либо со способом измерения либо с разрядной сеткой компьютера.
$$ x = x^* \implies y^* = A(x^*) \implies \Delta_1 = y - y^*. $$
* **погрешность метода:** погрешность, вытекающая из особенностей применяемого математического метода.
$$ y^{**} = A^*(x^*) \implies \Delta_2 = y^* - y^{**}. $$
* **вычислительная погрешность (погрешность округления):** возникает из-за ограниченности разрядной сетки компьютера.
$$ y^{***} = A^*[x^*] \implies \Delta_3 = y^{**} - y^{***}, $$
где $[x^*]$ — обозначение округления величины $x^*$.


## § 2. Неустранимая погрешность {#2}

Поставим вопрос о грубом оценивании погрешности в результате вычисления дифференцируемой функции $y = f(x_1, x_2, ..., x_n)$.

Будем считать, что предельные погрешности всех величин известны. Тогда точные значения
$$ x_1, x_2, ..., x_n $$
лежат в интервалах
$$
[x_1 - \Delta_{x_1}, x_1 + \Delta_{x_1}],
[x_2 - \Delta_{x_2}, x_2 + \Delta_{x_2}],
...,
[x_n - \Delta_{x_n}, x_n + \Delta_{x_n}]
$$
соответственно. При этом точная абсолютная погрешность $\Delta_y$ оценивается по модулю своим приращением:

$$
\Delta_y \approx \left| f(x_1,x_2,...,x_n) - f(x^*_1, x^*_2, ..., x^*_n) \right|.
$$

Как известно, главной частью полного приращения функции является её полный дифференциал, поэтому справедливо приближённое неравенство

$$
\Delta_y \lessapprox  |\text{d} y| = \left| \sum _ {i = 1}^n {\partial f \over \partial x _ i} \Delta _ {x _ i} \right| _ {x _ i = x^* _ i} \le \sum _ {i=1}^n \left|{ \partial f \over \partial x _ i }\right| _ {x _ i = x^* _ i} \Delta _ {x _ i},
$$
где $\Delta_{x_i}$ — предельная погрешность.

Следуя определению, данную величину можно представить как предельную абсолютную погрешность, возникающую при вычислении функции.

Таким образом,
$$
\Delta_y = \sum_{i=1}^n \left|{\partial f \over \partial x_i}\right|_{x_i = x^*_i} \Delta_{x_i},
$$
$$
\delta_y = {\Delta_y \over |y^*|},
$$
а $y^* = f(x^*_1, x^*_2, ..., x^*_n)$, то можно $\delta_y$ представить в виде

$$
\delta_y = {\Delta_y \over |y^*|} = \sum^n_{i=1} \left|{1 \over f} \cdot {\partial f \over \partial x_i}\right|_{x_i=x^*_i} \Delta_{x_i} = 
$$
$$
= \{\text{логарифм. производные}\} =
$$
$$
= \sum^n_{i=1} \left|{\partial \ln f \over \partial x_i}\right|_{x_i = x^*_i} \Delta_{x_i}.
$$

### Погрешности результатов арифметических действий

* $y = x_1 \pm x_2$.
  * **абсолютная погрешность:** $\Delta_y = \Delta_{x_1} + \Delta_{x_2}$ (т. е. абсолютная погрешность суммы равна сумме абсолютных погрешностей).
  * **относительная погрешность:** $\delta_y = {\Delta_{x_1} + \Delta_{x_2} \over |x^*_1 \pm x^*_2|}$.
  ::: info ЗАМЕЧАНИЕ
  Последнее равенство означает, что при сложении в алгебраической сумме чисел, близких по модулю, но противоположных по знаку, относительная погрешность может быть сколь угодно велика.
  :::

* $y = x_1 \cdot x_2$.
  * **абсолютная погрешность:** $\Delta_y = |x^*_2| \cdot \Delta_{x_1} + |x^*_1| \cdot \Delta_{x_2}$.
  * **относительная погрешность:**
    $$ \delta_y = { |x^*_2| \cdot \Delta_{x_1} + |x^*_1| \cdot \Delta_{x_2} \over |x^*_1 \cdot x^*_2| } = {\Delta_{x_1} \over |x^*_1|} + {\Delta_{x_2} \over |x^*_2|} = \delta_{x_1} + \delta_{x_2}, $$
    т. е. при умножении относительные погрешности складываются.

* $y = {x_1 \over x_2}$.
  * **абсолютная погрешность:**
    $$
    \Delta_y = {1 \over |x^*_2|} \cdot \Delta_{x_1} + \left|{x^*_1 \over (x^*_2)^2}\right| \cdot \Delta_{x_2} = { |x^*_2| \cdot \Delta_{x_1} + |x^*_1| \cdot \Delta_{x_2} \over |(x^*_2)^2| }.
    $$
  * **относительная погрешность:**
    $$
    \delta_y = { |x^*_2| \cdot \Delta_{x_1} + |x^*_1| \cdot \Delta_{x_2} \over \left|{ x^*_1 \over x^*_2 }\right| \cdot |x^*_2|^2 } = \delta_{x_1} + \delta_{x_2},
    $$
    т. е. при делении относительные погрешности складываются.

### Обратная задача теории погрешностей

Иногда возникает вопрос: какой точности должны быть входные данные, чтобы на выходе гарантировать заданную точность результата.

В самом простом случае, когда аргумент один (т. е. $y = f(x)$), то

$$
\Delta_y = |\text{d}y| = |f'(x)| \cdot \Delta_x \implies \Delta_x = {\Delta_y \over |f'(x^*)|}.
$$

Для функций большего числа аргументов требуются дополнительные условия, наложенные на погрешности этих аргументов:

* равные абсолютные погрешности аргументов:
  $$
  \Delta_{x_i} = \text{const} \implies \Delta_{x_i} = { \Delta_y \over \sum^n_{i=1} \left|{\partial f \over \partial x_i}\right|_{x_i = x^*_i} } ~ ~ ~ ~ ~ ~ \forall i = \overline{1,n}.
  $$
* равное влияние погрешностей на сумму:
  $$
  \left|{\partial f \over \partial x_i}\right|_{x_i = x^*_i} \Delta_{x_i} = \text{const} \implies \Delta_{x_i} = { \Delta_y \over n \cdot \left|{\partial f \over \partial x_i}\right|_{x_i = x^*_i} } ~ ~ ~ ~ ~ ~ \forall i = \overline{1,n}.
  $$
* равные относительные погрешности:
  $$
  \Delta_y = \sum^n_{i=1} \left|{\partial f \over \partial x_i}\right|_{x_i = x^*_i}\Delta_{x_i} = \sum^n_{i=1} \left|{\partial f \over \partial x_i}\right|_{x_i = x^*_i} \cdot \underbrace{\Delta_{x_i} \over |x^*_i|}_{\delta_{x_i}} \cdot |x^*_i|.
  $$
  Если все относительные погрешности равны ($\delta_{x_i} = \text{const}$), то
  $$
  \Delta_{x_i} = {\Delta_y \over \sum^n_{i=1} \left|{\partial f \over \partial x_i}\right|_{x_i = x^*_i}} ~ ~ ~ ~ ~ ~ \forall i = \overline{1,n}.
  $$


## § 3. Вычислительная погрешность {#3}

Будем рассматривать множество чисел с конечным числом разрядов в позиционной системе счисления, заданных в следующем виде:

$$
\pm \left( \alpha_1\beta^n + \alpha_2\beta^{n-1} + \dots + \alpha_m \beta^{n-m+1} \right),
$$
где $\beta$ — основание системы (обычно за $\beta$ берут 2, 10 или 16); $0 \le \alpha_i \le \beta - 1$; $i = \overline{1,m}$; $n = [-N,N]$, где $N$ — порядок.

Считаем, что при проведении вычислений мы выходим за данное множество чисел.

Сформулируем правило округления. Пусть $x = \pm (\alpha _ 1 \beta^n + \alpha _ 2 \beta^{n-2} + \dots + \alpha _ m \beta^{n-m+1} + \alpha _ {m+1}\beta^{n-m} + \dots)$.

1. если $\alpha _ {m+1} \beta^{n-m} + \alpha _ {m+2} \beta ^{n-m+1} + \dots < {1 \over 2} \beta^{n-m+1}$, то $x \coloneqq x^* = \pm (\alpha _ 1 \beta^n + \dots + \alpha _ m \beta^{n-m+1})$;
2. если $\alpha _ {m+1} \beta^{n-m} + \alpha _ {m+2} \beta^{n-m+1} + \dots > {1 \over 2} \beta^{n-m+1}$, то $x \coloneqq x^* = \pm ( \alpha _ 1 \beta^n + \dots + (\alpha _ m + 1) \cdot \beta^{n0m+1} )$;
3. если $\alpha _ {m+1} \beta^{n-m} + \alpha _ {m+2} \beta^{n-m+1} + \dots = {1 \over 2} \beta^{n-m+1}$, то
   $$ x \coloneqq x^* = \begin{cases} \text{п. 1}, & \text{если} ~ \alpha _ m ~ \text{чётное}, \\\\ \text{п. 2}, & \text{если} ~ \alpha _ m ~ \text{нечётное}. \end{cases} $$

Данная процедура основана на статистическом подходе к учёту погрешности.

Рассмотренный выше подход, предполагающий полное оценивание погрешности либо их верхних и нижних пределов, имеет два существенных недостатка:
1. может привести к громоздким выражениям и не пригоден для массовых вычислений;
2. учитывает крайние, наихудшие случаи, которые допустимы, но маловероятны.

При больших однотипных вычислениях следует использовать *вероятностные (статистические) законы формирования погрешностей*.

Так, например, методами теории вероятностей доказывается, что при сложении $n$ слагаемых ($n > 10$), округляемых до $m$-го разряда, абсолютная погрешность суммы приближается формулой

$$ \Delta _ S \approx \sqrt{3n} \cdot 0,5 \cdot 10^{-m}, $$
называемой *правилом Чеботарёва*.

Если же рассматривать среднее арифметическое из $n$ слагаемых

$$
\hat{x} = {1 \over n}(x _ 1 + x _ 2 + \dots + x _ n) ~ ~ ~ ~ (n > 10),
$$

имеющих одинаковый уровень погрешности

$$ \Delta _ {x _ i} = 0,5 \cdot 10^{-m}, $$

то классическая оценка абсолютной погрешности имеет вид

$$
\Delta _ {\hat{x} _ n} = {1 \over n} \left( \Delta _ {x _ 1} + \Delta _ {x _ 2} + \dots + \Delta _ {x _ n} \right) = {1 \over n} \cdot n \cdot 0,5 \cdot 10^{-m} = 0,5 \cdot 10^{-m},
$$

т.е. погрешность результата совпадает с погрешностью исходных данных.

Если же воспользоваться правилом Чеботарёва, то
$$
\Delta _ {\hat{x} _ n} = {1 \over n} \cdot \sqrt{3n} \cdot 0,5 \cdot 10^{-m} = \sqrt{3 \over n} \cdot 0,5 \cdot 10^{-m} = \sqrt{3 \over n} \Delta _ {x _ i} \underset{n \to \infty}{\longrightarrow} 0,
$$
т.е. чем больше складываем величин, тем меньше будет абсолютная погрешность суммы.