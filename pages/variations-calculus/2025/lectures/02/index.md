---
prev:
   text: 1. Основные понятия, связанные с экстремальными задачами. Принцип Лагранжа исследования задач с ограничениями
   link: ../01/
next:
   text: 3. Нормированные пространства. Дифференцирование в нормированных пространствах
   link: ../03/
---

**Лекция 2**

# Задача с равенствами и неравенствами

Пусть $f_i : \mathbb{R}_n \to \mathbb{R}$, $x = (x_1, x_2, ..., x_n)$.

::: info Определение
**Задачей на условный экстремум с равенствами и неравенствами** называется задача

$$
\begin{cases}
f_0(x) \to \min & \\
f_i (x) \le 0, & i = \overline{1,m} \\
f_{m+k} (x) = 0, & k = \overline{1,s}
\end{cases}
\tag{1}
$$
:::

::: info Основная теорема (необходимые условия суествования минимума)
Пусть $\hat{x}$ — точка локального минимума задачи $(1)$. Тогда существуют множители Лагранжа $\lambda_1, \lambda_2, ..., \lambda_{m+s}$ такие, что для лагранжиана

$$
L = f_0 + \sum\limits_{i=1}^{m+s} \lambda_i f_i
$$

выполняются условия:

1. стационарность по $x$:

   $$
   L'_{x_j} (\hat{x}) = 0, ~ ~ ~ ~ j = \overline{1,n}
   $$

2. условие дополняющей нежёсткости:

   $$
   \lambda_i f_i (\hat{x}) = 0, ~ ~ ~ ~ i = \overline{1,m}
   $$

   *(только для неравенств)*

3. условие неотрицательности:

   $$
   \lambda_i \ge 0, ~ ~ ~ ~ i = \overline{1,m}
   $$

   *(только для неравенств)*
:::

Достаточного условия нет. Есть только теорема Вейерштрасса.

:::: info Теорема Вейерштрасса
Непрерывная функция на непустом ограниченном замкнутом полумножестве конечномерного пространства достигает своих абсолютного минимума ($\text{abs min}$) и абсолютного максимума ($\text{abs max}$).

::: info Следствие
Если функция $f(x)$ непрерывна в $\mathbb{R}$ и $\lim\limits_{|x| \to \infty} f(x) = +\infty$ ($-\infty$), то $f$ достигает свой абсолютный минимум (максимум) на любом замкнутом подмножестве $\mathbb{R}^n$.
:::
::::

::: info Пример
$$
\begin{cases}
x^2 + y^2 + z^2 \to \min \\
2x - y + z \le 5 \\
x + y + z = 3
\end{cases}
$$

Составим лагранжиан:

$$
\begin{array}{c}
L = x^2 + y^2 + z^2 + \lambda_1 (2x - y + z - 5) + \\
+ \lambda_2 (x + y + z - 3).
\end{array}
$$

Составим стационарность:

$$
\begin{cases}
L'_x = 2x + 2 \lambda_1 + \lambda_2 = 0, \\
L'_y = 2y - \lambda_1 + \lambda_2 = 0, \\
L'_z = 2z + \lambda_1 + \lambda_2 = 0,
\end{cases}
$$

а также для неравенств (в данной задаче оно одно) добавим два условия: дополняющей жёсткости и неотрицательности.

$$
\begin{array}{c}
\lambda_1 (2x - y + z - 5) = 0, \\
\lambda_1 \ge 0.
\end{array}
$$

Рассмотрим два случая: когда $\lambda_1 = 0$ и когда $2x - y + z - 5 = 0$.

1. При $\lambda_1 = 0$:

   $$
   \begin{cases}
   2x + \lambda_2 = 0, \\
   2y + \lambda_2 = 0, \\
   2z + \lambda_2 = 0,
   \end{cases} \implies
   $$

   $$
   \implies
   \begin{rcases}
   x = y = z, \\
   x + y + z = 3
   \end{rcases} \implies
   $$

   $$
   \implies x = y = z = 1 \implies \lambda_2 = -2.
   $$

   Легко убедиться, что условие $2x - y + z \le 5$ также в таком случае выполняется.

   Таким образом, получаем подозрительную точку $M(1; 1; 1)$.

2. При $2x - y + z - 5 = 0$:

   $$
   \begin{cases}
   2x - y + z - 5 = 0, \\
   x + y + z = 3, \\
   L'_x, L'_y, L'_z
   \end{cases}
   $$

   $$
   \begin{cases}
   x = -\lambda_1 - {\lambda_2 \over 2}, \\
   y = {\lambda_1 \over 2} - {\lambda_2 \over 2}, \\
   z = -{\lambda_1 \over 2} - {\lambda_2 \over 2}.
   \end{cases}
   $$

   Подставим в предпоследнюю систему:

   $$
   \begin{cases}
   -3\lambda_1 - \lambda_2 - 5 = 0, \\
   -\lambda_1 - {3 \over 2} \lambda_2 = 3.
   \end{cases}
   $$

   По итогу получим:

   $$
   \lambda_2 = -{8 \over 7} \implies
   \lambda_1 = -{9 \over 7}.
   $$

   Получили, что $\lambda_1 < 0$, хотя, по добавленному выше условию неотрицательности, $\lambda_1 \ge 0$. Получено противоречие, следовательно, вторая ситуация не выполнена.

Продолжим работать только с первым случаем. Воспользуемся следствием теоремы Вейерштрасса:

$$
\begin{cases}
f(x,y,z) = x^2 + y^2 + z^2 \to \min \\
2x - y + z \le 5 \\
x + y + z = 3
\end{cases}
$$

Поскольку

$$
\lim\limits_{\sqrt{x^2 + y^2 + z^2} \to \infty} f(x,y,z) = +\infty,
$$

то $M_1 \in \text{abs min}$.
:::

<br />

---

<br />

Ранее мы решали задачу $(2a)$. Теперь решим задачу $(2)$:

$$
\begin{cases}
4xy \to \max \\
x^2 + y^2 = r^2 \\
x \ge 0, ~ y \ge 0
\end{cases}
$$

Переформулируем данную задачу (перейдём от максимума к минимуму):

$$
\begin{cases}
-4xy \to \min \\
x^2 + y^2 = r^2 \\
-x \le 0, ~ -y \le 0
\end{cases}
$$

Составим лагранжиан:

$$
L = -4xy + \lambda_1 (x^2 + y^2 - r^2) - \lambda_2 x - \lambda_3 y.
$$

Необходимое условие существования минимума:

$$
\begin{cases}
L'_x = -4y + 2 \lambda_1 x - \lambda_2 = 0 \\
L'_y = -4x + 2 \lambda_1 y - \lambda_3 = 0 \\
\lambda_2 \ge 0, ~ \lambda_2 x = 0 \\
\lambda_3 \ge 0, ~ \lambda_3 y = 0
\end{cases}
$$

Переберём четыре случая:

1. Пусть $\lambda_2 = 0$, $\lambda_3 = 0$. Данный случай сводится к задаче $(2a)$. Таким образом,

   $$
   x = y = {r \over \sqrt{2}}; ~ ~ ~ ~ \lambda_1 = 2.
   $$

2. Пусть $\lambda_2 = 0$, $y = 0$. Тогда

   $$
   \begin{cases}
   \lambda_1 x = 0 \\
   -4x - \lambda_3 = 0
   \end{cases} \implies

   \underbrace{\lambda_3}_{\ge 0} = -\underbrace{4x}_{\ge 0} \implies
   $$

   $$
   \implies \lambda_3 = x = 0 \implies y = r.
   $$

   Получили противоречие.

   $$
   S_\max = 2r^2
   $$

3. Пусть $\lambda_3 = 0$, $x = 0$. Тогда

   $$
   \begin{cases}
   2 \lambda_1 y = 0 \\
   -4y - \lambda_2 = 0
   \end{cases} \implies
   \lambda_2 = -4y,
   $$

   но $\lambda_2 \ge 0$, $y \ge 0$, следовательно, $\lambda_2 = y = 0$. Получили противоречие.

4. Случай $x = 0$, $y = 0$ не годится.

Таким образом, решение находится только в случае 1.