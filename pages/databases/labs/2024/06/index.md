---
prev:
    link: ../05
    text: 5. XML
next: false
---

**Лабораторная работа 6**

# Работа с бинарными и сильноветвящимися деревьями

## Варианты

<!--<input placeholder="Введите номер варианта" type="number" min="1" max="50" step="1">-->

Исходные данные:

<table>
    <tbody>
        <tr>
            <td>100</td>
            <td>80</td>
            <td>70</td>
            <td><b>N</b></td>
            <td>85</td>
            <td>82</td>
            <td>30</td>
            <td><b>L</b></td>
            <td>50</td>
            <td>73</td>
        </tr>
        <tr>
            <td>55</td>
            <td>113</td>
            <td><b>M</b></td>
            <td>75</td>
            <td>56</td>
            <td>68</td>
            <td>125</td>
            <td><b>K</b></td>
            <td>42</td>
            <td>61</td>
        </tr>
        <tr>
            <td><b>Z</b></td>
            <td>65</td>
            <td>38</td>
            <td>29</td>
            <td>31</td>
            <td>9</td>
            <td>92</td>
            <td>90</td>
            <td>98</td>
            <td>170</td>
        </tr>
    </tbody>
</table>

где
* $N$ — номер студента по списку группы,
* $L = 221 - N$,
* $M = {L \over 2} - N$,
* $K = 3 + M(10 \cdot {N \over 3})$,
* $Z = N + n$, где $n$ — количество букв в вашем имени.

Задание:
1. Построить AVL-дерево, включая элементы в указанной последовательности (построчно).
2. Из построенного AVL-дерева удалить элементы, обозначенные в исходном списке буквами, в прямой последовательности, а затем и корень.
3. Построить B-дерево (порядка 2 или 3), включая элементы в указанной последовательности по столбцам.
4. Из построенного B-дерева удалить элементы, обозначенные в исходном списке буквами, в обратной последовательности, а затем в корневой вершине удалить крайний правый элемент.

## Полезные ресурсы
* [Онлайн-построитель AVL-деревьев](https://www.cs.usfca.edu/~galles/visualization/AVLtree.html)
* [Онлайн-построитель B-деревьев](https://www.cs.usfca.edu/~galles/visualization/BTree.html)

## Защита

::: details Балансировка в AVL- и B-деревьях?
**Балансировка в AVL-деревьях.** AVL-дерево называется *сбалансированным*, если разница уровней любых двух узлов не превышает единицы.

Более жёстким определением баланса является *идеально-сбалансированное* дерево – дерево, у которого для каждого узла количество узлов в левом и правом поддеревьях различается не более, чем на единицу.

Если для дерева не выполняется условие, что разница уровней любых друх узлов не превышает единицы, то в таком случае требуется балансировка путём вращений *(см. вопрос «Вращения в AVL-деревьях»)*.

**Балансировка в B-деревьях.**
:::

::: details Пример с удалением какого-это элемента (оба дерева), что вместо него получится (по вашей лабораторной работе)
:::

::: details Вращения в AVL-деревьях
> *Могут на примере вашей работы попросить что-то убрать и сказать, как оно будет выглядеть.*

Всего существует четыре типа вращения: малое левое, малое правое, большое левое и большое правое.

* *Левое вращение* необходимо тогда, когда для текущей вершины высота правого поддерева *больше* высоты левого поддерева на 2: $h_r - h_l \ge 2$.
* В силу симметричности, если высота правого поддерева *меньше* высоты левого поддерева на 2 ($h_l - h_r \ge 2$), то применяется *левое вращение*.

Для левого вращения то, будет ли оно малым или большим, зависит от того, какое из поддеревьев правого потомка больше.
* Если для правого потомка ($b$) высота правого поддерева *больше или равна* высоте левого поддерева ($h_R \ge h_C$), то в таком случае осуществляется *малое левое вращение*.
  ![](/media/images/db_6_01.gif)
* Если же для правого потомка высота правого поддерева *меньше* высоты левого поддерева ($h_R > h_c$), то тогда осуществляется *большое левое вращение*.
  ![](/media/images/db_6_03.gif)

Эти рассуждения, в силу симметричности, справедливы и для правых вращений (но с небольшими изменениями).

* Если для левого потомка $b$ высота правого поддерева *меньше или равна* высоте левого поддерева ($h_C \le h_L$), то в таком случае осуществляется *малое правое вращение*.
  ![](/media/images/db_6_02.gif)
* Если же для левого потомка высота правого поддерева *больше*, чем высота левого поддерева ($h_c \gt h_L$), то тогда осуществляется *большое правое вращение*.
  ![](/media/images/db_6_04.gif)

---

**Источники:**
* [АВЛ дерево. основные операции](https://www.youtube.com/watch?v=4qJVFQ-LK7A) (YouTube)
* [Вопрос 11: АВЛ-дерево: алгоритмы балансировки при вставке и удалении.](https://fkti5301.github.io/exam_tickets_aisd_2017_kolinko/tickets/11.html)
:::

::: details Когда применяются левое и правое вращения и каким оно должно быть: большим или малым (чем отличаются)?
См. вопрос «вращения в AVL-деревьях».
:::

::: details Как происходит удаление элементов в деревьях? Преобразования дерева после удаления элементов

**Удаление в AVL-деревьях.** Для того, чтобы удалить вершину, мы должны заменить её значение на максимальное значение левого поддерева (а сам этот элемент из левого поддерева убрать) – т. е. мы ищем максимальное значение среди минимальных и копируем его в текущую вершину, а вершину с максимумом просто удаляем. Остаётся только пройти по всему маршруту, на котором мы искали максимум, и для каждой вершины на этом пути нужно снова проверить, сбалансировано для для неё дерево.

> Можно вместо максимального значения левого поддерева выбрать минимальное значение из правого поддерева. Дальнейшие действия аналогичны описанным выше.

**Удаление в B-деревьях.** При удалении элемента из В-дерева возможны две ситуации, связанные с его расположением (либо в блоке-листе, либо в ветвящейся вершине).

Если удаляемый элемент находится в блоке-листе, то соответствующая процедура тривиальна, но требует последующей проверки определяющих свойств В-дерева. В частности, число элементов $m$ в уменьшаемом блоке может оказаться меньше $n$ и тогда необходимо выполнить операцию балансировки B-дерева, исходя из общего числа элементов на уменьшаемой и соседней с ней вершинах.

В случае, если это число равно $2n$, то все оставшиеся элементы необходимо перераспределять поровну между этими вершинами, не нарушая правила ссылок. Если же общее число элементов равно $2n-1$, то уменьшаемую и соседнюю с ней вершину необходимо объединить и, во избежание нарушения ссылок, перенести соответствующий ключ из вершины предыдущего уровня в объединённую вершину.

---

**Источники:**
* [АВЛ дерево. основные операции](https://www.youtube.com/watch?v=4qJVFQ-LK7A) (YouTube)
* Методические указания к лабораторной работе.
:::

::: details Каковы требования к количеству элементов (ключей) в вершинах B-деревьев?
В B-дереве порядка $n$ каждая вершина может содержать не менее $n$ и не более $2n$ элементов (ключей). Корневая вершина может содержать не менее 1 элемента.

---
**Источники:**
* Методические указания к лабораторной работе.
:::

::: details Какое B-дерево является идеально сбалансированным?
:::